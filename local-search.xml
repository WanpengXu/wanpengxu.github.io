<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>中间人攻击——DHCP耗尽攻击</title>
    <link href="/2022/03/25/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%E2%80%94%E2%80%94DHCP%E8%80%97%E5%B0%BD%E6%94%BB%E5%87%BB/"/>
    <url>/2022/03/25/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%E2%80%94%E2%80%94DHCP%E8%80%97%E5%B0%BD%E6%94%BB%E5%87%BB/</url>
    
    <content type="html"><![CDATA[<h1 id="0xFF-实验环境："><a href="#0xFF-实验环境：" class="headerlink" title="0xFF 实验环境："></a>0xFF 实验环境：</h1><p>真DHCP服务器：CentOS 8</p><p>攻击者：Kali</p><p>受害者：Windows 10</p><h1 id="0x00-预备知识"><a href="#0x00-预备知识" class="headerlink" title="0x00 预备知识"></a>0x00 预备知识</h1><p>阅读本文所需要的知识：计算机网络、网络安全、Linux操作系统</p><p>计算机网络——DHCP：</p><p>需要连接到互联网的计算机，必须对IP地址等项目进行协议配置。</p><p>互联网现在广泛使用的是<strong>动态主机协议配置DHCP（Dynamic Host Configuration Protocol）</strong>，其作用：</p><ol><li>用于内部网或网络服务供应商自动分配IP地址给用户</li><li>用于内部网管理员对所有电脑作中央管理</li></ol><p>DHCP以C/S模式运行，二者交互过程如下：</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251854598.png" alt=""></p><ol><li><strong>DHCP发现（DISCOVER）</strong>：客户端以广播方式发出DHCP DISCOVER报文， 寻找网络中的DHCP服务器。</li><li><strong>DHCP提供（OFFER）</strong>：DHCP服务器接收到来自客户端的DHCP DISCOVER报文后，会在自己的地址池中查找是否有可提供的IP地址。如果有，服务器就将此IP地址做上标记，并用DHCP OFFER报文将其发送给客户端。</li><li><strong>DHCP请求（REQUEST）</strong>：由于网络中可能会存在多台DHCP服务器，因此客户端可能会接收到多个DHCP OFFER报文。通常，客户端选择最先到达的DHCP OFFER，并再次以广播方式发送DHCP REQUEST报文。这时，不仅要告知它所选择的服务器，同时也要告知其他没有选择的服务器。这样，这些服务器就可以将之前所提供的IP地址收回。</li><li><strong>DHCP确认（Acknowledge，ACK）</strong>：被选择的DHCP服务器收到客户端发来的DHCP REQUEST报文后，首先将刚才所提供的IP地址标记为已租用，然后向客户端发送一个DHCP ACK确认报文，该报文中含有IP地址的有效租约、默认网关和DNS服务器等网络配置信息。当客户端收到DHCP ACK报文后，就成功获得了IP地址，完成了初始化过程。</li></ol><p>网络安全——DHCP攻击</p><p>Step1 受害者向广播域发送DISCOVER报文</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251854101.png" alt=""></p><p>Step2 DHCP服务器和攻击者均向广播域回应OFFER报文（由于DHCP Server和DHCP Client之间没有认证机制，所以攻击者可以伪装成DHCP Server）</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251855934.png" alt=""></p><p>Step3 客户端可能接收到多个OFFER报文，其通常只接受第一个。这里我们<strong>假设受害者接受了攻击者的OFFER</strong>，此后受害者向广播域发送REQUEST报文以通知此事</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251855258.png" alt=""></p><p>Step4 DHCP服务器接收到REQUSET报文后取消标记预分配的IP地址，攻击者收到REQUEST报文后向广播域发送ACK报文。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251855427.png" alt=""></p><p>Step5 最终攻击者建立了与受害者的连接，作为受害者的DHCP服务器接受其所有发送至互联网的数据，充当了受害者与互联网之间的“中间人”，所以DHCP攻击是一种中间人攻击。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251856040.png" alt=""></p><p>那么问题出现了，攻击者怎样才能使受害者必须接受自己的OFFER报文呢？</p><p>这就引入了耗尽攻击，攻击者可以伪造多个MAC地址，用他们向广播域发送大量DISCOVER报文，每一个都会占用DHCP服务器的一个IP地址，形成半开连接，当伪造DISCOVER报文足够多时，其他DHCP服务器的IP地址都会被耗尽，整个广播域内就只有攻击者向他人可以发送OFFER报文了。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251856511.png" alt=""></p><h1 id="0x01-配置DHCP服务器"><a href="#0x01-配置DHCP服务器" class="headerlink" title="0x01 配置DHCP服务器"></a>0x01 配置DHCP服务器</h1><h2 id="0x010-将三台虚拟机绑定到VMnet1网卡"><a href="#0x010-将三台虚拟机绑定到VMnet1网卡" class="headerlink" title="0x010 将三台虚拟机绑定到VMnet1网卡"></a>0x010 将三台虚拟机绑定到VMnet1网卡</h2><p>注：最好在这些操作前安装好后文所用到的软件</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203252229876.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203252230723.png" alt=""></p><p>VMnet1在这里起划分子网的作用，让三台虚拟机形成一个广播域。这里没有接入实体机的网络，所有当你这样配置后，三台虚拟机都应该是断网的状态。</p><h2 id="0x011-分配静态IP"><a href="#0x011-分配静态IP" class="headerlink" title="0x011 分配静态IP"></a>0x011 分配静态IP</h2><p>首先要修改网卡的设置，由于每台虚拟机的网卡命名都不统一，所以只能进入目录查看这个配置文件。</p><p><code>cd /etc/sysconfig/network-scripts</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251204677.png" alt=""></p><p><code>vim ifcfg-ens160</code></p><p>将BOOTPROTO参数修改为static，然后在下面新增如下几行表示IP地址、掩码、网关和DNS。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251204941.png" alt=""></p><p>这里的$prefix = 24 = 3 * 8bit$，代表掩码255.255.255.0</p><h2 id="0x012-安装DHCP服务"><a href="#0x012-安装DHCP服务" class="headerlink" title="0x012 安装DHCP服务"></a>0x012 安装DHCP服务</h2><p><code>yum install dhcp-* -y</code></p><p><code>*</code>：通配符，表示安装配置dhcp所需的全部程序</p><p><code>-y</code>：<code>--yes</code>，将接下来的询问全部回答为yes</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203250934948.png" alt=""></p><h2 id="0x013-配置DHCP服务"><a href="#0x013-配置DHCP服务" class="headerlink" title="0x013 配置DHCP服务"></a>0x013 配置DHCP服务</h2><p>查询dhcp-server软件包的配置文件列表</p><p><code>rpm -qc dhcp-server</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203250935488.png" alt=""></p><p>查看一下配置文件</p><p><code>vim /etc/dhcp/dhcpd.conf</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203250936086.png" alt=""></p><p>里面说你可以查看配置样例，那我们先直接把样例文件粘过来</p><p><code>cp /usr/share/doc/dhcp-server/dhcpd.conf.example /etc/dhcp/dhcpd.conf</code></p><p>然后对样例进行修改，首先分配一个DNS：8.8.8.8（同上文），然后在下面新建一个块，写入子网IP、子网掩码、分配地址池的范围和网关。</p><p><code>vim /etc/dhcp/dhcpd.conf</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251208314.png" alt=""></p><p>0x014 启动并检查DHCP服务</p><p><code>systemctl start dhcpd</code></p><p><code>systemctl status dhcpd.service</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251906701.png" alt=""></p><p>如果出现了绿圈和<code>active (running)</code>代表我们的DHCP服务器运行成功了</p><p>以数字地址（<code>-n</code>）显示全部（<code>-a</code>）udp协议（<code>-u</code>）及其所对应进程的PID和名称（<code>-p</code>）</p><p><code>netstat -anpu</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251001940.png" alt=""></p><p>此时打开我们的Windows 10，它就会自动从DHCP服务器（CentOS 8）处获取IP地址。</p><p><code>ipconfig /all</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251005612.png" alt=""></p><h1 id="0x02-攻击方法"><a href="#0x02-攻击方法" class="headerlink" title="0x02 攻击方法"></a>0x02 攻击方法</h1><p>首先要在攻击机上配置DHCP服务,方法类似0x01</p><h2 id="0x021-分配静态IP"><a href="#0x021-分配静态IP" class="headerlink" title="0x021 分配静态IP"></a>0x021 分配静态IP</h2><p>因各个Linux发行版存在差异，为Kali分配静态IP需要修改两个配置文件。</p><p><code>vim /etc/network/interfaces</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251027873.png" alt=""></p><p><code>vim /etc/resovl.conf</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251026390.png" alt=""></p><h2 id="0x022-安装DHCP服务"><a href="#0x022-安装DHCP服务" class="headerlink" title="0x022 安装DHCP服务"></a>0x022 安装DHCP服务</h2><p><code>apt install isc-dhcp-server -y</code></p><p>Debian系Linux使用apt安装软件，RedHat系Linux使用yum安装软件。</p><h2 id="0x023-配置DHCP服务"><a href="#0x023-配置DHCP服务" class="headerlink" title="0x023 配置DHCP服务"></a>0x023 配置DHCP服务</h2><p><code>vim /etc/dhcp/dhcpd.conf</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251033536.png" alt=""></p><h2 id="0x024-启动并检查DHCP服务"><a href="#0x024-启动并检查DHCP服务" class="headerlink" title="0x024 启动并检查DHCP服务"></a>0x024 启动并检查DHCP服务</h2><p><code>service isc-dhcp-server start</code></p><p><code>service isc-dhcp-server status</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251052035.png" alt=""></p><h2 id="0x025-耗尽真DHCP服务器IP地址"><a href="#0x025-耗尽真DHCP服务器IP地址" class="headerlink" title="0x025 耗尽真DHCP服务器IP地址"></a>0x025 耗尽真DHCP服务器IP地址</h2><p>即将展开攻击，我们整理一下已知资料：</p><div class="table-container"><table><thead><tr><th></th><th>真DHCP服务器</th><th>攻击者</th></tr></thead><tbody><tr><td>操作系统</td><td>CentOS 8</td><td>Kali</td></tr><tr><td>IP地址</td><td>192.168.145.100</td><td>192.168.145.105</td></tr><tr><td>域名</td><td>example.org</td><td>hack.org</td></tr><tr><td>DNS</td><td>8.8.8.8</td><td>9.9.9.9</td></tr><tr><td>IP地址池</td><td>192.168.145.200-220</td><td>192.168.145.230-250</td></tr></tbody></table></div><p>我们使用dhcpstarv程序伪造MAC地址进行DHCP请求，消耗掉真DHCP服务器的IP地址。</p><p><code>dhcpstrarv -i eth0 -e 192.168.145.200</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251141246.png" alt=""></p><p>现在可以来查看一下CentOS 8的DHCP服务，发现其对于接收到的DHCP DISCOVER报文显示了no free leases，这说明它已经没有可用IP了。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251141585.png" alt=""></p><p>注：DHCP在指定时间内收不到REQUEST请求则会自动取消IP地址的标记使其成为可用状态，因此dhcpstarv程序一直开着就好。</p><h2 id="0x026-受害机请求IP地址"><a href="#0x026-受害机请求IP地址" class="headerlink" title="0x026 受害机请求IP地址"></a>0x026 受害机请求IP地址</h2><p>当有主机请求IP地址时，因真DHCP已无剩余IP地址，故受害机只会收到攻击机的OFFER，进而获取其分配的IP地址。</p><p>这里我们使用测试DHCP服务器的主机作为受害机，让其重新获取IP：</p><p><code>ipconfig /release</code></p><p><code>ipconfig /renew</code></p><p><code>ipconfig /all</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251146824.png" alt=""></p><p>框出的部分明显地宣布了我们本次攻击的成功。</p><h2 id="0x027-嗅探网段内报文"><a href="#0x027-嗅探网段内报文" class="headerlink" title="0x027 嗅探网段内报文"></a>0x027 嗅探网段内报文</h2><p><code>ettercap -i eth0 -Tq -M dhcp:192.168.145.230-250/255.255.255.0/9.9.9.9</code></p><p>若在受害者获取IP地址前，使用etterecap嗅探网段中的报文，我们便会发现一次完整的DHCP过程。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251151100.png" alt=""></p><p>这次实验的报文很整齐美观：受害者（MAC地址00:0C:29:0A:26:F7）间隔固定时间发送一次DISCOVER报文，随后攻击者（IP地址192.168.145.105）不停地对每一个DISCOVER报文回复OFFER，在第三次DISCOCER后受害者接受了OFFER，并回应了REQUEST报文，随后攻击者立刻向其回应了ACK报文。</p><h1 id="0x03-后渗透利用"><a href="#0x03-后渗透利用" class="headerlink" title="0x03 后渗透利用"></a>0x03 后渗透利用</h1><h2 id="0x030-获取受害机发送的数据包"><a href="#0x030-获取受害机发送的数据包" class="headerlink" title="0x030 获取受害机发送的数据包"></a>0x030 获取受害机发送的数据包</h2><p>此时，攻击机已经成为了受害机的DHCP服务器，受害机的所有数据包都会发向攻击机。</p><p>不论QQ、微信的聊天记录，还是登陆网站所用的账号、密码都必须经过攻击机这个“中间人”，所以DHCP耗尽攻击属于中间人攻击。</p><p>以我的博客为例</p><p>攻击者尝试解析域名<code>xuwp.top</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251201167.png" alt=""></p><p>攻击者接收到DNS数据包</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251200312.png" alt=""></p><p>受害者尝试ping IP地址</p><p>攻击者收到ICMP数据包</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203251200552.png" alt=""></p><p>当然，这次实验并没有让这个网段连接至互联网，所以访问我的博客也会失败。</p>]]></content>
    
    
    <categories>
      
      <category>信息安全</category>
      
    </categories>
    
    
    <tags>
      
      <tag>中间人攻击, DHCP耗尽攻击</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Android学习</title>
    <link href="/2022/03/12/Android%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/03/12/Android%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="一些ERROR解决方法"><a href="#一些ERROR解决方法" class="headerlink" title="一些ERROR解决方法"></a>一些ERROR解决方法</h1><p>本文所提供方法仅保证能够work，不一定是最优的。</p><h2 id="gradle下载依赖缓慢、timeout"><a href="#gradle下载依赖缓慢、timeout" class="headerlink" title="gradle下载依赖缓慢、timeout"></a>gradle下载依赖缓慢、timeout</h2><p>方法一：在项目的settings.gradle中的repositories中添加国内镜像源，并<strong>允许使用不安全的仓库</strong>。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203121212175.png" alt=""></p><p>方法二：连接至世界互联网，不多说了。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203121212340.png" alt=""></p><h2 id="一直Loading-Devices"><a href="#一直Loading-Devices" class="headerlink" title="一直Loading Devices"></a>一直Loading Devices</h2><p>下载老版本的platform-tools，替换sdk manager自动下载的最新版本。</p><p>经测试最新的可用版本是<code>platform-tools_r31.0.1-windows.zip</code></p><p>我的sdk目录：<code>C:\Users\XuWanpeng\AppData\Local\Android\Sdk\platform-tools</code></p><h2 id="关于kotlin-android-extensions"><a href="#关于kotlin-android-extensions" class="headerlink" title="关于kotlin-android-extensions"></a>关于kotlin-android-extensions</h2><p>详见《第一行代码——Android》作者郭霖的博客： <a href="https://blog.csdn.net/guolin_blog/article/details/113089706">kotlin-android-extensions插件也被废弃了？扶我起来</a></p><p>Android Studio 4.1之后，这个插件已经不会再被自动引入，已经被deprecated了。</p><p>当然，我们可以手动引入这个插件</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203131303683.png" alt=""></p><p>但目前Google官方更推荐的，是使用<a href="https://developer.android.com/topic/libraries/view-binding?hl=zh-cn">view-binging</a></p><p>这里附上使用控件实例的三种方法</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">package</span> com.example.activitytest<br><br><span class="hljs-keyword">import</span> androidx.appcompat.app.AppCompatActivity<br><span class="hljs-keyword">import</span> android.os.Bundle<br><span class="hljs-keyword">import</span> android.widget.Button  <span class="hljs-comment">// classical way</span><br><span class="hljs-keyword">import</span> android.widget.Toast<br><span class="hljs-keyword">import</span> com.example.activitytest.databinding.FirstLayoutBinding  <span class="hljs-comment">// view-binding</span><br><span class="hljs-comment">//import kotlinx.android.synthetic.main.first_layout.*  // kotlin-android-extensions</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FirstActivity</span> : <span class="hljs-type">AppCompatActivity</span></span>() &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> binding: FirstLayoutBinding  <span class="hljs-comment">// view-binding</span><br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)<br>        setContentView(R.layout.first_layout)<br><br>        <span class="hljs-comment">// classical way</span><br><span class="hljs-comment">//        val button1: Button = findViewById(R.id.button1)</span><br><span class="hljs-comment">//        button1.setOnClickListener &#123;</span><br><span class="hljs-comment">//            Toast.makeText(this, &quot;You clicked Button 1 by classical way&quot;, Toast.LENGTH_SHORT).show()</span><br><span class="hljs-comment">//        &#125;</span><br><br>        <span class="hljs-comment">// kotlin-android-extensions</span><br><span class="hljs-comment">//        button1.setOnClickListener &#123;</span><br><span class="hljs-comment">//            Toast.makeText(this, &quot;You clicked Button1 by kotlin-android-extensions&quot;, Toast.LENGTH_SHORT).show()</span><br><span class="hljs-comment">//        &#125;</span><br><br>        <span class="hljs-comment">// view-binding</span><br>        binding = FirstLayoutBinding.inflate(layoutInflater)<br>        <span class="hljs-keyword">val</span> view = binding.root<br>        setContentView(view)<br>        binding.button1.setOnClickListener &#123;<br>            Toast.makeText(<span class="hljs-keyword">this</span>, <span class="hljs-string">&quot;You clicked Button1 by view-binding&quot;</span>, Toast.LENGTH_SHORT).show()<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="运行Java代码报错：SourceSet-with-name-‘main’-not-found"><a href="#运行Java代码报错：SourceSet-with-name-‘main’-not-found" class="headerlink" title="运行Java代码报错：SourceSet with name ‘main’ not found"></a>运行Java代码报错：SourceSet with name ‘main’ not found</h2><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203132339973.png" alt=""></p><p>在<code>.idea</code>文件夹下的<code>gradle.xml</code>文件中添加<code>&lt;option name=&quot;delegatedBuild&quot; value=&quot;false&quot; /&gt;</code>，然后重新运行即可</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203132338026.png" alt=""></p><h2 id="adapterPosition返回-1"><a href="#adapterPosition返回-1" class="headerlink" title="adapterPosition返回-1"></a>adapterPosition返回-1</h2><p>最后一行应直接返回已创建的<code>viewHolder</code>，不能两次调用<code>ViewHolder()</code>。</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreateViewHolder</span><span class="hljs-params">(parent: <span class="hljs-type">ViewGroup</span>, viewType: <span class="hljs-type">Int</span>)</span></span>: ViewHolder &#123;<br>        <span class="hljs-keyword">val</span> view = LayoutInflater.from(parent.context).inflate(R.layout.fruit_item, parent, <span class="hljs-literal">false</span>)<br><br>        <span class="hljs-keyword">val</span> viewHolder = ViewHolder(view)<br>        viewHolder.itemView.setOnClickListener &#123;<br>            <span class="hljs-keyword">val</span> position = viewHolder.absoluteAdapterPosition<br><br><span class="hljs-comment">//            Log.e(&quot;tag&quot;, position.toString())</span><br><br>            <span class="hljs-keyword">val</span> fruit = fruitList[position]<br>            Toast.makeText(parent.context, <span class="hljs-string">&quot;You clicked view <span class="hljs-subst">$&#123;fruit.name&#125;</span>&quot;</span>, Toast.LENGTH_SHORT).show()<br>        &#125;<br>        viewHolder.fruitImage.setOnClickListener &#123;<br>            <span class="hljs-keyword">val</span> position = viewHolder.absoluteAdapterPosition<br><br><span class="hljs-comment">//            Log.e(&quot;tag&quot;, position.toString())</span><br><br>            <span class="hljs-keyword">val</span> fruit = fruitList[position]<br>            Toast.makeText(parent.context, <span class="hljs-string">&quot;You clicked image <span class="hljs-subst">$&#123;fruit.name&#125;</span>&quot;</span>, Toast.LENGTH_SHORT).show()<br>        &#125;<br>        <span class="hljs-keyword">return</span> viewHolder  <span class="hljs-comment">// 这里不能写ViewHolder(view)</span><br>    &#125;<br></code></pre></td></tr></table></figure><h1 id="kotlin学习"><a href="#kotlin学习" class="headerlink" title="kotlin学习"></a>kotlin学习</h1><h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><p><strong>个人感觉：kotlin像一个”exJava”，将其很多难用的功能封装了起来，上手很快。</strong></p><p>可继承类open（kotlin官方认为所有数据类型最好是<code>final</code>的，如果不显式强调“可继承”、“可重新赋值”，那么就是<code>final</code>的）</p><p><code>Person.kt</code></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">package</span> com.example.helloworld<br><br><span class="hljs-keyword">open</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span></span>(<span class="hljs-keyword">var</span> name: String, <span class="hljs-keyword">var</span> age: <span class="hljs-built_in">Int</span>) &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">eat</span><span class="hljs-params">()</span></span> &#123;<br>        println(<span class="hljs-string">&quot;<span class="hljs-variable">$name</span> is eating. He is <span class="hljs-variable">$age</span> years old.&quot;</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>接口、默认实现</p><p><code>Study.kt</code></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">package</span> com.example.helloworld<br><br><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Study</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">readBooks</span><span class="hljs-params">()</span></span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doHomework</span><span class="hljs-params">()</span></span> &#123;<br>        println(<span class="hljs-string">&quot;do homework default implementation.&quot;</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>继承、实现接口（同样不可以多继承）、主次构造函数（把一堆重载的构造函数分了主次，次必须调用主）</p><p><code>Student.kt</code></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">package</span> com.example.helloworld<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span></span>(<span class="hljs-keyword">val</span> sid: String, <span class="hljs-keyword">val</span> grade: <span class="hljs-built_in">Int</span>, name: String, age: <span class="hljs-built_in">Int</span>) : Person(name, age), Study &#123;<br>    <span class="hljs-keyword">init</span> &#123;<br>        println(<span class="hljs-string">&quot;sid is: <span class="hljs-variable">$sid</span>, grade is: <span class="hljs-variable">$grade</span>, name is: <span class="hljs-variable">$name</span>, age is: <span class="hljs-variable">$age</span>&quot;</span>)<br>    &#125;<br>    <span class="hljs-keyword">constructor</span>(name: String, age: <span class="hljs-built_in">Int</span>) : <span class="hljs-keyword">this</span>(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-number">0</span>, name, age)<br>    <span class="hljs-keyword">constructor</span>() : <span class="hljs-keyword">this</span>(<span class="hljs-string">&quot;&quot;</span>, <span class="hljs-number">0</span>)<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">readBooks</span><span class="hljs-params">()</span></span> &#123;<br>        println(<span class="hljs-string">&quot;<span class="hljs-variable">$name</span> is reading.&quot;</span>)<br>    &#125;<br><br><span class="hljs-comment">//    override fun doHomework() &#123;</span><br><span class="hljs-comment">//        println(&quot;$name is doing homework.&quot;)</span><br><span class="hljs-comment">//    &#125;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>数据类（不用手动实现<code>equals()</code>、<code>hashCode()</code>、<code>toString()</code>了）</p><p><code>CellPhone.kt</code></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">package</span> com.example.helloworld<br><br><span class="hljs-keyword">data</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cellphone</span></span>(<span class="hljs-keyword">val</span> brand: String, <span class="hljs-keyword">val</span> price: <span class="hljs-built_in">Double</span>)<br></code></pre></td></tr></table></figure><p>单例类（不用再写<code>if</code>判断是否第一次调用了）</p><p><code>Singleton.kt</code></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">package</span> com.example.helloworld<br><br><span class="hljs-keyword">object</span> Singleton &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">singletonTest</span><span class="hljs-params">()</span></span> &#123;<br>        println(<span class="hljs-string">&quot;singletonTest is called&quot;</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>LearnKotlin.kt</code></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">package</span> com.example.helloworld<br><br><span class="hljs-comment">//fun largerNumber(num1: Int, num2: Int): Int &#123;</span><br><span class="hljs-comment">//    return max(num1, num2)</span><br><span class="hljs-comment">//&#125;</span><br><br><span class="hljs-comment">//fun largerNumber(num1: Int, num2: Int) = max(num1, num2)</span><br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">largerNumber</span><span class="hljs-params">(num1: <span class="hljs-type">Int</span>, num2: <span class="hljs-type">Int</span>)</span></span> = <span class="hljs-keyword">if</span> (num1 &gt; num2) num1 <span class="hljs-keyword">else</span> num2<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doStudy</span><span class="hljs-params">(study : <span class="hljs-type">Study</span>?)</span></span> &#123;<br>    <span class="hljs-keyword">if</span> (study != <span class="hljs-literal">null</span>) &#123;<br>        study.readBooks()<br>        study.doHomework()<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        println(<span class="hljs-string">&quot;object is null&quot;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    println(<span class="hljs-string">&quot;Hello, Kotlin!&quot;</span>)<br><br><span class="hljs-comment">//    val a = 10</span><br><span class="hljs-comment">//    var a: Int = 10</span><br><span class="hljs-comment">//    a = a * 10</span><br><span class="hljs-comment">//    a *= 10</span><br><span class="hljs-comment">//    println(&quot;a = &quot; + a)</span><br><span class="hljs-comment">//    println(&quot;a = $a&quot;)</span><br><br>    <span class="hljs-keyword">val</span> a = <span class="hljs-number">37</span><br>    <span class="hljs-keyword">val</span> b = <span class="hljs-number">40</span><br>    <span class="hljs-keyword">val</span> value = largerNumber(a, b)<br>    println(<span class="hljs-string">&quot;larger number is: <span class="hljs-variable">$value</span>&quot;</span>)<br><br>    <span class="hljs-keyword">val</span> p = Person(<span class="hljs-string">&quot;Jack&quot;</span>, <span class="hljs-number">19</span>)<br>    p.eat()<br><br>    <span class="hljs-keyword">val</span> student1 = Student()<br>    <span class="hljs-keyword">val</span> student2 = Student(<span class="hljs-string">&quot;Jack&quot;</span>, <span class="hljs-number">19</span>)<br>    <span class="hljs-keyword">val</span> student3 = Student(<span class="hljs-string">&quot;a123&quot;</span>, <span class="hljs-number">5</span>, <span class="hljs-string">&quot;Jack&quot;</span>, <span class="hljs-number">19</span>)<br><br>    doStudy(student2)<br><br>    <span class="hljs-keyword">val</span> cellphone1 = Cellphone(<span class="hljs-string">&quot;Samsung&quot;</span>, <span class="hljs-number">1299.99</span>)<br>    <span class="hljs-keyword">val</span> cellphone2 = Cellphone(<span class="hljs-string">&quot;Samsung&quot;</span>, <span class="hljs-number">1299.99</span>)<br><br>    println(cellphone1)  <span class="hljs-comment">// toString</span><br>    println(<span class="hljs-string">&quot;cellphone1 equals cellphone2: <span class="hljs-subst">$&#123;cellphone1 == cellphone2&#125;</span>&quot;</span>)  <span class="hljs-comment">// equals</span><br><br>    Singleton.singletonTest()  <span class="hljs-comment">// 前面那个其实是实例</span><br><br>    <span class="hljs-keyword">val</span> list = listOf(<span class="hljs-string">&quot;Apple&quot;</span>, <span class="hljs-string">&quot;Banana&quot;</span>, <span class="hljs-string">&quot;Orange&quot;</span>, <span class="hljs-string">&quot;Pear&quot;</span>, <span class="hljs-string">&quot;Grape&quot;</span>)<br><span class="hljs-comment">//    list.add(&quot;Watermelon&quot;)  // ERROR: Unresolved reference: add</span><br>    <span class="hljs-keyword">for</span> (fruit <span class="hljs-keyword">in</span> list) &#123;<br>        println(fruit)<br>    &#125;<br>    println()<br><br>    <span class="hljs-keyword">val</span> mutableList = mutableListOf(<span class="hljs-string">&quot;Apple&quot;</span>, <span class="hljs-string">&quot;Banana&quot;</span>, <span class="hljs-string">&quot;Orange&quot;</span>, <span class="hljs-string">&quot;Pear&quot;</span>, <span class="hljs-string">&quot;Grape&quot;</span>)<br>    mutableList.add(<span class="hljs-string">&quot;Watermelon&quot;</span>)<br>    <span class="hljs-keyword">for</span> (fruit <span class="hljs-keyword">in</span> mutableList) &#123;<br>        println(fruit)<br>    &#125;<br>    println()<br><br>    <span class="hljs-keyword">val</span> <span class="hljs-keyword">set</span> = setOf(<span class="hljs-string">&quot;Apple&quot;</span>, <span class="hljs-string">&quot;Banana&quot;</span>, <span class="hljs-string">&quot;Orange&quot;</span>, <span class="hljs-string">&quot;Pear&quot;</span>, <span class="hljs-string">&quot;Grape&quot;</span>, <span class="hljs-string">&quot;Apple&quot;</span>)<br><span class="hljs-comment">//    set.add(&quot;Watermelon&quot;)  // ERROR: Unresolved reference: add</span><br>    <span class="hljs-keyword">for</span> (fruit <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span>) &#123;<br>        println(fruit)<br>    &#125;<br>    println()<br><br>    <span class="hljs-keyword">val</span> mutableSet = mutableSetOf(<span class="hljs-string">&quot;Apple&quot;</span>, <span class="hljs-string">&quot;Banana&quot;</span>, <span class="hljs-string">&quot;Orange&quot;</span>, <span class="hljs-string">&quot;Pear&quot;</span>, <span class="hljs-string">&quot;Grape&quot;</span>, <span class="hljs-string">&quot;Apple&quot;</span>)<br>    mutableSet.add(<span class="hljs-string">&quot;Watermelon&quot;</span>)<br>    <span class="hljs-keyword">for</span> (fruit <span class="hljs-keyword">in</span> mutableSet) &#123;<br>        println(fruit)<br>    &#125;<br>    println()<br><br>    <span class="hljs-keyword">val</span> map = mapOf(<span class="hljs-string">&quot;Apple&quot;</span> to <span class="hljs-number">1</span>, <span class="hljs-string">&quot;Banana&quot;</span> to <span class="hljs-number">2</span>, <span class="hljs-string">&quot;Orange&quot;</span> to <span class="hljs-number">3</span>, <span class="hljs-string">&quot;Pear&quot;</span> to <span class="hljs-number">4</span>, <span class="hljs-string">&quot;Grape&quot;</span> to <span class="hljs-number">5</span>)<br><span class="hljs-comment">//    map[&quot;Watermelon&quot;] = 6  // ERROR: No set method providing array access</span><br>    <span class="hljs-keyword">for</span> ((fruit, number) <span class="hljs-keyword">in</span> map) &#123;<br>        println(<span class="hljs-string">&quot;fruit is <span class="hljs-variable">$fruit</span>, number is <span class="hljs-variable">$number</span>&quot;</span>)<br>    &#125;<br>    println()<br><br>    <span class="hljs-keyword">val</span> mutableMap = mutableMapOf(<span class="hljs-string">&quot;Apple&quot;</span> to <span class="hljs-number">1</span>, <span class="hljs-string">&quot;Banana&quot;</span> to <span class="hljs-number">2</span>, <span class="hljs-string">&quot;Orange&quot;</span> to <span class="hljs-number">3</span>, <span class="hljs-string">&quot;Pear&quot;</span> to <span class="hljs-number">4</span>, <span class="hljs-string">&quot;Grape&quot;</span> to <span class="hljs-number">5</span>)<br>    mutableMap[<span class="hljs-string">&quot;Watermelon&quot;</span>] = <span class="hljs-number">6</span><br>    <span class="hljs-keyword">for</span> ((fruit, number) <span class="hljs-keyword">in</span> mutableMap)<br>        println(<span class="hljs-string">&quot;fruit is <span class="hljs-variable">$fruit</span>, number is <span class="hljs-variable">$number</span>&quot;</span>)<br>    println()<br><br><span class="hljs-comment">//    val lambda = &#123;fruit: String -&gt; fruit.length&#125;</span><br>    <span class="hljs-keyword">val</span> maxLengthFruit = mutableList.maxByOrNull &#123; it.length &#125;<br>    println(<span class="hljs-string">&quot;max Length fruit is <span class="hljs-variable">$maxLengthFruit</span>&quot;</span>)<br>    println()<br><br><span class="hljs-comment">//    val newList = list.map &#123; it.toUpperCase() &#125;</span><br>    <span class="hljs-keyword">val</span> newList = list.filter &#123; it.length &lt;= <span class="hljs-number">5</span> &#125;<br>                      .map &#123; it.uppercase() &#125;<br>    <span class="hljs-keyword">for</span> (fruit <span class="hljs-keyword">in</span> newList) &#123;<br>        println(fruit)<br>    &#125;<br>    println()<br><br>    <span class="hljs-keyword">val</span> anyResult = list.any &#123; it.length &lt;= <span class="hljs-number">5</span> &#125;<br>    <span class="hljs-keyword">val</span> allResult = list.all &#123; it.length &lt;= <span class="hljs-number">5</span> &#125;<br>    println(<span class="hljs-string">&quot;anyResult is <span class="hljs-variable">$anyResult</span>, allResult is <span class="hljs-variable">$allResult</span>&quot;</span>)<br>    println()<br><br>    Thread &#123;<br>        println(<span class="hljs-string">&quot;Thread is running&quot;</span>)<br>    &#125;.start()<br><br>    doStudy(<span class="hljs-literal">null</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="标准函数、静态方法"><a href="#标准函数、静态方法" class="headerlink" title="标准函数、静态方法"></a>标准函数、静态方法</h2><h3 id="标准函数with、run和apply"><a href="#标准函数with、run和apply" class="headerlink" title="标准函数with、run和apply"></a>标准函数<code>with</code>、<code>run</code>和<code>apply</code></h3><p><code>with</code>的使用像一个静态方法，需要传入<code>object</code>和<code>lambda</code>，可能需要判空。</p><p><code>run</code>的功能类似<code>with</code>，是一个实例方法，用<code>object</code>调用它，只需要传入<code>lambda</code>，优点是可以使用<code>?.</code>判空。（这一点又类似<code>let</code>）</p><p><code>apply</code>类似<code>run</code>，但它的<code>lambda</code>语句块不将最后一行作为返回值。</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">package</span> com.example.activitytest<br><br><span class="hljs-keyword">import</span> java.lang.StringBuilder<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> list = listOf(<span class="hljs-string">&quot;Apple&quot;</span>, <span class="hljs-string">&quot;Banana&quot;</span>, <span class="hljs-string">&quot;Orange&quot;</span>, <span class="hljs-string">&quot;Pear&quot;</span>, <span class="hljs-string">&quot;Grape&quot;</span>)<br>    <span class="hljs-keyword">val</span> result = with(StringBuilder()) &#123;<br>        append(<span class="hljs-string">&quot;Start eating fruits.\n&quot;</span>)<br>        <span class="hljs-keyword">for</span> (fruit <span class="hljs-keyword">in</span> list) &#123;<br>            append(fruit).append(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>        &#125;<br>        append(<span class="hljs-string">&quot;Ate all fruits&quot;</span>)<br>        toString()<br>    &#125;<br>    println(result)  <span class="hljs-comment">// string</span><br>    println()<br><br>    <span class="hljs-keyword">val</span> list2 = listOf(<span class="hljs-string">&quot;Apple&quot;</span>, <span class="hljs-string">&quot;Banana&quot;</span>, <span class="hljs-string">&quot;Orange&quot;</span>, <span class="hljs-string">&quot;Pear&quot;</span>, <span class="hljs-string">&quot;Grape&quot;</span>)<br>    <span class="hljs-keyword">val</span> result2 = StringBuilder().run &#123;<br>        append(<span class="hljs-string">&quot;Start eating fruits.\n&quot;</span>)<br>        <span class="hljs-keyword">for</span> (fruit <span class="hljs-keyword">in</span> list2) &#123;<br>            append(fruit).append(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>        &#125;<br>        append(<span class="hljs-string">&quot;Ate all fruits&quot;</span>)<br>        toString()<br>    &#125;<br>    println(result2)  <span class="hljs-comment">// string</span><br>    println()<br><br>    <span class="hljs-keyword">val</span> list3 = listOf(<span class="hljs-string">&quot;Apple&quot;</span>, <span class="hljs-string">&quot;Banana&quot;</span>, <span class="hljs-string">&quot;Orange&quot;</span>, <span class="hljs-string">&quot;Pear&quot;</span>, <span class="hljs-string">&quot;Grape&quot;</span>)<br>    <span class="hljs-keyword">val</span> result3 = StringBuilder().apply &#123;<br>        append(<span class="hljs-string">&quot;Start eating fruits.\n&quot;</span>)<br>        <span class="hljs-keyword">for</span> (fruit <span class="hljs-keyword">in</span> list3) &#123;<br>            append(fruit).append(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>        &#125;<br>        append(<span class="hljs-string">&quot;Ate all fruits&quot;</span>)<br><span class="hljs-comment">//        toString()</span><br>    &#125;<br>    println(result3.toString())  <span class="hljs-comment">// StringBuilder（鼠标放上去看一下）</span><br>    println()<br><br>    doSomething()<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="静态方法"><a href="#静态方法" class="headerlink" title="静态方法"></a>静态方法</h3><p>kotlin中极力弱化了静态方法，官方推荐使用<strong>单例类</strong>和<strong>伴生类（companion object）</strong>中的实例方法以尽可能地模拟静态方法。</p><p>但kotlin官方也提供了两种静态方法的实现方式：<strong>注解</strong>（<code>@JvmStatic</code>）和<strong>顶层方法</strong></p><p>顶层方法：</p><p><code>Helper.kt</code></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">package</span> com.example.activitytest<br><br><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">doSomething</span><span class="hljs-params">()</span></span> &#123;<br>    println(<span class="hljs-string">&quot;do something&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p><code>JavaTest.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.example.activitytest;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JavaTest</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">invokeStaticMethod</span><span class="hljs-params">()</span> </span>&#123;<br>        HelperKt.doSomething();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        HelperKt.doSomething();<br><br>        JavaTest javaTest = <span class="hljs-keyword">new</span> JavaTest();<br>        javaTest.invokeStaticMethod();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>output</code></p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">do</span> something<br><span class="hljs-keyword">do</span> something<br></code></pre></td></tr></table></figure><p>注意：kotlin编译器在很多情况下都会将<strong>源文件及其后缀</strong>编译为<strong>大驼峰命名法</strong>的形式。</p><h2 id="延迟初始化、密封类"><a href="#延迟初始化、密封类" class="headerlink" title="延迟初始化、密封类"></a>延迟初始化、密封类</h2><h3 id="延迟初始化"><a href="#延迟初始化" class="headerlink" title="延迟初始化"></a>延迟初始化</h3><p>首先我们来看这样一段代码：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span></span>(), View.OnClickListener&#123;<br>...<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> adapter: MsgAdapter? = <span class="hljs-literal">null</span><br>    ...<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>...<br>        adapter = MsgAdapter(msgList)<br>...<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onClick</span><span class="hljs-params">(v: <span class="hljs-type">View</span>?)</span></span> &#123;<br>...<br>        adapter?.notifyItemInserted(msgList.size - <span class="hljs-number">1</span>)<br>...<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>这里是通过对本类<strong>实现事件处理接口</strong>来实现鼠标点击监听器的，因程序自身逻辑，在<code>onCreate</code>和<code>onClick</code>两个方法中都会用到同一个变量<code>adapter</code>。</p><p>那么我们首先应在类中将<code>adapter</code>赋值为<code>null</code>，同时把它的类型声明成<code>MsgAdapter?</code>，<code>?</code>代表允许为空。</p><p>但这样就带来了一个问题，既然类型是可能为空的<code>MsgAdapter?</code>，那么在使用这个变量的方法时也要不断地使用<code>?.</code>对其判空，可以想象，当工程量变大时，这个可能为空的变量会带来多少个<code>?.</code>和<code>?:</code>。</p><p>有一种办法可以解决这个问题：使用<code>lateinit</code>关键字，对变量进行<strong>延迟初始化</strong></p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span></span>(), View.OnClickListener&#123;<br>...<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> adapter: MsgAdapter  <span class="hljs-comment">// change1</span><br>    ...<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>...<br>        adapter = MsgAdapter(msgList)<br>...<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onClick</span><span class="hljs-params">(v: <span class="hljs-type">View</span>?)</span></span> &#123;<br>...<br>        adapter.notifyItemInserted(msgList.size - <span class="hljs-number">1</span>)  <span class="hljs-comment">// change2</span><br>...<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>使用这个关键字后，就可将变量中的<code>?</code>去掉，代表它是一个延迟初始化的非空变量。后续调用其方法时也不再需要使用<code>?.</code>对其进行空检查。</p><p>但这样是有风险的，因为kotlin编译器相信开发者会在对变量赋值后再调用它的方法，所以如果开发者没有这样做，编译器只能在编译时才能爆出<code>UninitializedPropertyAccessException</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203160100053.png" alt=""></p><p><strong>所以若你对一个全局变量使用了<code>lateinit</code>关键字，请确保它在被调用之前已完成了初始化工作。</strong></p><p>另外，我们可以检查<code>lateinit var</code>是否被初始化﻿，方法是在它的<strong>属性引用</strong>上使用<code>.isInitialized</code></p><p>属性引用我觉得可以单开一小节，这里我们只需要知道</p><blockquote><p>要将属性作为 Kotlin 中的一等对象访问，请使用<code>::</code>运算符</p></blockquote><p>接着我们可以得到这样的代码：</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span></span>(), View.OnClickListener&#123;<br>...<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> adapter: MsgAdapter  <span class="hljs-comment">// change1</span><br>    ...<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> &#123;<br>...<br>        <span class="hljs-keyword">if</span> (!::adapter.isInitialized)  <span class="hljs-comment">// change3</span><br>            adapter = MsgAdapter(msgList)<br>...<br>    &#125;<br><br>    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onClick</span><span class="hljs-params">(v: <span class="hljs-type">View</span>?)</span></span> &#123;<br>...<br>        adapter.notifyItemInserted(msgList.size - <span class="hljs-number">1</span>)  <span class="hljs-comment">// change2</span><br>...<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>最后，即使采用这些方法后<code>lateinit var</code>只被初始化了一次，但我们仍不能将<code>lateinit</code>作用于<code>val</code>。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203160110817.png" alt=""></p><p>补充：<code>?.</code>只会对可能为空的变量生效</p><p>补充：依賴注入（Dependency Injection）</p><h3 id="密封类"><a href="#密封类" class="headerlink" title="密封类"></a>密封类</h3>]]></content>
    
    
    
    <tags>
      
      <tag>Android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>算法竞赛自用模板</title>
    <link href="/2022/02/10/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E8%87%AA%E7%94%A8%E6%A8%A1%E6%9D%BF/"/>
    <url>/2022/02/10/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E8%87%AA%E7%94%A8%E6%A8%A1%E6%9D%BF/</url>
    
    <content type="html"><![CDATA[<h1 id="一些魔法习惯"><a href="#一些魔法习惯" class="headerlink" title="一些魔法习惯"></a>一些魔法习惯</h1><ol><li><p>若精度要求为小数点后x位，则<code>esp = 1e-(x + 2)</code>，eg. 精度为小数点后6位，<code>esp = 1e-8</code></p></li><li><p>规模：$10^9$——大，$10^5$——小</p></li><li><p>没给范围默认为$10^6$</p></li><li><p>范围为$10^6$时优先考虑$O(nlogn)$、$O(n)$做法</p></li><li><p>$m\approx n$：稀疏图，$m\approx n^2$ ：稠密图</p></li><li><p>评测机每秒可以计算$10^8$个数据，可以先根据欲使用算法的时间复杂度算一下数据量（详见AcWing 1624 我的题解）</p></li><li><p>常用简写：</p><p><code>i != 0</code> ：<code>i</code>，判断非0</p><p><code>i != -1</code>：<code>~i</code>，判断链表尾（NULL）</p><p><code>u / 2</code>：<code>u &lt;&lt; 1</code>，完全二叉树中的左子结点 </p><p> <code>u / 2 + 1</code>：<code>u &lt;&lt; 1 | 1</code>完全二叉树中的右子结点（左移后最后1位一定是0，在这时<code>0 | 1 = 1</code>等价于<code>0 + 1 = 1</code>）</p><p><code>i % 2  == 1</code>：<code>i &amp; 1</code>，判断奇数</p></li></ol><p>关于7</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    cout &lt;&lt; ~(<span class="hljs-number">-1</span>) &lt;&lt; endl;  <span class="hljs-comment">// 32bit1: -1 -&gt; 32bit0: 0</span><br>    cout &lt;&lt; ~(<span class="hljs-number">0</span>) &lt;&lt; endl;  <span class="hljs-comment">// 32bit0: 0 -&gt; 32bit1: -1</span><br>    cout &lt;&lt; ~(<span class="hljs-number">1</span>) &lt;&lt; endl;  <span class="hljs-comment">// 31bit0||1bit1 -&gt; 31bit1||1bit0: -1 - 1 = -2</span><br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">-5</span>; i &lt;= <span class="hljs-number">5</span>; i ++ ) cout &lt;&lt; <span class="hljs-string">&quot;~(&quot;</span> &lt;&lt; i &lt;&lt; <span class="hljs-string">&quot;):&quot;</span> &lt;&lt; (~i == <span class="hljs-literal">false</span>) &lt;&lt; endl;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs haml">0<br>-<span class="ruby"><span class="hljs-number">1</span></span><br><span class="ruby"></span>-<span class="ruby"><span class="hljs-number">2</span></span><br><span class="ruby"></span>~(-5):0<br>~(-4):0<br>~(-3):0<br>~(-2):0<br>~(-1):1<br>~(0):0<br>~(1):0<br>~(2):0<br>~(3):0<br>~(4):0<br>~(5):0<br></code></pre></td></tr></table></figure><p>所以当<code>~i</code>作为<code>for</code>循环终止条件时会在<code>i</code>为$-1$时退出循环。</p><h1 id="一些调试技巧"><a href="#一些调试技巧" class="headerlink" title="一些调试技巧"></a>一些调试技巧</h1><ol><li>cout大法：输出中间变量</li><li>删：删掉可能ERROR的代码</li><li>exit(0)：相当于把<code>exit(0)</code>后面的都删掉，eg. 可放在建图代码后用于判断是否为建图问题</li><li>iii大法：用于查看算法在某段的输出，eg. 查看前十次输出<code>int iii = 0</code>，<code>cout &lt;&lt; ver &lt;&lt; endl; if ( ++ iii &gt; 10) exit(0);</code>，详见AcWing 1624。</li><li>！、！！、！！！：在关键语句后添加<code>, puts(&quot;!&quot;)</code>以查看其是否执行，详见Acwing1628</li><li>out()：二维矩阵可以写个out函数查看</li></ol><h1 id="树"><a href="#树" class="headerlink" title="树"></a>树</h1><ol><li><p><strong>给定任意两种遍历序列都可以确定二叉树</strong>，但<strong>只根据前序遍历和后序遍历无法确定唯一二叉树</strong>。eg. AcWing 1497. 树的遍历 <strong>AcWing 1609. 前序和后序遍历</strong></p></li><li><p>二叉搜索树（BST）：它的<strong>前序遍历为升序排序</strong>， 它的镜像的前序遍历记为降序排序。eg. AcWing 1527. 判断二叉搜索树</p><p>通过insert建树 eg. AcWing 1605. 二叉搜索树最后两层结点数量</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span> &amp;u, <span class="hljs-keyword">int</span> w)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (!u)  <span class="hljs-comment">// u == 0：没有结点，为其分配索引并赋值</span><br>    &#123;<br>        u = ++ idx;<br>        v[u] = w;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        <span class="hljs-keyword">if</span> (w &lt;= v[u]) <span class="hljs-built_in">insert</span>(l[u], w);<br>        <span class="hljs-keyword">else</span> <span class="hljs-built_in">insert</span>(r[u], w); <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>完全二叉树（CST）：可以使用一个<strong>下标自1起</strong>的数组作为其结构，<strong>左子结点<code>2 * u</code>，右子结点<code>2 * u + 1</code></strong>。其判断方法：判断最大索引和结点个数的大小关系。eg. AcWing 1550. 完全二叉搜索树</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> k)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (u == <span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span> ;<br><br>    <span class="hljs-keyword">if</span> (k &gt; maxk)<br>    &#123;<br>        maxk = k;<br>        maxid = u;<br>    &#125;<br><br>    <span class="hljs-built_in">dfs</span>(l[u], <span class="hljs-number">2</span> * k);<br>    <span class="hljs-comment">// tr[k] = u;</span><br>    <span class="hljs-built_in">dfs</span>(r[u], <span class="hljs-number">2</span> * k + <span class="hljs-number">1</span>);<br>&#125;<br><br>...<br><br><span class="hljs-keyword">if</span> (maxk == n) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;YES %d\n&quot;</span>, maxid);<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (maxk &gt; n)<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;NO %d\n&quot;</span>, root);  <span class="hljs-comment">// 最大索引超过结点个数，说明层序遍历不连续，有空缺结点</span><br><br>...<br></code></pre></td></tr></table></figure></li><li><p>使用树的<strong>非递归</strong>遍历形式还原树需要记录上一次操作 eg. AcWing 1576. 再次树遍历</p></li><li><p><strong>找根</strong>：eg. AcWing 1589. 构建二叉搜索树</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp">...<br>cin &gt;&gt; n;<br>   <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>   &#123;<br>       <span class="hljs-keyword">int</span> x, y;<br>       cin &gt;&gt; x &gt;&gt; y;<br>       l[i] = x, r[i] = y;<br>       has_parent[x] = has_parent[y] = <span class="hljs-literal">true</span>;<br>   &#125;<br>   <br>   <span class="hljs-keyword">int</span> root;<br>   <span class="hljs-keyword">while</span> (has_parent[root]) root ++ ;<br><br>...<br></code></pre></td></tr></table></figure></li><li><p><strong>反转</strong>二叉树 eg. AcWing 1592. 反转二叉树</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">tree_reverse</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (u == <span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span> ;<br><br>    <span class="hljs-built_in">tree_reverse</span>(l[u]);<br>    <span class="hljs-built_in">tree_reverse</span>(r[u]);<br>    <span class="hljs-built_in">swap</span>(l[u], r[u]);<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>PAT评测环境下：<br>树遍历可以传入已打印数量k的引用以控制最后一个空格</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> &amp;k)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (u == <span class="hljs-number">-1</span>) <span class="hljs-keyword">return</span> ;<br><br>    <span class="hljs-built_in">dfs</span>(l[u], k);<br>    cout &lt;&lt; u;<br>    <span class="hljs-keyword">if</span> ( ++ k != n) cout &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span>;<br>    <span class="hljs-built_in">dfs</span>(r[u], k);<br>&#125;<br></code></pre></td></tr></table></figure><p>特殊地，前序遍历可以传入两个root以控制第一个空格</p></li><li><p>AVL树：一种自平衡二叉搜索树，其<strong>左旋</strong>、<strong>右旋</strong>：就是将不平衡的结点“松弛”，也就是说没有向上的力拽着它，然后固定它的子树，那么问题结点就会自然往下掉，如果问题结点下落的一侧有结点，那么将其及其子树滑落到下落结点的另一侧。<strong>每次插入完成后共有四种不平衡情况</strong> eg. AcWing 1552. AVL树的根</p><ol><li>‘<strong>/</strong>‘型：不平衡结点为88，断开70——80，让88自然落下</li></ol><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203040101885.jpeg" alt=""></p><ol><li>‘<strong>\</strong>‘型：不平衡结点为88，断开70——88，让88自然落下</li></ol><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203040101375.jpeg" alt=""></p><ol><li>‘<strong>&gt;</strong>‘型（70——96——88）：断开70——96,96滑落至88右侧，88右侧原来的90滑落到96左侧，形成’\‘型（70——88——96），取消70的“顶点拉力”，让70自然落下</li></ol><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203040101441.jpeg" alt=""></p><ol><li>‘<strong>&lt;</strong>‘型（70——61——65）：不平衡结点为70，断开70——61，让61自然下落，形成’/‘型（70——65——61），断开70——65，让70自然落下</li></ol><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203040102555.jpeg" alt=""></p><p>注：自然落下后裸露出的顶点接回此前上方断开的结点，另外yxc老师是按照这里的1、2、4、3讲的。另外，<strong>虽然流程上是先下落（旋转）后让冲突侧子树下滑，但是代码更新时要先让冲突侧子树下滑</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span></span><br><span class="hljs-function"></span>&#123;<br>    h[u] = <span class="hljs-number">1</span> + <span class="hljs-built_in">max</span>(h[l[u]], h[r[u]]);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_balance</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> h[l[u]] - h[r[u]];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">L</span><span class="hljs-params">(<span class="hljs-keyword">int</span> &amp;u)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> p = r[u];  <span class="hljs-comment">// 固定右子树</span><br>    r[u] = l[p], l[p] = u;  <span class="hljs-comment">// 这里要先操作多余的结点，不是按思维顺序的，可以先理清关系再写</span><br>    <span class="hljs-built_in">update</span>(u), <span class="hljs-built_in">update</span>(p);<br>    u = p;  <span class="hljs-comment">// 更新根的索引</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">R</span><span class="hljs-params">(<span class="hljs-keyword">int</span> &amp;u)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> p = l[u];<br>    l[u] = r[p], r[p] = u;<br>    <span class="hljs-built_in">update</span>(u), <span class="hljs-built_in">update</span>(p);<br>    u = p;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span> &amp;u, <span class="hljs-keyword">int</span> w)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (!u) u = ++ idx, v[u] = w;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        <span class="hljs-keyword">if</span> (w &lt; v[u])<br>        &#123;<br>            <span class="hljs-built_in">insert</span>(l[u], w);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">get_balance</span>(u) == <span class="hljs-number">2</span>)<br>            &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">get_balance</span>(l[u]) == <span class="hljs-number">1</span>) <span class="hljs-built_in">R</span>(u);  <span class="hljs-comment">// 情况1：&#x27;/&#x27;</span><br>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">get_balance</span>(l[u]) == <span class="hljs-number">-1</span>) <span class="hljs-built_in">L</span>(l[u]), <span class="hljs-built_in">R</span>(u);  <span class="hljs-comment">// 情况3：&#x27;&lt;&#x27;</span><br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>            <span class="hljs-built_in">insert</span>(r[u], w);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">get_balance</span>(u) == <span class="hljs-number">-2</span>)<br>            &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-built_in">get_balance</span>(r[u]) == <span class="hljs-number">-1</span>) <span class="hljs-built_in">L</span>(u);  <span class="hljs-comment">// 情况2：&#x27;\&#x27;</span><br>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">get_balance</span>(r[u]) == <span class="hljs-number">1</span>) <span class="hljs-built_in">R</span>(r[u]), <span class="hljs-built_in">L</span>(u);  <span class="hljs-comment">// 情况4：&#x27;&gt;&#x27;</span><br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-built_in">update</span>(u);<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>红黑树（RBT）：是一种平衡二叉搜索树，具有以下五个属性。eg. AcWing 1628. 判断红黑树</p><ul><li><p>节点是红色或黑色。</p></li><li><p><strong>根节点是黑色。</strong></p></li><li><p>所有叶子都是黑色。（叶子是 NULL节点）</p></li><li><p><strong>每个红色节点的两个子节点都是黑色。</strong></p></li><li><p><strong>从任一节点到其每个叶子的所有路径都包含相同数目的黑色节点。</strong>（可以递归判断：对每一个结点判断其左子树和右子树的黑色结点数目，自身使用引用传递自身树黑色结点数目（返回值用来传递根的权值了））</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203040129969.jpeg" alt="红黑树"></p><p>其中<strong>加粗</strong>的部分是RBT的充分条件，判断RBT时只需判断他们是否成立即可。</p></li></ul></li><li><p><strong>将无向图视作树遍历</strong>以求最深根结点的时候记得在dfs里加<code>if (j == father) continue</code><strong>防止走回头路</strong>。 eg. AcWing 1498. PAT 1021. 最深的根</p></li><li><p>如果要求从根节点遍历到<strong>指定叶节点</strong>的深度，可以使用反向dfs + 记忆化搜索 eg. AcWing 1565. 供应链总销售额</p></li><li><p><strong>将堆视作树遍历</strong>以判断其是大根堆还是小根堆时，建立；两个特征<code>bool gt, lt;</code>  gt: is_greater，大根堆特征（路径前一点权值大于后一点权值）， lt: is_less，小根堆特征（路径前一点权值小于后一点权值）。<strong>如果兼具两个特征说明不是堆</strong></p><p>另外，<strong>堆是一种完全二叉树</strong>。</p></li><li><p>trick:</p><ol><li><p>输出二叉树的后序遍历的<strong>第一个</strong>数字。只需要在左右遍历后加入<code>if (!post_first) post_first = root;</code>  只有第一个没有左右儿子的点才会到达并执行这行 eg. AcWing 1631. 后序遍历</p></li><li><p><strong>Z 字形</strong>遍历 eg. AcWing 1620. Z 字形遍历二叉树<br><strong>注意reverse范围[first, last)</strong></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203040050191.png" alt=""></p><p>牢记<strong>中序遍历：root左侧是左子树，右侧是右子树</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">bfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> root)</span></span><br><span class="hljs-function"></span>&#123;<br>    q[ ++ tt] = root;<br>    <br>    <span class="hljs-keyword">int</span> depth = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (hh &lt;= tt)<br>    &#123;<br>        <span class="hljs-keyword">int</span> start = hh, end = tt;<br>        <br>        <span class="hljs-keyword">while</span> (hh &lt;= end)<br>        &#123;<br>            <span class="hljs-keyword">int</span> t = q[hh ++ ];<br>            <span class="hljs-keyword">if</span> (l.<span class="hljs-built_in">count</span>(t)) q[ ++ tt] = l[t];<br>            <span class="hljs-keyword">if</span> (r.<span class="hljs-built_in">count</span>(t)) q[ ++ tt] = r[t];<br>        &#125;<br>        <span class="hljs-keyword">if</span> ( ++ depth % <span class="hljs-number">2</span>) <span class="hljs-built_in">reverse</span>(q + start, q + end + <span class="hljs-number">1</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>由任意两序还原二叉树，<strong>构建子树时的build(…)代码长度一样</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">if</span> (il &lt; k) lchild = <span class="hljs-built_in">build</span>(il, k - <span class="hljs-number">1</span>, pl + <span class="hljs-number">1</span>, pl + <span class="hljs-number">1</span> + k - <span class="hljs-number">1</span> - il, lsum);<br><span class="hljs-keyword">if</span> (ir &gt; k) rchild = <span class="hljs-built_in">build</span>(k + <span class="hljs-number">1</span>, ir, pl + <span class="hljs-number">1</span> + k - <span class="hljs-number">1</span> - il + <span class="hljs-number">1</span>, pr, rsum);<br></code></pre></td></tr></table></figure></li></ol></li></ol><h1 id="数论"><a href="#数论" class="headerlink" title="数论"></a>数论</h1><h2 id="欧拉筛法"><a href="#欧拉筛法" class="headerlink" title="欧拉筛法"></a>欧拉筛法</h2><p>因能在线性时间 $O(n)$ 内筛选出素数集合，故又称线性筛法。</p><p>先给出代码，之后给出正确性证明</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1000010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> primes[N], cnt;<br><span class="hljs-keyword">bool</span> st[N];  <span class="hljs-comment">// 0：没被筛过 1：被筛过</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">get_primes</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">if</span> (!st[i]) primes[cnt ++ ] = i;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; primes[j] &lt;= n / i; j ++ )<br>        &#123;<br>            st[primes[j] * i] = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">if</span> (i % primes[j] == <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    cin &gt;&gt; n;<br>    <span class="hljs-built_in">get_primes</span>(n);<br>    <br>    <span class="hljs-comment">// for (int i = 0; i &lt; cnt; i ++ ) cout &lt;&lt; primes[i] &lt;&lt; &#x27; &#x27;;</span><br>    <span class="hljs-comment">// cout &lt;&lt; endl;</span><br>    <br>    cout &lt;&lt; cnt;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>欧拉筛法的时间复杂度优于埃氏筛法的原因就在于：</p><ol><li>埃氏筛法的一个合数可能被它的多个质因数重复筛去</li><li>欧拉筛法的一个合数只会被它的最小质因数筛去</li></ol><p>那么其正确性需要证明两点：</p><ol><li><p>所有合数都会被筛去</p><p>$proof：$</p><p>假设任意合数 $ x = p * x_0$ ，其中 $ p $ 是 $ x $ 的最小质因子，那么 $ x_0 $ 即为 $ x $ 的最大因子。显然地，有 $ p \leq x_0 &lt; x$  。 </p><p>当筛法遍历至 $ p $ 时，因 $ p $ 为素数，故有 $ p \in primes $ 。</p><p>当筛法遍历至 $ x_0 $ 时，必会执行<code>st[primes[j] * i] = true;</code>( $ i = x_0, prime[j] = p$)将 $ x $ 筛掉。</p><p>即任意合数 $ x $ 必会在算法遍历至 $ x_0 $ 时被筛掉</p><p>$ Q.E.D$</p></li><li><p>每个合数只会被其最小质因数筛去（没有重复筛去）</p><p>$ proof: $</p><p>因<code>if (i % primes[j] == 0) break;</code>及$primes[j]$递增，所以筛法中的$primes[j]$必小于等于 $i$ 的最小质因数 $p$ 。</p><p>当筛法执行时</p><p>若<code>i % primes[j] != 0</code>，则$primes[j] &lt; p$，$primes[j]$ 是合数 $primes[j] * i$ 的最小质因数</p><p>若<code>i % primes[j] == 0</code>，则$primes[j] = p$，$primes[j]$ 仍是合数  $primes[j] * i$ 的最小质因数</p><p>即每个合数只会被其最小质因数筛去。</p><p>$ Q.E.D$</p></li></ol><p>内层循环枚举质数的条件为<code>primes[j] &lt;= n / i</code>是因为其等价于 $ primes[j] * i \leq n$，即被筛合数应小于指定范围 $ n $。 </p><p>也不需要加 <code>j &lt; cnt</code>防止越界，因为：</p><p>当 $i $ 为合数时， $primes[j]$ 枚举至 $i$ 的最小质因子 $ p $ 时一定会<code>break;</code>，此时必有$ p = primes[j] \in primes $ 。</p><p>当 $i $ 为质数时，$primes[j]$ 枚举至 $i$ 时一定会<code>break;</code>而 $i = primes[j]$刚刚在上一行被加入 $primes$ ，故仍必有$ primes[j] \in primes $ 。</p><p>另外，一个显然的事情，<code>st[primes[j] * i] = true;</code>筛去的是一个乘积，它必是一个合数。</p><h2 id="欧拉函数-varphi-n"><a href="#欧拉函数-varphi-n" class="headerlink" title="欧拉函数$ {\varphi (n)} $"></a>欧拉函数$ {\varphi (n)} $</h2><p>若</p><script type="math/tex; mode=display">n = p_{1}^{\alpha_{1} } p_{2}^{\alpha_{2} } \cdots p_{k}^{\alpha_{k}}</script><p>则</p><script type="math/tex; mode=display">\varphi (n)=n\left(1-{\frac {1}{p_{1} } }\right)\left(1-{\frac {1}{p_{2} } }\right)\cdots \left(1-{\frac {1}{p_{k} } }\right).</script><p>其值为 小于等于n的正整数中与n互质的数的数目。</p><p>时间复杂度：$O(\sqrt n)$</p><p>由来：容斥原理</p><p>……..</p><script type="math/tex; mode=display">{\varphi (i)=i\left(1-{\frac {1}{p_{1} } }\right)\left(1-{\frac {1}{p_{2} } }\right)\cdots \left(1-{\frac {1}{p_{k} } }\right)}</script><p><code>if (i % primes[j] == 0)</code></p><p>此时 $primes[j]$ 等于 $i$ 的最小质因数 $ p_1 $ ，故 <script type="math/tex">primes[j] * i</script> 和 <script type="math/tex">i</script> 的质因数完全相同，只需更换第一项为 <script type="math/tex">primes[j] * i</script> 。 </p><script type="math/tex; mode=display">{\varphi (primes[j] * i)=primes[j] * i\left(1-{\frac {1}{p_{1} } }\right)\left(1-{\frac {1}{p_{2} } }\right)\cdots \left(1-{\frac {1}{p_{k} } }\right)}=primes[j] * \varphi (i)</script><p><code>if (i % primes[j] != 0)</code></p><p>此时 $primes[j]$ 小于 $i$ 的最小质因数 $ p_1 $，又因其是质数，故 <script type="math/tex">primes[j] * i</script> 比 <script type="math/tex">i</script> 多出一个质因数 <script type="math/tex">primes[j]</script> ，因此需要更换第一个因数为 <script type="math/tex">primes[j] * i</script> 并增加一项 <script type="math/tex">\left(1-{\frac {1}{primes[j]} }\right)</script> 。</p><script type="math/tex; mode=display">{\varphi (primes[j] * i)=primes[j] * i\left(1-{\frac {1}{primes[j]} }\right)\left(1-{\frac {1}{p_{1} } }\right)\left(1-{\frac {1}{p_{2} } }\right)\cdots \left(1-{\frac {1}{p_{k} } }\right)} =(primes[j] - 1) * \varphi (i)</script><h2 id="求逆元"><a href="#求逆元" class="headerlink" title="求逆元"></a>求逆元</h2><h3 id="由费马小定理-Fermat’s-little-theorem-求逆元"><a href="#由费马小定理-Fermat’s-little-theorem-求逆元" class="headerlink" title="由费马小定理($Fermat’s\ little\ theorem$)求逆元"></a>由费马小定理($Fermat’s\ little\ theorem$)求逆元</h3><p>假如 ${a}$ 是一个整数， <strong>${p}$ 是一个质数</strong>，如果 $ a$ 不是 $p$ 的倍数，那么</p><script type="math/tex; mode=display">a^{p-1} \equiv 1{\pmod {p}}</script><p>其等价于</p><script type="math/tex; mode=display">a \cdot a^{p-2} \equiv 1{\pmod p}</script><p>那么 $a^{p-2}$ 即为 $a$ 的逆元。</p><h3 id="使用扩展欧几里得算法求逆元"><a href="#使用扩展欧几里得算法求逆元" class="headerlink" title="使用扩展欧几里得算法求逆元"></a>使用扩展欧几里得算法求逆元</h3><p>扩展欧几里得算法不要求模数为质数，但要求<strong>$x$ 、$m$ 互质</strong>。</p><p>同余方程</p><script type="math/tex; mode=display">ax \equiv 1 \pmod m</script><p>其等价一般方程：</p><script type="math/tex; mode=display">ax = 1 + y m</script><p>令 $y = -y$ ，有裴蜀等式：</p><script type="math/tex; mode=display">ax + ym = 1</script><p>由裴蜀定理，当且仅当</p><script type="math/tex; mode=display">gcd(x, m) = d\ |\ 1</script><p>时，裴蜀等式有解。</p><p>即 $d = 1$ ，$x$ 、$m$ 互质时，$a$ 有逆元。</p><h2 id="一次同余方程组"><a href="#一次同余方程组" class="headerlink" title="一次同余方程组"></a>一次同余方程组</h2><p>一次同余方程组有两种形式：</p><ol><li>模数 $m_1, m_2, \dots, m_n$两两互质</li><li>模数 $m_1, m_2, \dots, m_n$不两两互质</li></ol><p>对于情况1，可使用中国剩余定理或一般解法;<br>对于情况2，则只能使用一般解法。</p><p><strong>一般解法：</strong><br>两个同余方程时：</p><script type="math/tex; mode=display">\begin{cases}x \equiv a_{1} \mod m_{1}\\\x \equiv a_{2} \mod m_{2}\end{cases}</script><p>其等价的一般方程形式：</p><script type="math/tex; mode=display">\begin{cases}x = a_{1} + k_{1} * m_{1} & k_{1} \in \mathbb{Z}\\\x = a_{2} + k_{2} * m_{2} & k_{2} \in \mathbb{Z}\end{cases}</script><p>联立，有裴蜀等式（右侧的等式）：</p><script type="math/tex; mode=display">x = a_{1} + k_{1} * m_{1} = a_{2} + k_{2} * m_{2}</script><p>令 $k_2 = -k_2$，移项，有：</p><script type="math/tex; mode=display">k_{1} * m_{1} + k_{2} * m_{2} = a_{2} - a_{1}</script><p>由裴蜀定理，当且仅当<script type="math/tex">gcd(m_1, m_2) = d\ |\ (a_{2} - a_{1})</script>时，裴蜀等式有整数解。<br>有解时，使用扩展欧几里得算法，可求得方程</p><script type="math/tex; mode=display">k_{01} * m_{1} + k_{02} * m_{2} = d</script><p>的一组可行解<script type="math/tex">(k_{01}, k_{02})</script><br>两侧同乘<script type="math/tex">\frac{a_{2} - a_{1}}{d}</script>，可得原方程的一组可行解<script type="math/tex">(k_{01} * \frac{a_{2} - a_{1}}{d}, k_{02} * \frac{a_{2} - a_{1}}{d})</script><br>又由裴蜀定理，可得原方程的通解</p><script type="math/tex; mode=display">{\{(k_1 = k_{01} * \frac{a_{2} - a_{1}}{d}+{k\frac {m_2}{d}},k_2 = k_{02} * \frac{a_{2} - a_{1}}{d}-{k\frac {m_1}{d}})\mid k\in \mathbb {Z} \}}</script><p>又</p><script type="math/tex; mode=display">x = a_{1} + k_{1} * m_{1}</script><p>所以要求最小非负整数 $x$ ，就要求最小非负整数 $k_1$ ，只需</p><script type="math/tex; mode=display">k_1 = k_1 \% \frac{m_2}{d}</script><p>此时即可得方程组的最小非负解</p><p>最后，使用原方程组通解 <script type="math/tex">k_{01} * \frac{a_{2} - a_{1}}{d}+{k\frac {m_2}{d}}</script> 进行推导得到通解的同余形式以进行多个同余方程时的运算</p><script type="math/tex; mode=display">x = a_{1} + k_{1} * m_{1}</script><script type="math/tex; mode=display">x = a_1 + (k_{01} * \frac{a_{2} - a_{1}}{d}+{k\frac {a_2}{d}}) * m_1</script><script type="math/tex; mode=display">x = a_1 + k_{01} * \frac{a_{2} - a_{1}}{d} * m_1 + {k\frac {m_2 * m_1}{d}}</script><p>即：</p><script type="math/tex; mode=display">x \equiv a_1 + k_{01} * \frac{a_{2} - a_{1}}{d} * m_1 \pmod {\frac {m_2 * m_1}{d}}</script><p>与原式同构，可得更新方程：</p><script type="math/tex; mode=display">\begin{cases}a_1 = a_1 + k_{01} * \frac{a_{2} - a_{1}}{d} * m_1\\\m_1 = \frac {m_1 * m_2}{d}\end{cases}</script><h1 id="组合数学"><a href="#组合数学" class="headerlink" title="组合数学"></a>组合数学</h1><p>根据数据量的不同，可以使用不同复杂度的方法解题。</p><h2 id="预处理结果"><a href="#预处理结果" class="headerlink" title="预处理结果"></a>预处理结果</h2><p>由组合数递推公式预处理结果，时间复杂度$O(n^2)$ $eg. 1\leq b\leq a\leq 2000$</p><script type="math/tex; mode=display">C_a^b = C_{a-1}^{b-1} +C_{a-1}^b</script><p>从 $a$ 个元素中选取 $b$ 个元素，等价于：对于某个元素，</p><p>若选取它，则还需从剩余 $a - 1$ 个元素中选取 $b - 1$ 个元素；</p><p>若不选取它，则还需从剩余 $a - 1$ 个元素中选取 $b$ 个元素。</p><h2 id="预处理阶乘及其逆元"><a href="#预处理阶乘及其逆元" class="headerlink" title="预处理阶乘及其逆元"></a>预处理阶乘及其逆元</h2><p>预处理阶乘及其逆元，时间复杂度$O(nlogn)$ $eg. 1\leq b\leq a\leq 10^5$</p><p>在同余式中可以将除数视作逆元，如下</p><script type="math/tex; mode=display">C_a^b = a!\ b!^{-1}\ (a - b)!^{-1}(mod\ p)</script><blockquote><p>两个 $ 10^9 $相乘不会在 $ long\ long $ 范围内溢出 ，三个会。</p><p>mod = 1e9 + 7是比1e9大的第一个质数</p></blockquote><p>阶乘递推公式（定义）</p><script type="math/tex; mode=display">n! = (n - 1)! \cdot n</script><p>对等式取逆得阶乘逆元递推公式</p><script type="math/tex; mode=display">n!^{-1} = (n - 1)!^{-1} \cdot n^{-1}</script><h2 id="卢卡斯定理"><a href="#卢卡斯定理" class="headerlink" title="卢卡斯定理"></a>卢卡斯定理</h2><p>卢卡斯定理（$Lucas’s\ theorem$）时间复杂度 <script type="math/tex">O(plogn)</script> $eg. 1\leq b\leq a\leq 10^{18},1 \leq p \leq 10^5$</p><p>一次递归：</p><script type="math/tex; mode=display">C_a^b\pmod p = C_{\left\lfloor a/p\right\rfloor}^{\left\lfloor b/p \right\rfloor} \cdot C_{a\bmod p}^{b\bmod p}\pmod p</script><p>最终把a, b变成p进制</p><h2 id="分解质因数"><a href="#分解质因数" class="headerlink" title="分解质因数"></a>分解质因数</h2><p>分解质因数，将阶乘转换为乘法，这样也可以进行高精度运算。</p><p>即</p><script type="math/tex; mode=display">C_a^b = \frac{a!}{b!(a - b)!} = p_{1}^{\alpha_{1} } p_{2}^{\alpha_{2} } \cdots p_{k}^{\alpha_{k}}</script><p>我们可以通过枚举所有素数 <script type="math/tex">p</script> ，计算所有 <script type="math/tex">\alpha</script>，就是先计算 <script type="math/tex">a!</script>中 <script type="math/tex">p</script> 的个数，然后再减去<script type="math/tex">b!</script> 和 <script type="math/tex">(a - b)!</script>中 <script type="math/tex">p</script> 的个数即可。</p><h2 id="卡特兰数"><a href="#卡特兰数" class="headerlink" title="卡特兰数"></a>卡特兰数</h2><p>卡特兰数(<script type="math/tex">Catalan\ number</script>)</p><p>卡特兰数有多种常见公式。</p><script type="math/tex; mode=display">C_n = C_{2n}^{n} - C_{2n}^{n +1}=\frac{C_{2n}^{n}}{n + 1} \quad\mbox{ for }n\ge 1</script><p>卡特兰数列往往包含很多问题的解，所以重要的是分析出问题的规律以应用卡特兰公式。</p><div class="table-container"><table><thead><tr><th style="text-align:center">$H_0$</th><th style="text-align:center">$H_1$</th><th style="text-align:center">$H_2$</th><th style="text-align:center">$H_3$</th><th style="text-align:center">$H_4$</th><th style="text-align:center">$H_5$</th><th style="text-align:center">$H_6$</th><th style="text-align:center">$\dots$</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">1</td><td style="text-align:center">2</td><td style="text-align:center">5</td><td style="text-align:center">14</td><td style="text-align:center">42</td><td style="text-align:center">132</td><td style="text-align:center">$\dots$</td></tr></tbody></table></div><p>关于卡特兰数的更多知识包含在这里：<a href="https://oeis.org/A000108">OEIS A000108</a></p><p>这里给出一种构造性证明方法：</p><p>$ proof: $</p><p>考虑含 $n$ 个 $+1$ 、$n$ 个 $-1$ 的所有序列，长度为 $2n$。</p><p>其中满足前缀和条件</p><script type="math/tex; mode=display">a_1 + a_2 + \dots + a_k \geq 0  \quad\mbox{ for } k = 1, 2, \dots, 2n</script><p>的序列的数量即为卡特兰数 <script type="math/tex">C_n</script> 。</p><p>首先，含 $n$ 个 $+1$ 、$n$ 个 $-1$ 的所有序列，长度为 $2n$ 的序列数量共有 <script type="math/tex">C_{2n}^{n}</script> 。</p><p>考虑由 <script type="math/tex">n + 1</script> 个 <script type="math/tex">+1</script> 和 <script type="math/tex">n - 1</script> 个 <script type="math/tex">-1</script> 组成的序列 <script type="math/tex">b_1, b_2, \dots b_{2n}</script>，可知<script type="math/tex">b_1 + b_2 + \dots + b_k = 2</script>，其数量为 <script type="math/tex">C_{2n}^{n + 1}= C_{2n}^{n - 1}</script> 。</p><p>其必存在 <script type="math/tex">m</script> 使得<script type="math/tex">b_1 + b_2 + \dots + b_m > 0</script> 且 <script type="math/tex">+1</script> 的数量比 <script type="math/tex">-1</script> 的数量多 $1$ 。</p><p>令</p><script type="math/tex; mode=display">c_1 = -b_1, c_2 = -b_2, \dots c_m = -b_m, c_{m + 1} = b_{m + 1}, c_{m + 2} = b_{m + 2}, \dots, c_{2n} = b_{2n}</script><p>则</p><script type="math/tex; mode=display">\begin{cases} c_1 + c_2 + \dots + c_m < 0\\ c_1 + c_2 + \dots + c_m + c_{m + 1} + c_{m + 2} + c_{2n} \ge 0 \end{cases}</script><p>且含 $n$ 个 $+1$ 、$n$ 个 $-1$ （对前 $m$ 个数取相反数后， <script type="math/tex">+1</script> 的数量比 <script type="math/tex">-1</script> 的数量少 $1$ ）。</p><p>那么序列 <script type="math/tex">c_1, c_2, \dots c_{2n}</script> 即为不满足前缀和条件的序列，其数量为 <script type="math/tex">C_{2n}^{n + 1}</script> 或 <script type="math/tex">C_{2n}^{n - 1}</script>。</p><p>即可得满足前缀和条件的序列的数量为 <script type="math/tex">C_n = C_{2n}^{n} - C_{2n}^{n + 1} = C_{2n}^{n} - C_{2n}^{n - 1}</script>。</p><p>$Q.E.D$</p><h2 id="组合恒等式"><a href="#组合恒等式" class="headerlink" title="组合恒等式"></a>组合恒等式</h2><script type="math/tex; mode=display">C_n^0+C_n^1+\dots+C_n^n = 2^n</script><p>等式两侧的意义均为从n个数中选出任意个数的方案数量。</p><script type="math/tex; mode=display">C_k^1-C_k^2+C_k^3+\dots+(-1)^{k-1}C_k^k = 1</script><p>$proof:$</p><script type="math/tex; mode=display">-C_k^0+C_k^1-C_k^2+C_k^3+\dots+(-1)^{k-1}C_k^k = 0</script><script type="math/tex; mode=display">C_k^0-C_k^1+C_k^2-C_k^3+\dots+(-1)^{k}C_k^k = 0</script><p>由二项式定理得：</p><script type="math/tex; mode=display">(1+(-1))^k = 0</script><p>$Q.E.D$</p><h1 id="博弈论"><a href="#博弈论" class="headerlink" title="博弈论"></a>博弈论</h1><h2 id="有向图游戏"><a href="#有向图游戏" class="headerlink" title="有向图游戏"></a>有向图游戏</h2><p>有向图游戏是一个经典的博弈游戏——实际上，大部分的公平组合游戏（<strong>I</strong>mpartial <strong>C</strong>ombinatorial <strong>G</strong>ames，<strong>ICG</strong>）都可以转换为有向图游戏。</p><p>在一个<strong>有向无环图（DAG）</strong>中，只有一个起点，上面有一个棋子，两个玩家轮流沿着有向边推动棋子，不能走的玩家判负。</p><h2 id="Nim游戏"><a href="#Nim游戏" class="headerlink" title="Nim游戏"></a>Nim游戏</h2><p>$n$ 堆物品，每堆有 $a_i$ 个，两个玩家轮流取走任意一堆的任意个物品，但不能不取。</p><p>取走最后一个物品的人获胜。</p><p>首先我们知道：<br>败态：<script type="math/tex">0 \oplus 0 \oplus 0 \dots \oplus 0 = 0</script></p><p>接着，我们可以按异或和是否为0将所有状态分为两类：状态1和状态2<br>状态1：<script type="math/tex">a_1 \oplus a_2 \oplus \dots \oplus a_n = x \neq 0</script></p><p>状态2：<script type="math/tex">a_1 \oplus a_2 \oplus \dots \oplus a_n = 0</script></p><p>再然后，若操作者足够聪明，我们可以发现两件事情：</p><ol><li>对状态1操作后一定会转移至状态2</li><li>对状态2操作后一定会转移至状态1</li></ol><p>先证明1:</p><p>$proof:$<br>设 $x$ 中二进制最高位 $1$ 在第 $k$ 位<br>则必存在 $a_i$ 的第 $k$ 位为 $1$，即</p><script type="math/tex; mode=display">a_1 \oplus a_2 \oplus \dots \oplus a_i \oplus \dots \oplus a_n = x \neq 0</script><p>（因为操作者足够聪明，他知道若想将此状态转移至状态2只需在两侧同时异或 $x$ ，也就是将 $a_i$ 变为 $a_i \oplus x$，所以他做了如下操作）</p><p>从$a_i$堆中<strong>拿走</strong> $a_i-a_i \oplus x$ 个石子，因为 $a_i$ 和 $ a_i \oplus x $ 位数相同，且 $ a_i \oplus x $ 在第 $k$ 位上为 $0$，$ a_i $ 在第 $k$ 位上为 $1$ ，所以 $a_i-a_i \oplus x &gt; 0$ ，操作合法。<br>那么操作后 $a_i$ 堆剩余 $ a_i - (a_i-a_i \oplus x) = a_i \oplus x$ 个石子，新状态为：</p><script type="math/tex; mode=display">a_1 \oplus a_2 \oplus \dots \oplus (a_i \oplus x) \oplus \dots \oplus a_n = x \oplus x = 0</script><p>即状态2<br>$Q.E.D$</p><p>再证明2:</p><p>$proof:$<br>假设对状态2操作后仍在状态2。<br>若拿取第 $a_i$ 堆，拿取后变为 $a_i^{\prime}$，$ a_i^{\prime} &lt; a_i $<br>拿取前：</p><script type="math/tex; mode=display">a_1 \oplus a_2 \oplus \dots \oplus a_i \oplus \dots \oplus a_n = 0</script><p>由假设，拿取后：</p><script type="math/tex; mode=display">a_1 \oplus a_2 \oplus \dots \oplus a_i^{\prime} \oplus \dots \oplus a_n = 0</script><p>对两式进行异或，有：</p><script type="math/tex; mode=display">a_i \oplus a_i^{\prime} = 0</script><script type="math/tex; mode=display">a_i = a_i^{\prime}</script><p>与 $ a_i^{\prime} &lt; a_i $ 矛盾，故假设不成立，原命题成立。</p><p>$Q.E.D$</p><p>从这两件事情我们可以发现，<strong>拿到状态2的人永远只会在状态2</strong></p><p>又因为每人每次拿走石子的数量 $\geq$ 1，<br>所以在状态2的人，他的石子数量一定会单调递减，最后转移至败态。</p><p>所以我们称状态1为必胜态，状态2为必败态。</p><p>因此我们可以通过判断初态的异或和为 $0$ 与否，去判断先手方是否必胜，也就是：<br><strong>初态异或和不为0时，先手方必胜。<br>初态异或和为0时，先手方必败。</strong></p><h2 id="斯普莱格–格隆第定理（S-G定理）"><a href="#斯普莱格–格隆第定理（S-G定理）" class="headerlink" title="斯普莱格–格隆第定理（S-G定理）"></a>斯普莱格–格隆第定理（S-G定理）</h2><p>斯普莱格–格隆第定理（$Sprague–Grundy\ theorem$）</p><p>该定理指出，所有的一般胜利条件下的<a href="https://zh.wikipedia.org/wiki/无偏博弈">无偏博弈</a>都能转换成单堆Nim游戏或其无限泛化。</p><p>定理做如下定义：</p><p>$mex$ (minimum exclusion)：译作“最小排除”，意为良序集合的补集的最小值。</p><p>即：</p><script type="math/tex; mode=display">\operatorname{mex}(S)=\min(\complement_NS)</script><p>对于状态 $x$ 和它的所有 $k$ 个后继状态 $y_1, y_2, \dots, y_k$ ，定义 $SG$ 函数：</p><script type="math/tex; mode=display">\operatorname{SG}(x)=\operatorname{mex}(\{\operatorname{SG}(y_1), \operatorname{SG}(y_2), \ldots, \operatorname{SG}(y_k)\})</script><p>注：${\operatorname {mex} (\emptyset )=0}$，即终点状态的 $SG$ 值为 $0$ 。</p><p>那么，</p><p>对于由 $n$ 个有向图游戏组成的组合游戏，设它们的起点分别为 $s_1, s_2, \dots, s_n $，当且仅当</p><script type="math/tex; mode=display">\operatorname{SG}(s_1) \oplus \operatorname{SG}(s_2) \oplus \ldots \oplus \operatorname{SG}(s_n) \neq 0</script><p>时，先手方必胜。即：</p><p><strong>初态sg异或和不为0时，先手方必胜。</strong></p><p><strong>初态sg异或和为0时，先手方必败。</strong></p><p>证明方法类似Nim游戏。</p><p>同时，<strong><script type="math/tex">\operatorname{SG}(s_1) \oplus \operatorname{SG}(s_2) \oplus \ldots \oplus \operatorname{SG}(s_n)</script>还是该组合游戏的 $SG$ 值。</strong>（可以用在新状态有多个子状态时计算新状态的SG值，eg. AcWing 894. 拆分-Nim游戏）</p><p>eg. AcWing 893. 集合-Nim游戏（每堆石子对应一个DAG）</p><h1 id="动态规划"><a href="#动态规划" class="headerlink" title="动态规划"></a>动态规划</h1><h2 id="背包DP"><a href="#背包DP" class="headerlink" title="背包DP"></a>背包DP</h2><p>闫学灿热狗模型</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203172355958.jpeg" alt=""></p><h3 id="0-1背包"><a href="#0-1背包" class="headerlink" title="0-1背包"></a>0-1背包</h3><blockquote><p>有 $N$ 件物品和一个容量是 $V$ 的背包。<strong>每件物品只能使用一次</strong>。</p><p>第 $i$ 件物品的体积是 $v_i$，价值是 $w_i$。</p><p>求解将哪些物品装入背包，可使这些物品的总体积不超过背包容量，且总价值最大。<br>输出最大价值。</p></blockquote><p>在这种问题中，每件物品的数量的取值域为 ${0, 1}$，故称0-1背包问题。</p><p>写作最优化形式，即为：</p><script type="math/tex; mode=display">max & \ \sum _{i=1}^{n}w_{i}x_{i}\\s.t. & \ \sum _{i=1}^{n}v_{i}x_{i}\leq V \ and \ x_{i}\in \{0,1\}</script><h3 id="完全背包"><a href="#完全背包" class="headerlink" title="完全背包"></a>完全背包</h3><blockquote><p>有 $N$ 件物品和一个容量是 $V$ 的背包。<strong>每种物品都有无限件可用</strong>。</p><p>第 $i$ 件物品的体积是 $v_i$，价值是 $w_i$。</p><p>求解将哪些物品装入背包，可使这些物品的总体积不超过背包容量，且总价值最大。<br>输出最大价值。</p></blockquote><p>在这种问题中，每件物品的数量的取值域为 ${\mathbb {N} _{0}=\mathbb {N} ^{0}={0,1,2,\dots }}$，故称完全背包问题，国际上称无界背包问题（<strong>u</strong>nbounded <strong>k</strong>napsack <strong>p</strong>roblem, <strong>UKP</strong>）。</p><p>最优化形式：</p><script type="math/tex; mode=display">max & \ \sum _{i=1}^{n}w_{i}x_{i}\\s.t. & \ \sum _{i=1}^{n}v_{i}x_{i}\leq V \ and \ x_{i}\in \mathbb {N} _{0}</script><h3 id="多重背包"><a href="#多重背包" class="headerlink" title="多重背包"></a>多重背包</h3><blockquote><p>有 $N$ <strong>种</strong>物品和一个容量是 $V$ 的背包。</p><p><strong>第 $i$ 种物品最多有 $s_i$ 件</strong>，每件体积是 $v_i$，价值是 $w_i$。</p><p>求解将哪些物品装入背包，可使物品体积总和不超过背包容量，且价值总和最大。<br>输出最大价值。</p></blockquote><p>在这种问题中，每件物品的数量的取值域为 $ {0,1,2,\dots , s_i } $，故称多重背包问题，国际上称有界背包问题（<strong>b</strong>ounded <strong>k</strong>napsack <strong>p</strong>roblem , <strong>BKP</strong>）</p><p>最优化形式：</p><script type="math/tex; mode=display">max & \ \sum _{i=1}^{n}w_{i}x_{i}\\s.t. & \ \sum _{i=1}^{n}v_{i}x_{i}\leq V \ and \ x_{i}\in  \{0,1,2,\dots , s_i \}</script><h3 id="分组背包"><a href="#分组背包" class="headerlink" title="分组背包"></a>分组背包</h3><blockquote><p>有 $N$ <strong>组</strong>物品和一个容量是 $V$ 的背包。</p><p>每组物品有若干个，<strong>同一组内的物品最多只能选一个</strong>。<br>每件物品的体积是 $v<em>{ij}$，价值是 $w</em>{ij}$，其中 $i$ 是组号，$j$ 是组内编号。</p><p>求解将哪些物品装入背包，可使物品总体积不超过背包容量，且总价值最大。</p><p>输出最大价值。</p></blockquote><h2 id="线性DP"><a href="#线性DP" class="headerlink" title="线性DP"></a>线性DP</h2><p>特征：状态的推导是按照问题规模 <code>i</code> 从小到大依次推过去的，较大规模的问题的解依赖较小规模的问题的解。</p><h2 id="区间DP"><a href="#区间DP" class="headerlink" title="区间DP"></a>区间DP</h2><p>特征：求一个区间的最优值，一个区间的最优值由两个或多个小区间合并而来。</p><p>DP问题的起始下标选择：若状态转移方程中含有<code>f[i - 1]</code>，那么令<code>i</code>的起始下标为1；若不含，则可为<code>0</code>。</p><p>$状态转移方程的时间复杂度 = 状态数量（方程左边） \times 转移数量（方程右边）$</p><h1 id="时空复杂度分析"><a href="#时空复杂度分析" class="headerlink" title="时空复杂度分析"></a>时空复杂度分析</h1><p>看起来，我们已经学完了大部分内容！</p><p>但是，怎么根据题目、范围来选定算法呢？没有这第0步，我们后面的步就容易白给。</p><h2 id="由数据范围反推算法复杂度以及算法内容"><a href="#由数据范围反推算法复杂度以及算法内容" class="headerlink" title="由数据范围反推算法复杂度以及算法内容"></a>由数据范围反推算法复杂度以及算法内容</h2><p><strong>这部分转自闫学灿老师。</strong></p><p>一般ACM或者笔试题的时间限制是1秒或2秒。<br>在这种情况下，C++代码中的操作次数控制在 $10^7∼10^8$ 为最佳。</p><p>下面给出在不同数据范围下，代码的时间复杂度和算法该如何选择：</p><p>$n \leq 30 \Rightarrow$ 指数级别 ：dfs+剪枝，状态压缩dp<br>$n≤100 \Rightarrow O(n^3)$ ：floyd，dp，高斯消元<br>$n≤1000 \Rightarrow O(n^2), O(n^2logn)$ ：dp，二分，朴素版Dijkstra、朴素版Prim、Bellman-Ford<br>$n≤10000 \Rightarrow O(n∗\sqrt{n})$ ：块状链表、分块、莫队<br>$n≤100000 \Rightarrow O(nlogn)$ ：各种sort，线段树、树状数组、set/map、heap、拓扑排序、dijkstra+heap、prim+heap、Kruskal、spfa、求凸包、求半平面交、二分、CDQ分治、整体二分、后缀数组、树链剖分、动态树<br>$n≤1000000 \Rightarrow O(n)$, 以及常数较小的 $O(nlogn)$ 算法 ： 单调队列、 hash、双指针扫描、并查集，kmp、AC自动机，常数比较小的 $O(nlogn)$ 的做法 ：sort、树状数组、heap、dijkstra、spfa<br>$n≤10000000 \Rightarrow O(n)$ ：双指针扫描、kmp、AC自动机、线性筛素数<br>$n≤10^9 \Rightarrow O(\sqrt{n})$ ：判断质数<br>$n≤10^{18} \Rightarrow O(logn)$ ：最大公约数，快速幂，数位DP<br>$n≤10^{1000} \Rightarrow O((logn)^2)$ ：高精度加减乘除<br>$n≤10^{100000} \Rightarrow O(logk×loglogk)$ ：k表示位数，高精度加减、FFT/NTT</p><p>作者：yxc<br>链接：<a href="https://www.acwing.com/blog/content/32/">https://www.acwing.com/blog/content/32/</a><br>来源：AcWing<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p><h2 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h2><h2 id="空间复杂度"><a href="#空间复杂度" class="headerlink" title="空间复杂度"></a>空间复杂度</h2><h3 id="静态分析方法"><a href="#静态分析方法" class="headerlink" title="静态分析方法"></a>静态分析方法</h3><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span>Byte = <span class="hljs-number">8</span>bit<br><span class="hljs-symbol">1 </span>KB = <span class="hljs-number">1024</span> Byte<br><span class="hljs-symbol">1 </span>MB = <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> Byte<br><span class="hljs-symbol">1 </span>GB = <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> Byte<br><br><span class="hljs-symbol">1 </span>bool = <span class="hljs-number">1</span> Byte<br><span class="hljs-symbol">1 </span>char = <span class="hljs-number">1</span> Byte<br><span class="hljs-symbol">1 </span><span class="hljs-keyword">int</span> = <span class="hljs-number">4</span> Byte<br><span class="hljs-symbol">1 </span>double = <span class="hljs-number">1</span> long long = <span class="hljs-number">8</span> Byte<br></code></pre></td></tr></table></figure><p>那么，$64MB$ 可使用$int$空间$ = \frac{64MB}{4Byte}  = 16MB \approx 16\ 000\ 000 Byte$（可以开$16\ 000\ 000$个$int$）</p><h3 id="动态分析方法"><a href="#动态分析方法" class="headerlink" title="动态分析方法"></a>动态分析方法</h3><p><code>cout &lt;&lt; (sizeof v + sizeof w + sizeof f) / 1024 / 1024 &lt;&lt; &quot;MB&quot; &lt;&lt; endl;</code></p><p>（<code>sizeof</code>返回<code>size_t</code>，单位为<code>Byte</code>）</p><p><strong>注意：</strong></p><p>因为操作系统使用虚拟内存技术，所以<strong>声明但未使用的空间不会被页面置换进内存</strong>，只有当被使用后才会占用内存。</p><p>$eg.$ Acwing 2. 01背包问题</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">10000010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> v[N], w[N];<br><span class="hljs-keyword">int</span> f[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-comment">// memset(v, 0, sizeof v);</span><br>    <span class="hljs-comment">// memset(w, 0, sizeof w);</span><br>    <span class="hljs-comment">// memset(f, 0, sizeof f);</span><br>    <br>    cout &lt;&lt; (<span class="hljs-keyword">sizeof</span> v + <span class="hljs-keyword">sizeof</span> w + <span class="hljs-keyword">sizeof</span> f) / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span> &lt;&lt; <span class="hljs-string">&quot;MB&quot;</span> &lt;&lt; endl;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>memset</code>代码段存在的话便会MLE，不存在的话即使其输出的$114MB &gt; 64MB$也不会MLE。</p><h3 id="递归算法"><a href="#递归算法" class="headerlink" title="递归算法"></a>递归算法</h3><p>递归算法递归多少层（多深）压多少栈空间</p><p>$eg.$ AcWing 785. 快速排序</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> q[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">quick_sort</span><span class="hljs-params">(<span class="hljs-keyword">int</span> q[], <span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (l &gt;= r) <span class="hljs-keyword">return</span> ;<br>    <br><span class="hljs-keyword">int</span> x = q[l + r &gt;&gt; <span class="hljs-number">1</span>], i = l - <span class="hljs-number">1</span>, j = r + <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (i &lt; j)<br>    &#123;<br>        <span class="hljs-keyword">do</span> i ++ ; <span class="hljs-keyword">while</span> (q[i] &lt; x);<br>        <span class="hljs-keyword">do</span> j -- ; <span class="hljs-keyword">while</span> (q[j] &gt; x);<br>        <span class="hljs-keyword">if</span> (i &lt; j) <span class="hljs-built_in">swap</span>(q[i], q[j]);<br>    &#125;<br>    <span class="hljs-built_in">quick_sort</span>(q, l, j);<br>    <span class="hljs-built_in">quick_sort</span>(q, j + <span class="hljs-number">1</span>, r);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;q[i]);<br>    <br>    <span class="hljs-built_in">quick_sort</span>(q, <span class="hljs-number">0</span>, n - <span class="hljs-number">1</span>);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, q[i]);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>快速排序每层的时间复杂度为 $O(n)$，深度为 $log_2n$，故其时间复杂度为 $O(nlogn)$</p><p>Q：为什么只看深度不看递归的次数？</p><p>A：因为快速排序的递归树是一棵二叉树，快速排序过程类似于对其进行DFS，只有从根节点到当前遍历点那<strong>一条路径</strong>上的状态被压在栈空间中，离开当前状态后栈空间就被标记为回收了。</p><h1 id="第一讲-基础算法"><a href="#第一讲-基础算法" class="headerlink" title="第一讲 基础算法"></a>第一讲 基础算法</h1><h2 id="AcWing-785-快速排序"><a href="#AcWing-785-快速排序" class="headerlink" title="AcWing 785. 快速排序"></a>AcWing 785. 快速排序</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N=<span class="hljs-number">1e5</span>+<span class="hljs-number">10</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> q[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">quickSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span> q[],<span class="hljs-keyword">int</span> l,<span class="hljs-keyword">int</span> r)</span></span>&#123;<br>    <span class="hljs-keyword">if</span> (l&gt;=r) <span class="hljs-keyword">return</span> ;<br><br>    <span class="hljs-keyword">int</span> x=q[(l+r)&gt;&gt;<span class="hljs-number">1</span>],i=l<span class="hljs-number">-1</span>,j=r+<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (i&lt;j)&#123;<br>        <span class="hljs-keyword">while</span> (q[++i]&lt;x);<br>        <span class="hljs-keyword">while</span> (q[--j]&gt;x);<br>        <span class="hljs-keyword">if</span>(i&lt;j) <span class="hljs-built_in">swap</span>(q[i],q[j]);<br>    &#125;<br>    <span class="hljs-built_in">quickSort</span>(q,l,j);<br>    <span class="hljs-built_in">quickSort</span>(q,j+<span class="hljs-number">1</span>,r);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;n);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;q[i]);<br><br>    <span class="hljs-built_in">quickSort</span>(q,<span class="hljs-number">0</span>,n<span class="hljs-number">-1</span>);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,q[i]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-786-第k个数"><a href="#AcWing-786-第k个数" class="headerlink" title="AcWing 786. 第k个数"></a>AcWing 786. 第k个数</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N=<span class="hljs-number">100005</span>;<br><br><span class="hljs-keyword">int</span> n,k;<br><span class="hljs-keyword">int</span> q[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">quick_sort</span><span class="hljs-params">(<span class="hljs-keyword">int</span> q[],<span class="hljs-keyword">int</span> l,<span class="hljs-keyword">int</span> r)</span></span>&#123;<br>    <span class="hljs-keyword">if</span> (l&gt;=r) <span class="hljs-keyword">return</span> ;<br><br>    <span class="hljs-keyword">int</span> x=q[l+r&gt;&gt;<span class="hljs-number">1</span>],i=l<span class="hljs-number">-1</span>,j=r+<span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">while</span>(i&lt;j)&#123;<br>        <span class="hljs-keyword">do</span> i++; <span class="hljs-keyword">while</span> (q[i]&lt;x);<br>        <span class="hljs-keyword">do</span> j--; <span class="hljs-keyword">while</span> (q[j]&gt;x);<br>        <span class="hljs-keyword">if</span>(i&lt;j) <span class="hljs-built_in">swap</span>(q[i],q[j]);<br>    &#125;<br>    <span class="hljs-built_in">quick_sort</span>(q,l,j);<br>    <span class="hljs-built_in">quick_sort</span>(q,j+<span class="hljs-number">1</span>,r);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;n,&amp;k);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;q[i]);<br><br>    <span class="hljs-built_in">quick_sort</span>(q,<span class="hljs-number">0</span>,n<span class="hljs-number">-1</span>);<br><br>    <span class="hljs-comment">// for (int i=0;i&lt;n;i++) printf(&quot;%d &quot;,q[i]);</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>,q[k<span class="hljs-number">-1</span>]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-787-归并排序"><a href="#AcWing-787-归并排序" class="headerlink" title="AcWing 787. 归并排序"></a>AcWing 787. 归并排序</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N=<span class="hljs-number">100005</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> q[N],tmp[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">merge_sort</span><span class="hljs-params">(<span class="hljs-keyword">int</span> q[],<span class="hljs-keyword">int</span> l,<span class="hljs-keyword">int</span> r)</span></span>&#123;<br>    <span class="hljs-keyword">if</span> (l&gt;=r) <span class="hljs-keyword">return</span> ;<br><br>    <span class="hljs-keyword">int</span> mid=l+r&gt;&gt;<span class="hljs-number">1</span>;<br>    <span class="hljs-built_in">merge_sort</span>(q,l,mid);<br>    <span class="hljs-built_in">merge_sort</span>(q,mid+<span class="hljs-number">1</span>,r);<br><br>    <span class="hljs-keyword">int</span> k=<span class="hljs-number">0</span>,i=l,j=mid+<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (i&lt;=mid &amp;&amp; j&lt;=r)<br>        <span class="hljs-keyword">if</span>(q[i]&lt;q[j]) tmp[k++]=q[i++];<br>        <span class="hljs-keyword">else</span> tmp[k++]=q[j++];<br>    <span class="hljs-keyword">while</span> (i&lt;=mid) tmp[k++]=q[i++];<br>    <span class="hljs-keyword">while</span> (j&lt;=r) tmp[k++]=q[j++];<br><br>    <span class="hljs-keyword">for</span> (i=l,k=<span class="hljs-number">0</span>;i&lt;=r;i++,k++) q[i]=tmp[k];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;q[i]);<br><br>    <span class="hljs-built_in">merge_sort</span>(q,<span class="hljs-number">0</span>,n<span class="hljs-number">-1</span>);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,q[i]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-788-逆序对的数量"><a href="#AcWing-788-逆序对的数量" class="headerlink" title="AcWing 788. 逆序对的数量"></a>AcWing 788. 逆序对的数量</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> ll=<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N=<span class="hljs-number">100005</span>;<br><br><span class="hljs-keyword">int</span> n;<br>ll rst;<br><span class="hljs-keyword">int</span> q[N],tmp[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">merge_sort</span><span class="hljs-params">(<span class="hljs-keyword">int</span> q[],<span class="hljs-keyword">int</span> l,<span class="hljs-keyword">int</span> r)</span></span>&#123;<br>    <span class="hljs-keyword">if</span> (l&gt;=r) <span class="hljs-keyword">return</span> ;<br><br>    <span class="hljs-keyword">int</span> mid=l+r&gt;&gt;<span class="hljs-number">1</span>;<br>    <span class="hljs-built_in">merge_sort</span>(q,l,mid);<br>    <span class="hljs-built_in">merge_sort</span>(q,mid+<span class="hljs-number">1</span>,r);<br><br>    <span class="hljs-keyword">int</span> k=<span class="hljs-number">0</span>,i=l,j=mid+<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (i&lt;=mid &amp;&amp; j&lt;=r)<br>        <span class="hljs-keyword">if</span> (q[i]&lt;=q[j]) tmp[k++]=q[i++];<br>        <span class="hljs-keyword">else</span>&#123;<br>            tmp[k++]=q[j++];<br>            rst+=(mid-i+<span class="hljs-number">1</span>);<br>        &#125;<br>    <span class="hljs-keyword">while</span> (i&lt;=mid) tmp[k++]=q[i++];<br>    <span class="hljs-keyword">while</span> (j&lt;=r) tmp[k++]=q[j++];<br><br>    <span class="hljs-keyword">for</span> (i=l,k=<span class="hljs-number">0</span>;i&lt;=r;i++,k++) q[i]=tmp[k];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;n);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;q[i]);<br><br>    <span class="hljs-built_in">merge_sort</span>(q,<span class="hljs-number">0</span>,n<span class="hljs-number">-1</span>);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld&quot;</span>,rst);<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>注意有一组数据的rst超过了int范围的上界，需要更大的空间。</strong></p><h2 id="AcWing-789-数的范围"><a href="#AcWing-789-数的范围" class="headerlink" title="AcWing 789. 数的范围"></a>AcWing 789. 数的范围</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100005</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> q[N];<br><br><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;q[i]);<br><br>    <span class="hljs-keyword">while</span> (m --)&#123;<br>        <span class="hljs-keyword">int</span> x;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;x);<br><br>        <span class="hljs-keyword">int</span> l = <span class="hljs-number">0</span>,r = n<span class="hljs-number">-1</span>;<br>        <span class="hljs-keyword">while</span> (l &lt; r)&#123;<br>            <span class="hljs-keyword">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">if</span> (q[mid] &gt;= x) r = mid;<br>            <span class="hljs-keyword">else</span> l = mid + <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (q[l] != x)<br>            cout &lt;&lt; <span class="hljs-string">&quot;-1 -1&quot;</span> &lt;&lt; endl;<br>        <span class="hljs-keyword">else</span>&#123;<br>            cout &lt;&lt; l &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span>;<br><br>            <span class="hljs-keyword">int</span> l = <span class="hljs-number">0</span>, r = n - <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">while</span> (l &lt; r)&#123;<br>                <span class="hljs-keyword">int</span> mid = l + r + <span class="hljs-number">1</span> &gt;&gt; <span class="hljs-number">1</span>;<br>                <span class="hljs-keyword">if</span> (q[mid] &lt;= x) l = mid;<br>                <span class="hljs-keyword">else</span> r = mid - <span class="hljs-number">1</span>;<br>            &#125;<br><br>            cout &lt;&lt; l &lt;&lt; endl;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>二分形式上就是一个给定范围的while循环</strong></p><h2 id="AcWing-790-数的三次方根"><a href="#AcWing-790-数的三次方根" class="headerlink" title="AcWing 790. 数的三次方根"></a>AcWing 790. 数的三次方根</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">double</span> eps = <span class="hljs-number">1e-8</span>;  <span class="hljs-comment">// 6+2</span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">double</span> x;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lf&quot;</span>, &amp;x);<br>    <span class="hljs-keyword">bool</span> sgn = (x &gt;= <span class="hljs-number">0</span> ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>);<br>    <span class="hljs-comment">// char sgn = (x &lt; 0 ? &#x27;-&#x27; : &#x27;&#x27;);  // error</span><br>    x=<span class="hljs-built_in">abs</span>(x);<br>    <span class="hljs-keyword">double</span> l = <span class="hljs-number">0</span>, r = (x &gt; <span class="hljs-number">1</span> ? x : <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">while</span> (r - l &gt; eps)&#123;<br>        <span class="hljs-keyword">double</span> mid = (l + r) / <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">if</span> (mid * mid * mid &gt;= x) r=mid;<br>        <span class="hljs-keyword">else</span> l=mid;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (!sgn) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;-&quot;</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lf&quot;</span>, l);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-791-高精度加法"><a href="#AcWing-791-高精度加法" class="headerlink" title="AcWing 791. 高精度加法"></a>AcWing 791. 高精度加法</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br>#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100005</span>;<br><br><span class="hljs-function">vector&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">add</span><span class="hljs-params">(vector&lt;<span class="hljs-keyword">int</span>&gt; &amp;A, vector&lt;<span class="hljs-keyword">int</span>&gt; &amp;B)</span></span>&#123;<br>    vector&lt;<span class="hljs-keyword">int</span>&gt; C;<br><br>    <span class="hljs-keyword">int</span> t = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; A.<span class="hljs-built_in">size</span>() || i &lt; B.<span class="hljs-built_in">size</span>(); i++)&#123;<br>        <span class="hljs-keyword">if</span> (i &lt;= A.<span class="hljs-built_in">size</span>()) t += A[i];<br>        <span class="hljs-keyword">if</span> (i &lt;= B.<span class="hljs-built_in">size</span>()) t += B[i];<br>        C.<span class="hljs-built_in">push_back</span>(t % <span class="hljs-number">10</span>);<br>        t /= <span class="hljs-number">10</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (t) C.<span class="hljs-built_in">push_back</span>(t);<br>    <span class="hljs-keyword">return</span> C;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    string a, b;<br>    cin &gt;&gt; a &gt;&gt; b;<br><br>    vector&lt;<span class="hljs-keyword">int</span>&gt; A, B;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = a.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i --) A.<span class="hljs-built_in">push_back</span>(a[i] - <span class="hljs-string">&#x27;0&#x27;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = b.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i --) B.<span class="hljs-built_in">push_back</span>(b[i] - <span class="hljs-string">&#x27;0&#x27;</span>);<br><br>    <span class="hljs-keyword">auto</span> C = <span class="hljs-built_in">add</span>(A, B);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = C.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i --) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, C[i]);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-792-高精度减法"><a href="#AcWing-792-高精度减法" class="headerlink" title="AcWing 792. 高精度减法"></a>AcWing 792. 高精度减法</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br>#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>;<br><br><span class="hljs-comment">// A &gt;= B</span><br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(vector&lt;<span class="hljs-keyword">int</span>&gt; &amp;A, vector&lt;<span class="hljs-keyword">int</span>&gt; &amp;B)</span></span>&#123;<br>    <span class="hljs-keyword">if</span> (A.<span class="hljs-built_in">size</span>() != B.<span class="hljs-built_in">size</span>()) <span class="hljs-keyword">return</span> A.<span class="hljs-built_in">size</span>() &gt; B.<span class="hljs-built_in">size</span>();<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = A.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i --)<br>        <span class="hljs-keyword">if</span> (A[i] != B[i])<br>            <span class="hljs-keyword">return</span> A[i] &gt; B[i];<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-function">vector&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">sub</span><span class="hljs-params">(vector&lt;<span class="hljs-keyword">int</span>&gt; &amp;A, vector&lt;<span class="hljs-keyword">int</span>&gt; &amp;B)</span></span>&#123;<br>    vector&lt;<span class="hljs-keyword">int</span>&gt; C;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, t = <span class="hljs-number">0</span>; i &lt; A.<span class="hljs-built_in">size</span>(); i++)&#123;<br>        <span class="hljs-keyword">int</span> tmp = A[i] - t;<br>        <span class="hljs-keyword">if</span> (i &lt; B.<span class="hljs-built_in">size</span>()) tmp -= B[i];<br>        C.<span class="hljs-built_in">push_back</span>((tmp + <span class="hljs-number">10</span>) % <span class="hljs-number">10</span>);<br>        t = tmp &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">while</span> (C.<span class="hljs-built_in">back</span>() == <span class="hljs-number">0</span> &amp;&amp; C.<span class="hljs-built_in">size</span>() &gt; <span class="hljs-number">1</span>) C.<span class="hljs-built_in">pop_back</span>();<br>    <span class="hljs-keyword">return</span> C;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    string a, b;<br>    cin &gt;&gt; a &gt;&gt; b;<br><br>    vector&lt;<span class="hljs-keyword">int</span>&gt; A, B;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = a.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i --) A.<span class="hljs-built_in">push_back</span>(a[i] - <span class="hljs-string">&#x27;0&#x27;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = b.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i --) B.<span class="hljs-built_in">push_back</span>(b[i] - <span class="hljs-string">&#x27;0&#x27;</span>);<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">cmp</span>(A, B))&#123;<br>        <span class="hljs-keyword">auto</span> C = <span class="hljs-built_in">sub</span>(A, B);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = C.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i --) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, C[i]);<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">auto</span> C = <span class="hljs-built_in">sub</span>(B, A);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;-&quot;</span>);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = C.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i --) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, C[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-793-高精度乘法"><a href="#AcWing-793-高精度乘法" class="headerlink" title="AcWing 793. 高精度乘法"></a>AcWing 793. 高精度乘法</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br>#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function">vector&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">mul</span><span class="hljs-params">(vector&lt;<span class="hljs-keyword">int</span>&gt; &amp;A, <span class="hljs-keyword">int</span> b)</span></span>&#123;<br>    vector&lt;<span class="hljs-keyword">int</span>&gt; C;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, t = <span class="hljs-number">0</span>; i &lt; A.<span class="hljs-built_in">size</span>() || t; i ++)&#123;<br>        <span class="hljs-keyword">if</span> (i &lt; A.<span class="hljs-built_in">size</span>()) t += A[i] * b;<br>        C.<span class="hljs-built_in">push_back</span>(t % <span class="hljs-number">10</span>);<br>        t /= <span class="hljs-number">10</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">while</span> (C.<span class="hljs-built_in">back</span>() == <span class="hljs-number">0</span> &amp;&amp; C.<span class="hljs-built_in">size</span>() &gt; <span class="hljs-number">1</span>) C.<span class="hljs-built_in">pop_back</span>();  <span class="hljs-comment">// 12345 * 0</span><br><br>    <span class="hljs-keyword">return</span> C;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    string a;<br>    <span class="hljs-keyword">int</span> b;<br>    cin &gt;&gt; a &gt;&gt; b;<br><br>    vector&lt;<span class="hljs-keyword">int</span>&gt; A;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = a.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;=<span class="hljs-number">0</span> ; i --) A.<span class="hljs-built_in">push_back</span>(a[i] - <span class="hljs-string">&#x27;0&#x27;</span>);<br><br>    vector&lt;<span class="hljs-keyword">int</span>&gt; C = <span class="hljs-built_in">mul</span>(A, b);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = C.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i --) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, C[i]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-794-高精度除法"><a href="#AcWing-794-高精度除法" class="headerlink" title="AcWing 794. 高精度除法"></a>AcWing 794. 高精度除法</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br>#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><br>#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function">vector&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">div</span><span class="hljs-params">(vector&lt;<span class="hljs-keyword">int</span>&gt; &amp;A, <span class="hljs-keyword">int</span> b, <span class="hljs-keyword">int</span> &amp;r)</span></span>&#123;<br>    vector&lt;<span class="hljs-keyword">int</span>&gt; C;<br><br>    r = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = A.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i --)&#123;<br>    <span class="hljs-comment">// for (int i = A.size() - 1, r = 0; i &gt;= 0; i --)&#123;  // ERROR</span><br>        r = r * <span class="hljs-number">10</span> + A[i];<br>        C.<span class="hljs-built_in">push_back</span>(r / b);<br>        r %= b;<br>    &#125;<br><br>    <span class="hljs-built_in">reverse</span>(C.<span class="hljs-built_in">begin</span>(), C.<span class="hljs-built_in">end</span>());<br>    <span class="hljs-keyword">while</span> (C.<span class="hljs-built_in">back</span>() == <span class="hljs-number">0</span> &amp;&amp; C.<span class="hljs-built_in">size</span>() &gt; <span class="hljs-number">1</span>) C.<span class="hljs-built_in">pop_back</span>();<br>    <span class="hljs-keyword">return</span> C;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    string a;<br>    <span class="hljs-keyword">int</span> b;<br>    cin &gt;&gt; a &gt;&gt; b;<br><br>    vector&lt;<span class="hljs-keyword">int</span>&gt; A;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = a.<span class="hljs-built_in">size</span>() <span class="hljs-number">-1</span>; i &gt;=<span class="hljs-number">0</span>; i --) A.<span class="hljs-built_in">push_back</span>(a[i] - <span class="hljs-string">&#x27;0&#x27;</span>);<br><br>    <span class="hljs-keyword">int</span> r;<br>    <span class="hljs-keyword">auto</span> C = <span class="hljs-built_in">div</span>(A, b, r);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = C.<span class="hljs-built_in">size</span>() <span class="hljs-number">-1</span>; i&gt;= <span class="hljs-number">0</span>; i--) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, C[i]);<br>    cout &lt;&lt; endl &lt;&lt; r &lt;&lt; endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-795-前缀和"><a href="#AcWing-795-前缀和" class="headerlink" title="AcWing 795. 前缀和"></a>AcWing 795. 前缀和</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> a[N], s[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i]);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++) s[i] = s[i - <span class="hljs-number">1</span>] + a[i];<br><br>    <span class="hljs-keyword">while</span> (m --)&#123;<br>        <span class="hljs-keyword">int</span> l, r;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, s[r] - s[l - <span class="hljs-number">1</span>]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-796-子矩阵的和"><a href="#AcWing-796-子矩阵的和" class="headerlink" title="AcWing 796. 子矩阵的和"></a>AcWing 796. 子矩阵的和</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;<br><br><span class="hljs-keyword">int</span> n, m, q;<br><span class="hljs-keyword">int</span> a[N][N], s[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;q);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++)<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++)<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i][j]);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++)<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++)<br>            s[i][j] = a[i][j] + s[i - <span class="hljs-number">1</span>][j] + s[i][j - <span class="hljs-number">1</span>] - s[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>];<br><br>    <span class="hljs-keyword">while</span> (q --)&#123;<br>        <span class="hljs-keyword">int</span> x1, y1, x2, y2;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d%d&quot;</span>, &amp;x1, &amp;y1, &amp;x2, &amp;y2);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, s[x2][y2] - s[x1 - <span class="hljs-number">1</span>][y2] - s[x2][y1 - <span class="hljs-number">1</span>] + s[x1 - <span class="hljs-number">1</span>][y1 - <span class="hljs-number">1</span>]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-797-差分"><a href="#AcWing-797-差分" class="headerlink" title="AcWing 797. 差分"></a>AcWing 797. 差分</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> a[N], b[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r, <span class="hljs-keyword">int</span> c)</span></span>&#123;<br>    b[l] += c;<br>    b[r + <span class="hljs-number">1</span>] -= c;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i]);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++) <span class="hljs-built_in">insert</span>(i, i, a[i]);<br><br>    <span class="hljs-keyword">while</span> (m --)&#123;<br>        <span class="hljs-keyword">int</span> l, r, c;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;l, &amp;r, &amp;c);<br>        <span class="hljs-built_in">insert</span>(l, r, c);<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++) b[i] += b[i - <span class="hljs-number">1</span>];<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, b[i]);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-798-差分矩阵"><a href="#AcWing-798-差分矩阵" class="headerlink" title="AcWing 798. 差分矩阵"></a>AcWing 798. 差分矩阵</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;<br><br><span class="hljs-keyword">int</span> n, m, q;<br><span class="hljs-keyword">int</span> a[N][N], b[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x1, <span class="hljs-keyword">int</span> y1, <span class="hljs-keyword">int</span> x2, <span class="hljs-keyword">int</span> y2, <span class="hljs-keyword">int</span> c)</span></span>&#123;<br>    b[x1][y1] += c;<br>    b[x2 + <span class="hljs-number">1</span>][y1] -= c;<br>    b[x1][y2 + <span class="hljs-number">1</span>] -= c;<br>    b[x2 + <span class="hljs-number">1</span>][y2 + <span class="hljs-number">1</span>] += c;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;q);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++ )<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i][j]);<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++ )<br>            <span class="hljs-built_in">insert</span>(i, j, i, j, a[i][j]);<br><br>    <span class="hljs-keyword">while</span> (q --)&#123;<br>        <span class="hljs-keyword">int</span> x1, y1, x2, y2, c;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d%d%d&quot;</span>, &amp;x1, &amp;y1, &amp;x2, &amp;y2, &amp;c);<br>        <span class="hljs-built_in">insert</span>(x1, y1, x2, y2, c);<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++ )<br>            b[i][j] += b[i - <span class="hljs-number">1</span>][j] + b[i][j - <span class="hljs-number">1</span>] - b[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>];<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, b[i][j]);<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-799-最长连续不重复子序列"><a href="#AcWing-799-最长连续不重复子序列" class="headerlink" title="AcWing 799. 最长连续不重复子序列"></a>AcWing 799. 最长连续不重复子序列</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> a[N], s[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) cin &gt;&gt; a[i];<br><br>    <span class="hljs-keyword">int</span> res;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123;<br>        s[a[i]] ++ ;<br>        <span class="hljs-keyword">while</span> (s[a[i]] &gt; <span class="hljs-number">1</span>)&#123;  <span class="hljs-comment">// s[a[j ++ ]] -- ;</span><br>            s[a[j]] -- ;<br>            j ++ ;<br>        &#125;<br>    res = <span class="hljs-built_in">max</span>(res, i - j + <span class="hljs-number">1</span>);<br>    &#125;<br><br>    cout &lt;&lt; res &lt;&lt; endl;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-800-数组元素的目标和"><a href="#AcWing-800-数组元素的目标和" class="headerlink" title="AcWing 800. 数组元素的目标和"></a>AcWing 800. 数组元素的目标和</h2><p>扔了拐棍还写得很顺，很开心<br>思路就是想办法构造出“单调”的情况，不然就变成暴力解O(n^2)了<br>最开始是想把两个指针放在一侧，但是可能会出现i前进，j后退也能满足解的情况，然后我就把其中一个指针放到了另一侧<br>以i右侧起，j左侧起为例，这样的话有三种情况：</p><ol><li>若<code>a[i] + b[j] &lt; x</code>，因a有序，则<code>a[i - 1] + b[j] &lt; x</code>必成立，这种情况只能让j + 1（向右），尝试从下侧接近x；</li><li>若<code>a[i] + b[j] &gt; x</code>，因b有序，则<code>a[i] + b[j + 1] &gt; x</code>必成立，这种情况只能让i - 1（向左），尝试从上侧接近x；</li><li>若<code>a[i] + b[j + 1] == x</code>，则找到结果。 </li></ol><p>因为双指针是for + while结构，那么取i为for中的循环变量，j为while中的循环变量即可。<br>用if捕获情况3，出现情况1时while对j进行右移，二者作用结束后剩下情况2，由for对i进行左移。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n, m, x;<br><span class="hljs-keyword">int</span> a[N], b[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;x);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i]);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;b[i]);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n <span class="hljs-number">-1</span> , j = <span class="hljs-number">0</span>; i &gt;= <span class="hljs-number">0</span>; i -- )&#123;<br>        <span class="hljs-keyword">while</span> (a[i] + b[j] &lt; x) j ++ ;<br>        <span class="hljs-keyword">if</span> (a[i] + b[j] == x)&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, i, j);<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-801-二进制中1的个数"><a href="#AcWing-801-二进制中1的个数" class="headerlink" title="AcWing 801. 二进制中1的个数"></a>AcWing 801. 二进制中1的个数</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">int</span> n;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">lowbit</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>&#123;<br>    <span class="hljs-keyword">return</span> x &amp; -x;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <span class="hljs-keyword">while</span> (n -- )&#123;<br>        <span class="hljs-keyword">int</span> x, cnt = <span class="hljs-number">0</span>;<br>        cin &gt;&gt; x;<br><br>        <span class="hljs-comment">// while (x &gt; 0) x -= lowbit(x), cnt ++ ;</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = x; i; i -= <span class="hljs-built_in">lowbit</span>(i)) cnt ++ ;<br><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, cnt);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-2816-判断子序列"><a href="#AcWing-2816-判断子序列" class="headerlink" title="AcWing 2816. 判断子序列"></a>AcWing 2816. 判断子序列</h2><p>强套y总for + while板子写的，写完后发现while的<code>j ++</code>和外层for的<code>j ++</code>重复了，其实可以只用一个循环（y总wp）<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> a[N], b[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i]);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; j ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;b[j]);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>; i &lt;= n; i ++ , j ++ )&#123;  <span class="hljs-comment">// 每次找到一对匹配的元素，然后再往后找</span><br>        <span class="hljs-keyword">if</span> (i == n)&#123;  <span class="hljs-comment">// 遍历b前，若发现a遍历完了，则说明a是b的子序列</span><br>            <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Yes&quot;</span>);<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">while</span> (j &lt; m &amp;&amp; a[i] != b[j]) j ++ ;  <span class="hljs-comment">// 单调遍历b中元素直到和a中某元素配对</span><br>        <span class="hljs-keyword">if</span> (j == m)&#123;  <span class="hljs-comment">// 遍历b后，若发现b遍历完了，则说明a不是b的子序列</span><br>            <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;No&quot;</span>);<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><p>附y总代码，可见逻辑一样<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br>#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> a[N], b[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i]);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;b[i]);<br><br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (i &lt; n &amp;&amp; j &lt; m)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (a[i] == b[j]) i ++ ;  <span class="hljs-comment">// 找到一对匹配的元素，然后再往后找</span><br>        j ++ ;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (i == n) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Yes&quot;</span>);  <span class="hljs-comment">// 若发现a遍历完了，则说明a是b的子序列</span><br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;No&quot;</span>);  <span class="hljs-comment">// 若发现b遍历完了，则说明a不是b的子序列</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-802-区间和"><a href="#AcWing-802-区间和" class="headerlink" title="AcWing 802. 区间和"></a>AcWing 802. 区间和</h2><p>CSP曾有一道稀疏向量的题。原理就是离散化。<br>直观上讲，就是将原数组进行“下标按序压缩”<br>为了防止压缩后的下标里没有查询的边界，把查询的边界也加进去。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br>#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><br>#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> PII = pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt;;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">300010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> a[N], s[N];<br><br>vector&lt;<span class="hljs-keyword">int</span>&gt; all_index;<br>vector&lt;PII&gt; add, query;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> l = <span class="hljs-number">0</span>, r = all_index.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (l &lt; r)&#123;<br>        <span class="hljs-keyword">int</span> mid = l + r &gt;&gt; <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span> (all_index[mid] &gt;= x) r = mid;<br>        <span class="hljs-keyword">else</span> l = mid + <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> r + <span class="hljs-number">1</span>;<br>&#125;<br><br>vector&lt;<span class="hljs-keyword">int</span>&gt;::<span class="hljs-function">iterator <span class="hljs-title">my_unique</span><span class="hljs-params">(vector&lt;<span class="hljs-keyword">int</span>&gt; &amp;a)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; a.<span class="hljs-built_in">size</span>(); i ++ )<br>        <span class="hljs-keyword">if</span> (!i || a[i] != a[i - <span class="hljs-number">1</span>])  <span class="hljs-comment">// 遍历至 首个元素 或 与前一个元素不同 的元素（选出每个相同段的第一个元素）</span><br>            a[j ++ ] = a[i];<br>    <br>    <span class="hljs-keyword">return</span> a.<span class="hljs-built_in">begin</span>() + j;<br>&#125; <br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123;<br>        <span class="hljs-keyword">int</span> x, c;<br>        cin &gt;&gt; x &gt;&gt; c;<br>        add.<span class="hljs-built_in">push_back</span>(&#123;x, c&#125;);<br>        <br>        all_index.<span class="hljs-built_in">push_back</span>(x);<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ )&#123;<br>        <span class="hljs-keyword">int</span> l, r;<br>        cin &gt;&gt; l &gt;&gt; r;<br>        query.<span class="hljs-built_in">push_back</span>(&#123;l, r&#125;);<br>        <br>        all_index.<span class="hljs-built_in">push_back</span>(l);<br>        all_index.<span class="hljs-built_in">push_back</span>(r);<br>    &#125;<br>    <br>    <span class="hljs-built_in">sort</span>(all_index.<span class="hljs-built_in">begin</span>(), all_index.<span class="hljs-built_in">end</span>());<br>    all_index.<span class="hljs-built_in">erase</span>(<span class="hljs-built_in">my_unique</span>(all_index), all_index.<span class="hljs-built_in">end</span>());<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> item : add)&#123;<br>        <span class="hljs-keyword">int</span> x = <span class="hljs-built_in">find</span>(item.first);<br>        a[x] += item.second;<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= all_index.<span class="hljs-built_in">size</span>(); i ++ ) s[i] += s[i - <span class="hljs-number">1</span>] + a[i];<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> item : query)&#123;<br>        <span class="hljs-keyword">int</span> l = <span class="hljs-built_in">find</span>(item.first), r = <span class="hljs-built_in">find</span>(item.second);<br>        cout &lt;&lt; s[r] - s[l - <span class="hljs-number">1</span>] &lt;&lt; endl;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-803-区间合并"><a href="#AcWing-803-区间合并" class="headerlink" title="AcWing 803. 区间合并"></a>AcWing 803. 区间合并</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs cpp">#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br>#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><br>#<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> PII = pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt;;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> INF = <span class="hljs-number">2e9</span>;<br><br><span class="hljs-keyword">int</span> n;<br>vector&lt;PII&gt; segs;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">merge</span><span class="hljs-params">(vector&lt;PII&gt; &amp;segs)</span></span>&#123;<br>    vector&lt;PII&gt; res;<br><br>    <span class="hljs-keyword">int</span> st = -INF, ed = -INF;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> seg : segs)&#123;<br>        <span class="hljs-keyword">if</span> (ed &lt; seg.first)&#123;<br>            <span class="hljs-keyword">if</span> (st != -INF) res.<span class="hljs-built_in">push_back</span>(&#123;st, ed&#125;);  <span class="hljs-comment">// 若淘汰下来的区间不是初始区间则将其加入res</span><br>            st = seg.first, ed = seg.second;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>            ed = <span class="hljs-built_in">max</span>(ed, seg.second);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (st != -INF) res.<span class="hljs-built_in">push_back</span>(&#123;st, ed&#125;);<br><br>    segs = res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123;<br>        <span class="hljs-keyword">int</span> l, r;<br>        cin &gt;&gt; l &gt;&gt; r;<br>        segs.<span class="hljs-built_in">push_back</span>(&#123;l, r&#125;);<br>    &#125;<br><br>    <span class="hljs-built_in">sort</span>(segs.<span class="hljs-built_in">begin</span>(), segs.<span class="hljs-built_in">end</span>());<br><br>    <span class="hljs-built_in">merge</span>(segs);<br><br>    cout &lt;&lt; segs.<span class="hljs-built_in">size</span>() &lt;&lt; endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="第二讲-数据结构"><a href="#第二讲-数据结构" class="headerlink" title="第二讲 数据结构"></a>第二讲 数据结构</h1><h2 id="AcWing-826-单链表"><a href="#AcWing-826-单链表" class="headerlink" title="AcWing 826. 单链表"></a>AcWing 826. 单链表</h2><p>显式head<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> m;<br><span class="hljs-keyword">int</span> head, e[N], ne[N], idx;  <span class="hljs-comment">// head, elements, next elements, index</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span>&#123;<br>    head = <span class="hljs-number">-1</span>;<br>    idx = <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add_to_head</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>&#123;<br>    e[idx] = x, ne[idx] = head, head = idx ++ ;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span> x)</span></span>&#123;<br>    e[idx] = x, ne[idx] = ne[k], ne[k] = idx ++ ;  <span class="hljs-comment">// 尾结点指向的-1始终存在，因为不论添加、删除，对后继节点都应理解为已有指针的移动（转动）</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">remove</span><span class="hljs-params">(<span class="hljs-keyword">int</span> k)</span></span>&#123;<br>    <span class="hljs-keyword">if</span> (k == <span class="hljs-number">-1</span>) head = ne[head];  <span class="hljs-comment">// 这里k的-1代表头结点前面的head，ne[k]的-1才代表NULL</span><br>    <span class="hljs-keyword">else</span> ne[k] = ne[ne[k]];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; m;<br>    <br>    <span class="hljs-built_in">init</span>();<br>    <br>    <span class="hljs-keyword">while</span> (m -- )&#123;<br>        <span class="hljs-keyword">int</span> k, x;<br>        <span class="hljs-keyword">char</span> op;<br>        cin &gt;&gt; op;<br>        <span class="hljs-built_in"><span class="hljs-keyword">switch</span></span>(op)&#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;H&#x27;</span>:<br>                cin &gt;&gt; x;<br>                <span class="hljs-built_in">add_to_head</span>(x);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;D&#x27;</span>:<br>                cin &gt;&gt; k;<br>                <span class="hljs-built_in">remove</span>(k - <span class="hljs-number">1</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;I&#x27;</span>:<br>                cin &gt;&gt; k &gt;&gt; x;<br>                <span class="hljs-built_in">add</span>(k - <span class="hljs-number">1</span>, x);<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = head; i != <span class="hljs-number">-1</span>; i = ne[i]) cout &lt;&lt; e[i] &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span>;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br>隐式head，跟这道题莫名契合<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> m;<br><span class="hljs-keyword">int</span> e[N], ne[N], idx;  <span class="hljs-comment">//elements, next elements, index</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span>&#123;<br>    ne[<span class="hljs-number">0</span>] = <span class="hljs-number">-1</span>;  <span class="hljs-comment">// idx0作为head</span><br>    idx = <span class="hljs-number">1</span>;  <span class="hljs-comment">// 第1个插入的元素位于下标1处</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span> x)</span></span>&#123;<br>    e[idx] = x, ne[idx] = ne[k], ne[k] = idx ++ ;  <span class="hljs-comment">// 尾结点指向的-1始终存在，因为不论添加、删除，对后继节点都应理解为已有指针的移动（转动）</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">remove</span><span class="hljs-params">(<span class="hljs-keyword">int</span> k)</span></span>&#123;<br>    ne[k] = ne[ne[k]];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; m;<br>    <br>    <span class="hljs-built_in">init</span>();<br>    <br>    <span class="hljs-keyword">while</span> (m -- )&#123;<br>        <span class="hljs-keyword">int</span> k, x;<br>        <span class="hljs-keyword">char</span> op;<br>        cin &gt;&gt; op;<br>        <span class="hljs-built_in"><span class="hljs-keyword">switch</span></span>(op)&#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;H&#x27;</span>:<br>                cin &gt;&gt; x;<br>                <span class="hljs-built_in">insert</span>(<span class="hljs-number">0</span>, x);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;D&#x27;</span>:<br>                cin &gt;&gt; k;<br>                <span class="hljs-built_in">remove</span>(k);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;I&#x27;</span>:<br>                cin &gt;&gt; k &gt;&gt; x;<br>                <span class="hljs-built_in">insert</span>(k, x);<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = ne[<span class="hljs-number">0</span>]; i != <span class="hljs-number">-1</span>; i = ne[i]) cout &lt;&lt; e[i] &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span>;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-827-双链表"><a href="#AcWing-827-双链表" class="headerlink" title="AcWing 827. 双链表"></a>AcWing 827. 双链表</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> m;<br><span class="hljs-keyword">int</span> e[N], l[N], r[N], idx;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span>&#123;<br>    r[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>, l[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;  <span class="hljs-comment">// idx0作为head，idx1作为tail</span><br>    idx = <span class="hljs-number">2</span>;  <span class="hljs-comment">// 第1个数插入位置在下标2</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span> x)</span></span>&#123;<br>    e[idx] = x;<br>    r[idx] = r[k], l[idx] = k;<br>    l[r[k]] = idx, r[k] = idx ++;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">remove</span><span class="hljs-params">(<span class="hljs-keyword">int</span> k)</span></span>&#123;<br>    l[r[k]] = l[k], r[l[k]] = r[k];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; m;<br>    <br>    <span class="hljs-built_in">init</span>();  <span class="hljs-comment">// highlight!!</span><br>    <br>    <span class="hljs-keyword">while</span> (m -- )&#123;<br>        string op;<br>        cin &gt;&gt; op;<br>        <br>        <span class="hljs-keyword">int</span> k, x;<br>        <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;L&quot;</span>)&#123;<br>                cin &gt;&gt; x;<br>                <span class="hljs-built_in">insert</span>(<span class="hljs-number">0</span>, x);<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;R&quot;</span>)&#123;<br>                cin &gt;&gt; x;<br>                <span class="hljs-built_in">insert</span>(l[<span class="hljs-number">1</span>], x);  <span class="hljs-comment">// highlight!!</span><br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;D&quot;</span>)&#123;<br>                cin &gt;&gt; k;<br>                <span class="hljs-built_in">remove</span>(k + <span class="hljs-number">1</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;IL&quot;</span>)&#123;<br>                cin &gt;&gt; k &gt;&gt; x;<br>                <span class="hljs-built_in">insert</span>(l[k + <span class="hljs-number">1</span>], x);<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;IR&quot;</span>)&#123;<br>                cin &gt;&gt; k &gt;&gt; x;<br>                <span class="hljs-built_in">insert</span>(k + <span class="hljs-number">1</span>, x);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = r[<span class="hljs-number">0</span>]; i != <span class="hljs-number">1</span>; i = r[i]) cout&lt;&lt; e[i] &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span>;<br>    cout&lt;&lt;endl;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-828-模拟栈"><a href="#AcWing-828-模拟栈" class="headerlink" title="AcWing 828. 模拟栈"></a>AcWing 828. 模拟栈</h2><p>模拟<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> m;<br><br><span class="hljs-keyword">int</span> stk[N], sp;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">push</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>&#123;<br>    stk[ ++ sp] = x;  <span class="hljs-comment">// stk[0]不存，用来判空</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">pop</span><span class="hljs-params">()</span></span>&#123;<br>    sp -- ;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">empty</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">puts</span>(sp ? <span class="hljs-string">&quot;NO&quot;</span> : <span class="hljs-string">&quot;YES&quot;</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">top</span><span class="hljs-params">()</span></span>&#123;<br>    cout &lt;&lt; stk[sp] &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; m;<br>    <span class="hljs-keyword">while</span> (m -- )&#123;<br>        string op;<br>        cin &gt;&gt; op;<br>        <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;push&quot;</span>)&#123;<br>            <span class="hljs-keyword">int</span> x;<br>            cin &gt;&gt; x;<br>            <span class="hljs-built_in">push</span>(x);<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;pop&quot;</span>) <span class="hljs-built_in">pop</span>();<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;empty&quot;</span>) <span class="hljs-built_in">empty</span>();<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;query&quot;</span>) <span class="hljs-built_in">top</span>();<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br>STL<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stack&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> m;<br>stack&lt;<span class="hljs-keyword">int</span>&gt; s;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; m;<br>    <span class="hljs-keyword">while</span> (m -- )&#123;<br>        string op;<br>        cin &gt;&gt; op;<br>        <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;push&quot;</span>)&#123;<br>            <span class="hljs-keyword">int</span> x;<br>            cin &gt;&gt; x;<br>            s.<span class="hljs-built_in">push</span>(x);<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;pop&quot;</span>) s.<span class="hljs-built_in">pop</span>();<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;empty&quot;</span>) <span class="hljs-built_in">puts</span>(s.<span class="hljs-built_in">empty</span>() ? <span class="hljs-string">&quot;YES&quot;</span> : <span class="hljs-string">&quot;NO&quot;</span>);<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;query&quot;</span>) cout &lt;&lt; s.<span class="hljs-built_in">top</span>() &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-3302-表达式求值"><a href="#AcWing-3302-表达式求值" class="headerlink" title="AcWing 3302. 表达式求值"></a>AcWing 3302. 表达式求值</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stack&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unordered_map&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br>stack&lt;<span class="hljs-keyword">int</span>&gt; num;<br>stack&lt;<span class="hljs-keyword">char</span>&gt; op;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">eval</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">auto</span> b = num.<span class="hljs-built_in">top</span>(); num.<span class="hljs-built_in">pop</span>();<br>    <span class="hljs-keyword">auto</span> a = num.<span class="hljs-built_in">top</span>(); num.<span class="hljs-built_in">pop</span>();<br>    <span class="hljs-keyword">auto</span> c = op.<span class="hljs-built_in">top</span>(); op.<span class="hljs-built_in">pop</span>();<br>    <br>    <span class="hljs-keyword">int</span> x;<br>    <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;+&#x27;</span>) x = a + b;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;-&#x27;</span>) x = a - b;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;*&#x27;</span>) x = a * b;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;/&#x27;</span>) x = a / b;<br>    num.<span class="hljs-built_in">push</span>(x);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    unordered_map&lt;<span class="hljs-keyword">char</span>, <span class="hljs-keyword">int</span>&gt; pr&#123;&#123;<span class="hljs-string">&#x27;+&#x27;</span>, <span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-number">2</span>&#125;, &#123;<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-number">2</span>&#125;&#125;;<br>    string str;<br>    cin &gt;&gt; str;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; str.<span class="hljs-built_in">size</span>(); i ++ ) &#123;<br>        <span class="hljs-keyword">auto</span> ch = str[i];<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isdigit</span>(ch)) &#123;<br>            <span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>, j = i;<br>            <span class="hljs-keyword">while</span> (<span class="hljs-built_in">isdigit</span>(str[j]) &amp;&amp; j &lt; str.<span class="hljs-built_in">size</span>()) x = x * <span class="hljs-number">10</span> + str[j ++ ] - <span class="hljs-string">&#x27;0&#x27;</span>;<br>            i = j - <span class="hljs-number">1</span>;<br>            num.<span class="hljs-built_in">push</span>(x);<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">&#x27;(&#x27;</span>) op.<span class="hljs-built_in">push</span>(ch);<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">&#x27;)&#x27;</span>) &#123;<br>            <span class="hljs-keyword">while</span> (op.<span class="hljs-built_in">top</span>() != <span class="hljs-string">&#x27;(&#x27;</span>) <span class="hljs-built_in">eval</span>();<br>            op.<span class="hljs-built_in">pop</span>();<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// while (op.top() != &#x27;(&#x27; &amp;&amp; pr[op.top()] &gt;= pr[ch] &amp;&amp; op.size()) eval();  // ERROR</span><br>            <span class="hljs-keyword">while</span> (op.<span class="hljs-built_in">size</span>() &amp;&amp; op.<span class="hljs-built_in">top</span>() != <span class="hljs-string">&#x27;(&#x27;</span> &amp;&amp; pr[op.<span class="hljs-built_in">top</span>()] &gt;= pr[ch]) <span class="hljs-built_in">eval</span>();  <span class="hljs-comment">// 还“有”运算符（很关键!）,这个运算符不是左括号，然后它的优先级比我高，那就先把它的子树算完</span><br>            op.<span class="hljs-built_in">push</span>(ch);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">while</span> (op.<span class="hljs-built_in">size</span>()) <span class="hljs-built_in">eval</span>();<br>    <br>    cout &lt;&lt; num.<span class="hljs-built_in">top</span>() &lt;&lt; endl;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-829-模拟队列"><a href="#AcWing-829-模拟队列" class="headerlink" title="AcWing 829. 模拟队列"></a>AcWing 829. 模拟队列</h2><p>模拟<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> m;<br><span class="hljs-keyword">int</span> q[N], hh, tt = <span class="hljs-number">-1</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">push</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>&#123;<br>    q[ ++ tt] = x;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">pop</span><span class="hljs-params">()</span></span>&#123;<br>    hh ++ ;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">front</span><span class="hljs-params">()</span></span>&#123;<br>    cout &lt;&lt; q[hh] &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">empty</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">puts</span>( hh &gt; tt ? <span class="hljs-string">&quot;YES&quot;</span> :<span class="hljs-string">&quot;NO&quot;</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; m;<br>    <br>    <span class="hljs-keyword">while</span> (m -- )&#123;<br>        string op;<br>        cin &gt;&gt; op;<br>        <br>        <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;push&quot;</span>)&#123;<br>            <span class="hljs-keyword">int</span> x;<br>            cin &gt;&gt; x;<br>            <span class="hljs-built_in">push</span>(x);<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(op == <span class="hljs-string">&quot;pop&quot;</span>) <span class="hljs-built_in">pop</span>();<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(op == <span class="hljs-string">&quot;empty&quot;</span>) <span class="hljs-built_in">empty</span>();<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(op == <span class="hljs-string">&quot;query&quot;</span>) <span class="hljs-built_in">front</span>();<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br>STL<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> m;<br>queue&lt;<span class="hljs-keyword">int</span>&gt; q;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; m;<br>    <br>    <span class="hljs-keyword">while</span> (m -- )&#123;<br>        string op;<br>        cin &gt;&gt; op;<br>        <br>        <span class="hljs-keyword">if</span> (op == <span class="hljs-string">&quot;push&quot;</span>)&#123;<br>            <span class="hljs-keyword">int</span> x;<br>            cin &gt;&gt; x;<br>            q.<span class="hljs-built_in">push</span>(x);<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(op == <span class="hljs-string">&quot;pop&quot;</span>) q.<span class="hljs-built_in">pop</span>();<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(op == <span class="hljs-string">&quot;empty&quot;</span>) <span class="hljs-built_in">puts</span>(q.<span class="hljs-built_in">empty</span>() ? <span class="hljs-string">&quot;YES&quot;</span> : <span class="hljs-string">&quot;NO&quot;</span>);<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(op == <span class="hljs-string">&quot;query&quot;</span>) cout &lt;&lt; q.<span class="hljs-built_in">front</span>() &lt;&lt; endl;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-830-单调栈"><a href="#AcWing-830-单调栈" class="headerlink" title="AcWing 830. 单调栈"></a>AcWing 830. 单调栈</h2><p>模拟<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> stk[N], sp;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-number">0</span>), cin.<span class="hljs-built_in">tie</span>(<span class="hljs-number">0</span>), cout.<span class="hljs-built_in">tie</span>(<span class="hljs-number">0</span>);<br>    <br>    cin &gt;&gt; n;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123;<br>        <span class="hljs-keyword">int</span> x;<br>        cin &gt;&gt; x;<br>        <span class="hljs-keyword">while</span> (sp &amp;&amp; stk[sp] &gt;= x) sp -- ;<br>        <br>        <span class="hljs-keyword">if</span> (sp) cout &lt;&lt; stk[sp] &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span>;<br>        <span class="hljs-keyword">else</span> cout &lt;&lt; <span class="hljs-string">&quot;-1 &quot;</span>;<br>        <br>        stk[ ++ sp] = x;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br>STL<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stack&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br>stack&lt;<span class="hljs-keyword">int</span>&gt; s;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-number">0</span>), cin.<span class="hljs-built_in">tie</span>(<span class="hljs-number">0</span>), cout.<span class="hljs-built_in">tie</span>(<span class="hljs-number">0</span>);<br>    <br>    cin &gt;&gt; n;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123;<br>        <span class="hljs-keyword">int</span> x;<br>        cin &gt;&gt; x;<br>        <span class="hljs-keyword">while</span> (!s.<span class="hljs-built_in">empty</span>() &amp;&amp; s.<span class="hljs-built_in">top</span>() &gt;= x) s.<span class="hljs-built_in">pop</span>();<br>        <br>        <span class="hljs-keyword">if</span> (!s.<span class="hljs-built_in">empty</span>()) cout &lt;&lt; s.<span class="hljs-built_in">top</span>() &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span>;<br>        <span class="hljs-keyword">else</span> cout &lt;&lt; <span class="hljs-string">&quot;-1 &quot;</span>;<br>        <br>        s.<span class="hljs-built_in">push</span>(x);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-154-滑动窗口"><a href="#AcWing-154-滑动窗口" class="headerlink" title="AcWing 154. 滑动窗口"></a>AcWing 154. 滑动窗口</h2><p>模拟<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1000010</span>;<br><br><span class="hljs-keyword">int</span> n, k;<br><span class="hljs-keyword">int</span> a[N], q[N];  <span class="hljs-comment">// 该队列维护满足单调性的最小窗口，q[hh]、q[tt]分别表示最小窗口的左右指针。 </span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i]);<br>    <br>    <span class="hljs-keyword">int</span> hh = <span class="hljs-number">0</span>, tt = <span class="hljs-number">-1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123;<br>        <span class="hljs-keyword">if</span> (hh &lt;= tt &amp;&amp; q[hh] &lt; i - k + <span class="hljs-number">1</span>) hh ++ ;<br>        <br>        <span class="hljs-keyword">while</span> (hh &lt;= tt &amp;&amp; a[q[tt]] &gt;= a[i]) tt -- ;<br>        q[ ++ tt] = i;<br>        <br>        <span class="hljs-keyword">if</span> (i &gt;= k - <span class="hljs-number">1</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, a[q[hh]]);  <span class="hljs-comment">// 当原窗口终点到达起始状态时开始</span><br>    &#125;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&quot;</span>);<br>    <br>    hh = <span class="hljs-number">0</span>, tt = <span class="hljs-number">-1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123;<br>        <span class="hljs-keyword">if</span> (hh &lt;= tt &amp;&amp; q[hh] &lt; i - k + <span class="hljs-number">1</span>) hh ++ ;<br>        <br>        <span class="hljs-keyword">while</span> (hh &lt;= tt &amp;&amp; a[q[tt]] &lt;= a[i]) tt -- ;<br>        q[ ++ tt] = i;<br>        <br>        <span class="hljs-keyword">if</span> (i &gt;= k - <span class="hljs-number">1</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, a[q[hh]]);<br>    &#125;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&quot;</span>);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br>STL<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1000010</span>;<br><br><span class="hljs-keyword">int</span> n, k;<br><span class="hljs-keyword">int</span> a[N];<br>deque&lt;<span class="hljs-keyword">int</span>&gt; q;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;k);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i]);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123;<br>        <span class="hljs-keyword">if</span> (!q.<span class="hljs-built_in">empty</span>() &amp;&amp; q.<span class="hljs-built_in">front</span>() &lt; i - k + <span class="hljs-number">1</span>) q.<span class="hljs-built_in">pop_front</span>();<br>        <br>        <span class="hljs-keyword">while</span> (!q.<span class="hljs-built_in">empty</span>() &amp;&amp; a[q.<span class="hljs-built_in">back</span>()] &gt;= a[i]) q.<span class="hljs-built_in">pop_back</span>();<br>        q.<span class="hljs-built_in">push_back</span>(i);<br>        <br>        <span class="hljs-keyword">if</span> (i &gt;= k - <span class="hljs-number">1</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, a[q.<span class="hljs-built_in">front</span>()]);  <span class="hljs-comment">// 当原窗口终点到达起始状态时开始</span><br>    &#125;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&quot;</span>);<br>    <br>    q = deque&lt;<span class="hljs-keyword">int</span>&gt;();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123;<br>        <span class="hljs-keyword">if</span> (!q.<span class="hljs-built_in">empty</span>() &amp;&amp; q.<span class="hljs-built_in">front</span>() &lt; i - k + <span class="hljs-number">1</span>) q.<span class="hljs-built_in">pop_front</span>();<br>        <br>        <span class="hljs-keyword">while</span> (!q.<span class="hljs-built_in">empty</span>() &amp;&amp; a[q.<span class="hljs-built_in">back</span>()] &lt;= a[i]) q.<span class="hljs-built_in">pop_back</span>();<br>        q.<span class="hljs-built_in">push_back</span>(i);<br>        <br>        <span class="hljs-keyword">if</span> (i &gt;= k - <span class="hljs-number">1</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, a[q.<span class="hljs-built_in">front</span>()]);<br>    &#125;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&quot;</span>);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-831-KMP字符串"><a href="#AcWing-831-KMP字符串" class="headerlink" title="AcWing 831. KMP字符串"></a>AcWing 831. KMP字符串</h2><p>j就像是在p串上往回凿一个点然后把p往前拖<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N =<span class="hljs-number">100010</span>, M = <span class="hljs-number">1000010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">char</span> s[M], p[N];<br><span class="hljs-keyword">int</span> nxt[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; n &gt;&gt; p + <span class="hljs-number">1</span> &gt;&gt; m &gt;&gt; s + <span class="hljs-number">1</span>;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>, j = <span class="hljs-number">0</span>; i &lt;= n; i ++ )&#123;  <span class="hljs-comment">// 第一个字符都匹不上时就是退无可退，不管它，就让它为0</span><br>        <span class="hljs-keyword">while</span> (p[i] != p[j + <span class="hljs-number">1</span>] &amp;&amp; j) j = nxt[j];<br>        <span class="hljs-keyword">if</span> (p[i] == p[j + <span class="hljs-number">1</span>]) j ++ ;<br>        nxt[i] = j;<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>, j = <span class="hljs-number">0</span>; i &lt;= m; i ++ )&#123;<br>        <span class="hljs-keyword">while</span> (s[i] != p[j + <span class="hljs-number">1</span>] &amp;&amp; j) j = nxt[j];<br>        <span class="hljs-keyword">if</span> (s[i] == p[j + <span class="hljs-number">1</span>]) j ++ ;<br>        <span class="hljs-keyword">if</span> (j == n)&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, i - n + <span class="hljs-number">1</span> - <span class="hljs-number">1</span>);<br>            j = nxt[j];<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br>这个没有错位的版本我比较喜欢hh<br>好吧，这个版本nxt数组的获得与使用我不是很懂，看来把比较的思路扭回来，那倒回的思路就得扭过去。<br>还是理解y总的吧，y总nxt数组的使用就是：<br>若两个比较的字符不相等，且j可以倒回（<code>j != 0</code>），那j这一处就应该倒回到nxt[j]，所以<code>j = nxt[j]</code>。</p><p><strong>j代表已匹配上的串的结束下标</strong>，0用来判断是否退无可退。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>, M = <span class="hljs-number">1000010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">char</span> p[N], s[M];<br><span class="hljs-keyword">int</span> nxt[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    cin &gt;&gt; n &gt;&gt; p &gt;&gt; m &gt;&gt; s;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>, j = <span class="hljs-number">0</span>; i &lt; n; i ++ )&#123;<br>        <span class="hljs-keyword">while</span> (p[i] != p[j] &amp;&amp; j) j = nxt[j - <span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">if</span> (p[i] == p[j]) j ++ ;<br>        nxt[i] = j;<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>; i &lt; m; i ++ )&#123;<br>        <span class="hljs-keyword">while</span> (s[i] != p[j] &amp;&amp; j) j = nxt[j - <span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">if</span> (s[i] == p[j]) j ++ ;<br>        <span class="hljs-keyword">if</span> (j == n)&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, i - n + <span class="hljs-number">1</span>);<br>            j = nxt[j - <span class="hljs-number">1</span>];<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-835-Trie字符串统计"><a href="#AcWing-835-Trie字符串统计" class="headerlink" title="AcWing 835. Trie字符串统计"></a>AcWing 835. Trie字符串统计</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> son[N][<span class="hljs-number">26</span>], cnt[N], idx;  <span class="hljs-comment">// son含义：创建了N个“蜘蛛”结构，“蜘蛛”的形状为一个圆圈下面有26条腿，圆圈里的内容是它的索引，即idx。</span><br><span class="hljs-keyword">char</span> str[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* str)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>;  <span class="hljs-comment">// 一开始指向根“蜘蛛”结构</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; str[i]; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> u = str[i] - <span class="hljs-string">&#x27;a&#x27;</span>;  <span class="hljs-comment">// 确定蜘蛛腿连接到的子“蜘蛛”</span><br>        <span class="hljs-keyword">if</span> (!son[p][u]) son[p][u] = ++ idx;  <span class="hljs-comment">// 如果子“蜘蛛”是空的，为这个子“蜘蛛”分配一个索引</span><br>        p = son[p][u];  <span class="hljs-comment">// 指向这个子“蜘蛛”</span><br>    &#125;<br>    cnt[p] ++ ;  <span class="hljs-comment">// 用另一个数组记录最后指向的“蜘蛛”结构被指的次数</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* str)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; str[i]; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> u = str[i] - <span class="hljs-string">&#x27;a&#x27;</span>;<br>        <span class="hljs-keyword">if</span> (!son[p][u]) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        p = son[p][u];<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> cnt[p];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <span class="hljs-keyword">while</span> (n -- ) &#123;<br>        <span class="hljs-keyword">char</span> op[<span class="hljs-number">2</span>];  <span class="hljs-comment">// scanf读取单个字符时不会过滤空格，可以声明一个字符串然后用%s作为格式控制符（当然也可以直接使用，会有waring），这样第二个char就是空格</span><br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s%s&quot;</span>, &amp;op, &amp;str);<br>        <span class="hljs-keyword">if</span> (op[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;I&#x27;</span>) <span class="hljs-built_in">insert</span>(str);<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;Q&#x27;</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, <span class="hljs-built_in">query</span>(str));<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-143-最大异或对"><a href="#AcWing-143-最大异或对" class="headerlink" title="AcWing 143. 最大异或对"></a>AcWing 143. 最大异或对</h2><p>这题整明白要考啥之后其实比上一题简单，上一题是不定深度多叉树，这题是固定深度二叉树。<br>总之，就是遍历每个数，尝试着找与这个数具有最大海明距离的数，意思就是每一位能取反就取反，因为：</p><ol><li>如果可以找到这一位取反后的位，那么在异或后这一位就会得到1，<code>res += 1 &lt;&lt; i</code></li><li>如果找不到这一位取反后的位，那么在异或后这一位就会得到0，<code>res += 0 &lt;&lt; i</code>（可省略）<br>这样就会得到<strong>该数</strong>和<strong>使其具有最大海明距离的数</strong>组成的的<strong>最大异或对</strong>及<strong>其进行异或运算的结果</strong>，然后只需打擂得到最大异或对的异或结果就可以了<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>, M = <span class="hljs-number">3100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> a[N], son[M][<span class="hljs-number">2</span>], idx;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">30</span>; i &gt;= <span class="hljs-number">0</span>; i -- ) &#123;<br>        <span class="hljs-keyword">int</span> u = x &gt;&gt; i &amp; <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span> (!son[p][u]) son[p][u] = ++ idx;<br>        p = son[p][u];<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">query</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> p = <span class="hljs-number">0</span>, res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">30</span>; i &gt;= <span class="hljs-number">0</span>; i -- ) &#123;<br>        <span class="hljs-keyword">int</span> u = x &gt;&gt; i &amp; <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span> (son[p][!u]) &#123;<br>            res += <span class="hljs-number">1</span> &lt;&lt; i;<br>            p = son[p][!u];<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            res += <span class="hljs-number">0</span> &lt;&lt; i;<br>            p = son[p][u];<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) &#123;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i]);<br>        <span class="hljs-built_in">insert</span>(a[i]);<br>    &#125;<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) res = <span class="hljs-built_in">max</span>(res, <span class="hljs-built_in">query</span>(a[i]));<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-836-合并集合"><a href="#AcWing-836-合并集合" class="headerlink" title="AcWing 836. 合并集合"></a>AcWing 836. 合并集合</h2></li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> p[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> p[x] == x ? x : p[x] = <span class="hljs-built_in">find</span>(p[x]);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span> <span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) p[i] = i;<br>    <br>    <span class="hljs-keyword">while</span> (m -- ) &#123;<br>        <span class="hljs-keyword">char</span> op[<span class="hljs-number">2</span>];<br>        <span class="hljs-keyword">int</span> a, b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s%d%d&quot;</span>, &amp;op, &amp;a, &amp;b);<br>        <br>        <span class="hljs-keyword">if</span> (op[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;M&#x27;</span>) p[<span class="hljs-built_in">find</span>(a)] = <span class="hljs-built_in">find</span>(b);<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;Q&#x27;</span>) <span class="hljs-built_in">puts</span>(<span class="hljs-built_in">find</span>(a) == <span class="hljs-built_in">find</span>(b) ? <span class="hljs-string">&quot;Yes&quot;</span> : <span class="hljs-string">&quot;No&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-837-连通块中点的数量"><a href="#AcWing-837-连通块中点的数量" class="headerlink" title="AcWing 837. 连通块中点的数量"></a>AcWing 837. 连通块中点的数量</h2><p>按秩合并就只有一句hh~<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N =<span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> p[N], sz[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> p[x] == x ? x : p[x] = <span class="hljs-built_in">find</span>(p[x]);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">unn</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> aa = <span class="hljs-built_in">find</span>(a), bb= <span class="hljs-built_in">find</span>(b);<br>    <span class="hljs-keyword">if</span> (aa != bb) &#123;<br>        <span class="hljs-keyword">if</span> (sz[aa] &gt; sz[bb]) <span class="hljs-built_in">swap</span>(aa, bb);  <span class="hljs-comment">// 按秩合并</span><br>        p[aa] = bb;<br>        sz[bb] += sz[aa];<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) &#123;<br>        p[i] = i;<br>        sz[i] = <span class="hljs-number">1</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">while</span> (m -- ) &#123;<br>        <span class="hljs-keyword">char</span> op[<span class="hljs-number">3</span>];<br>        <span class="hljs-keyword">int</span> a, b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, &amp;op);<br>        <br>        <span class="hljs-keyword">if</span> (op[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;C&#x27;</span>) &#123;<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);<br>            <span class="hljs-built_in">unn</span>(a,b);<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op[<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;1&#x27;</span>) &#123;<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);<br>            <span class="hljs-built_in">puts</span>(<span class="hljs-built_in">find</span>(a) == <span class="hljs-built_in">find</span>(b) ? <span class="hljs-string">&quot;Yes&quot;</span> : <span class="hljs-string">&quot;No&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op[<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;2&#x27;</span>) &#123;<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a);<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, sz[<span class="hljs-built_in">find</span>(a)]);<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-240-食物链"><a href="#AcWing-240-食物链" class="headerlink" title="AcWing 240. 食物链"></a>AcWing 240. 食物链</h2><p>按我理解这就是一个带权并查集，权重为到根节点的距离，通过距离判断“吃”关系时用到了一些数论知识(感谢信安数学)<br>“吃”关系的构建过程大概为每次通过给出一个“圆杠圆”结构，下圆吃上圆，把这个结构不停叠加到树上即可，但真正重要的是权重不是结构，所以可以采用路径压缩破坏结构，但一定要计算新权重。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">50010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> p[N], d[N]; <span class="hljs-comment">// parent[N], distance[N]</span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>    <span class="hljs-comment">// int xx;</span><br>    <span class="hljs-comment">// return p[x] == x ? x : (xx = find(p[x]), d[x] += d[p[x]], p[x] = xx);  // tips：逗号表达式优先级最低且自左向右结合</span><br>    <span class="hljs-keyword">if</span> (p[x] != x) &#123;<br>        <span class="hljs-keyword">int</span> xx = <span class="hljs-built_in">find</span>(p[x]);<br>        d[x] += d[p[x]];<br>        p[x] = xx;<br>    &#125;<br>    <span class="hljs-keyword">return</span> p[x];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) p[i] = i;<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (m -- ) &#123;<br>        <span class="hljs-keyword">int</span> t, x, y;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;t, &amp;x, &amp;y);<br>        <br>        <span class="hljs-keyword">if</span> (x &gt; n || y &gt; n) res ++ ;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">int</span> xx = <span class="hljs-built_in">find</span>(x), yy = <span class="hljs-built_in">find</span>(y);<br>            <span class="hljs-keyword">if</span> (t == <span class="hljs-number">1</span>) &#123;<br>                <span class="hljs-keyword">if</span> (xx == yy &amp;&amp; (d[x] - d[y]) % <span class="hljs-number">3</span>) res ++ ;  <span class="hljs-comment">// d[x] === d[y] mod 3 真  &quot;===&quot;在此代表同余号（三等号）</span><br>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (xx != yy)&#123;<br>                    p[xx] = yy;<br>                    d[xx] = d[y] - d[x];  <span class="hljs-comment">// d[xx] + d[x] === d[y] mod 3  可以直接用等式满足同余式条件</span><br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (t == <span class="hljs-number">2</span>) &#123;<br>                <span class="hljs-keyword">if</span> (xx == yy &amp;&amp; (d[x] - d[y] - <span class="hljs-number">1</span>) % <span class="hljs-number">3</span>) res ++ ;  <span class="hljs-comment">// d[x] - 1 === d[y] mod 3 真 highlight：C++取余不采用最小非负剩余系，判断同余式最好将一侧移项为0</span><br>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (xx != yy)&#123;<br>                    p[xx] = yy;<br>                    d[xx] = d[y] - d[x] + <span class="hljs-number">1</span>;  <span class="hljs-comment">// d[xx] + d[x] - d[y] === 1 mod 3</span><br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure></p><h2 id="AcWing-838-堆排序"><a href="#AcWing-838-堆排序" class="headerlink" title="AcWing 838. 堆排序"></a>AcWing 838. 堆排序</h2><p>模拟<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> h[N], sz;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">down</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> t = u;<br>    <span class="hljs-comment">// 后两步是上左右逐个比较打擂，不是上同时和左右比较，所以索引用t，打赢的继续跟下一个打。</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-number">2</span> * u &lt;= sz &amp;&amp; h[<span class="hljs-number">2</span> * u] &lt; h[t]) t = <span class="hljs-number">2</span> * u;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-number">2</span> * u + <span class="hljs-number">1</span>&lt;= sz &amp;&amp; h[<span class="hljs-number">2</span> * u + <span class="hljs-number">1</span>] &lt; h[t]) t = <span class="hljs-number">2</span> * u + <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> (t != u) &#123;<br>        <span class="hljs-built_in">swap</span>(h[u], h[t]);<br>        <span class="hljs-built_in">down</span>(t);<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;h[i]);<br>    sz = n;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n / <span class="hljs-number">2</span>; i; i -- ) <span class="hljs-built_in">down</span>(i);  <span class="hljs-comment">// n / 2：从倒数第二层起，n对应高度h = $log_2^n$，那n / 2对应高度为$log_2^n$ - 1 = h - 1</span><br>    <br>    <span class="hljs-keyword">while</span> (m -- ) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, h[<span class="hljs-number">1</span>]);<br>        h[<span class="hljs-number">1</span>] = h[sz -- ];<br>        <span class="hljs-built_in">down</span>(<span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br>STL <strong>慢</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br>priority_queue&lt;<span class="hljs-keyword">int</span>, vector&lt;<span class="hljs-keyword">int</span>&gt;, greater&lt;<span class="hljs-keyword">int</span>&gt;&gt; q;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> x;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;x);<br>        q.<span class="hljs-built_in">push</span>(x);<br>    &#125;<br>    <br>    <span class="hljs-keyword">while</span> (m -- ) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, q.<span class="hljs-built_in">top</span>());<br>        q.<span class="hljs-built_in">pop</span>();<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-839-模拟堆"><a href="#AcWing-839-模拟堆" class="headerlink" title="AcWing 839. 模拟堆"></a>AcWing 839. 模拟堆</h2><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202202141556425.jpg" alt=""><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> h[N], hk[N], kh[N], sz;  <span class="hljs-comment">// hk：堆下标映射到输入下标 kh：输入下标映射到堆下标</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">heap_swap</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;<br>    <span class="hljs-built_in">swap</span>(kh[hk[a]],kh[hk[b]]), <span class="hljs-built_in">swap</span>(hk[a], hk[b]);<br>    <span class="hljs-comment">// swap(hk[a],hk[b]), swap(kh[hk[a]], kh[hk[b]]);  // 先改哪个都行</span><br>    <span class="hljs-built_in">swap</span>(h[a], h[b]);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">down</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> t = u;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-number">2</span> * u &lt;= sz &amp;&amp; h[<span class="hljs-number">2</span> * u] &lt; h[t]) t = <span class="hljs-number">2</span> * u;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-number">2</span> * u + <span class="hljs-number">1</span> &lt;= sz &amp;&amp; h[<span class="hljs-number">2</span> * u + <span class="hljs-number">1</span>] &lt; h[t]) t = <span class="hljs-number">2</span> * u + <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> (u != t) &#123;<br>        <span class="hljs-built_in">heap_swap</span>(u, t);<br>        <span class="hljs-built_in">down</span>(t);<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">up</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;<br>    <span class="hljs-keyword">while</span> (u / <span class="hljs-number">2</span> &amp;&amp; h[u] &lt; h[u / <span class="hljs-number">2</span>]) &#123;<br>        <span class="hljs-built_in">heap_swap</span>(u, u / <span class="hljs-number">2</span>);<br>        u /= <span class="hljs-number">2</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">int</span> idx = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (n -- ) &#123;<br>        <span class="hljs-keyword">char</span> op[<span class="hljs-number">5</span>];<br>        <span class="hljs-keyword">int</span> k, x;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, &amp;op);<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">strcmp</span>(op, <span class="hljs-string">&quot;I&quot;</span>)) &#123;<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;x);<br>            sz ++ , idx ++ ;<br>            h[sz] = x;<br>            hk[sz] = idx, kh[idx] = sz;<br>            <span class="hljs-built_in">up</span>(sz);<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">strcmp</span>(op, <span class="hljs-string">&quot;PM&quot;</span>)) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, h[<span class="hljs-number">1</span>]);<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">strcmp</span>(op, <span class="hljs-string">&quot;DM&quot;</span>)) &#123;<br>            <span class="hljs-built_in">heap_swap</span>(<span class="hljs-number">1</span>, sz);<br>            sz -- ;<br>            <span class="hljs-built_in">down</span>(<span class="hljs-number">1</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">strcmp</span>(op,<span class="hljs-string">&quot;D&quot;</span>)) &#123;<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;k);<br>            k = kh[k];<br>            <span class="hljs-built_in">heap_swap</span>(k, sz);<br>            sz -- ;<br>            <span class="hljs-built_in">down</span>(k), <span class="hljs-built_in">up</span>(k);  <span class="hljs-comment">// 只会执行一条</span><br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">strcmp</span>(op,<span class="hljs-string">&quot;C&quot;</span>)) &#123;<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;k, &amp;x);<br>            k = kh[k];<br>            h[k] = x;<br>            <span class="hljs-built_in">down</span>(k), <span class="hljs-built_in">up</span>(k);<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-840-模拟散列表"><a href="#AcWing-840-模拟散列表" class="headerlink" title="AcWing 840. 模拟散列表"></a>AcWing 840. 模拟散列表</h2><p>开放寻址法<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">200003</span>, NONE = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> h[N];  <span class="hljs-comment">// 1 int = 4bytes</span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> k = (x % N + N) % N;<br>    <span class="hljs-keyword">while</span> (h[k] != NONE &amp;&amp; h[k] != x) k = (k + <span class="hljs-number">1</span>) % N;<br>    <span class="hljs-keyword">return</span> k;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> h);  <span class="hljs-comment">// memset初始化的基本单位是byte</span><br>    <br>    <span class="hljs-keyword">while</span> (n -- ) &#123;<br>        <span class="hljs-keyword">char</span> op[<span class="hljs-number">2</span>];<br>        <span class="hljs-keyword">int</span> x;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s%d&quot;</span>, &amp;op, &amp;x);<br>        <span class="hljs-keyword">int</span> k = <span class="hljs-built_in">find</span>(x);<br>        <span class="hljs-keyword">if</span> (*op == <span class="hljs-string">&#x27;I&#x27;</span>) h[k] = x;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*op == <span class="hljs-string">&#x27;Q&#x27;</span>) <span class="hljs-built_in">puts</span>(h[k] == x ? <span class="hljs-string">&quot;Yes&quot;</span> : <span class="hljs-string">&quot;No&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br>拉链法<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100003</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> h[N], e[N], ne[N], idx;  <span class="hljs-comment">// e[N]、ne[N]二者只是模拟Node，数据结构取决于如何使用这些模拟的Node</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> k = (x % N + N) % N;  <span class="hljs-comment">// highlight：C++中可将(余数 + N) % N以调整至N的最小非负剩余系</span><br>    e[idx] = x;<br>    ne[idx] = h[k];<br>    h[k] = idx ++ ;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> k = (x % N + N) % N;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[k]; i != <span class="hljs-number">-1</span>; i = ne[i])<br>        <span class="hljs-keyword">if</span> (e[i] == x) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);<br>    <br>    <span class="hljs-keyword">while</span> (n -- ) &#123;<br>        <span class="hljs-keyword">char</span> op[<span class="hljs-number">2</span>];<br>        <span class="hljs-keyword">int</span> x;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s%d&quot;</span>, &amp;op, &amp;x);<br>        <span class="hljs-keyword">if</span> (*op == <span class="hljs-string">&#x27;I&#x27;</span>) <span class="hljs-built_in">insert</span>(x);<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*op == <span class="hljs-string">&#x27;Q&#x27;</span>) <span class="hljs-built_in">puts</span>(<span class="hljs-built_in">find</span>(x) ? <span class="hljs-string">&quot;Yes&quot;</span> : <span class="hljs-string">&quot;No&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><br>STL <strong>慢</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unordered_map&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">200003</span>, NONE = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-keyword">int</span> n;<br>unordered_map&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; mp;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">while</span> (n -- ) &#123;<br>        <span class="hljs-keyword">char</span> op[<span class="hljs-number">2</span>];<br>        <span class="hljs-keyword">int</span> x;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s%d&quot;</span>, &amp;op, &amp;x);<br>        <span class="hljs-keyword">if</span> (*op == <span class="hljs-string">&#x27;I&#x27;</span>) mp[x] ++ ;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*op == <span class="hljs-string">&#x27;Q&#x27;</span>) <span class="hljs-built_in">puts</span>(mp[x] &gt; <span class="hljs-number">0</span> ? <span class="hljs-string">&quot;Yes&quot;</span> : <span class="hljs-string">&quot;No&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br>对常用memset的测试</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> x, y, z;<br>    <br>    <span class="hljs-built_in">memset</span>(&amp;x, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> x); <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">31</span>; i &gt;= <span class="hljs-number">0</span>; i -- ) cout &lt;&lt; (x &gt;&gt; i &amp; <span class="hljs-number">1</span>); cout &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; x &lt;&lt; endl;<br>    <span class="hljs-built_in">memset</span>(&amp;y, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> y); <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">31</span>; i &gt;= <span class="hljs-number">0</span>; i -- ) cout &lt;&lt; (y &gt;&gt; i &amp; <span class="hljs-number">1</span>); cout &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; y &lt;&lt; endl;<br>    <span class="hljs-built_in">memset</span>(&amp;z, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> z); <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">31</span>; i &gt;= <span class="hljs-number">0</span>; i -- ) cout &lt;&lt; (z &gt;&gt; i &amp; <span class="hljs-number">1</span>); cout &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; z &lt;&lt; endl;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">00000000000000000000000000000000 </span><span class="hljs-number">0</span><br><span class="hljs-symbol">11111111111111111111111111111111 </span>-<span class="hljs-number">1</span><br><span class="hljs-symbol">00111111001111110011111100111111 </span><span class="hljs-number">1061109567</span><br></code></pre></td></tr></table></figure><h2 id="AcWing-841-字符串哈希"><a href="#AcWing-841-字符串哈希" class="headerlink" title="AcWing 841. 字符串哈希"></a>AcWing 841. 字符串哈希</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> ULL = <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>, P = <span class="hljs-number">131</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">char</span> str[N];<br>ULL h[N], p[N];<br><br><span class="hljs-function">ULL <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">int</span> l, <span class="hljs-keyword">int</span> r)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> h[r] - h[l - <span class="hljs-number">1</span>] * p[r - l + <span class="hljs-number">1</span>];  <span class="hljs-comment">// 就是p进制下在L-1后多添了一些0直到R，这样才可以相减</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, str + <span class="hljs-number">1</span>);<br>    <br>    p[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) &#123;<br>        h[i] = h[i - <span class="hljs-number">1</span>] * P + str[i];<br>        p[i] = p[i - <span class="hljs-number">1</span>] * P;<br>    &#125;<br>    <br>    <span class="hljs-keyword">while</span> (m -- ) &#123;<br>        <span class="hljs-keyword">int</span> l1, r1, l2, r2;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d%d&quot;</span>, &amp;l1, &amp;r1, &amp;l2, &amp;r2);<br>        <br>        <span class="hljs-built_in">puts</span>(<span class="hljs-built_in">get</span>(l1, r1) == <span class="hljs-built_in">get</span>(l2, r2) ? <span class="hljs-string">&quot;Yes&quot;</span> : <span class="hljs-string">&quot;No&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="第三讲-搜索与图论"><a href="#第三讲-搜索与图论" class="headerlink" title="第三讲 搜索与图论"></a>第三讲 搜索与图论</h1><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202202250155132.png" alt=""></p><h2 id="AcWing-842-排列数字"><a href="#AcWing-842-排列数字" class="headerlink" title="AcWing 842. 排列数字"></a>AcWing 842. 排列数字</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">10</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> path[N];<br><span class="hljs-keyword">bool</span> st[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (u == n) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, path[i]);<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )  <span class="hljs-comment">// 每个可用数字都代表该层的一个待遍历状态</span><br>        <span class="hljs-keyword">if</span> (!st[i]) &#123;<br>            <span class="hljs-comment">// 进入节点(向下)</span><br>            path[u] = i;<br>            st[i] = <span class="hljs-literal">true</span>;<br>            <span class="hljs-comment">// 离开节点（向下）</span><br>            <span class="hljs-built_in">dfs</span>(u + <span class="hljs-number">1</span>);<br>            <span class="hljs-comment">// 离开节点（向上）</span><br>            <span class="hljs-comment">// path[u] = 0;  // 每层都会被重写</span><br>            st[i] = <span class="hljs-literal">false</span>;<br>        &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-built_in">dfs</span>(<span class="hljs-number">0</span>);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-843-n-皇后问题"><a href="#AcWing-843-n-皇后问题" class="headerlink" title="AcWing 843. n-皇后问题"></a>AcWing 843. n-皇后问题</h2><p>有规律的搜索<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">10</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">char</span> g[N][N];<br><span class="hljs-keyword">int</span> col[N], dg[N], udg[N];  <span class="hljs-comment">// diagonal</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (u == n) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">puts</span>(g[i]);  <span class="hljs-comment">// highlight</span><br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) &#123;<br>        <span class="hljs-keyword">if</span> (!col[i] &amp;&amp; !dg[u + i] &amp;&amp; !udg[n - i + u]) &#123;  <span class="hljs-comment">// 用简单的几何也可以算，u + i：等边直角三角形的另一边长度u + 距纵轴距离i，n - i + u：n -（距纵轴距离i - 等边RT的另一边长度u） </span><br>            g[u][i] = <span class="hljs-string">&#x27;Q&#x27;</span>;<br>            col[i] = dg[u + i] = udg[n - i + u] = <span class="hljs-literal">true</span>;<br>            <span class="hljs-built_in">dfs</span>(u + <span class="hljs-number">1</span>);<br>            g[u][i] = <span class="hljs-string">&#x27;.&#x27;</span>;<br>            col[i] = dg[u + i] = udg[n - i + u] = <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    cin &gt;&gt; n;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n; j ++ )<br>            g[i][j] = <span class="hljs-string">&#x27;.&#x27;</span>;<br>            <br>    <span class="hljs-built_in">dfs</span>(<span class="hljs-number">0</span>);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br>无规律的搜索（暴力搜索）<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">10</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">char</span> g[N][N];<br><span class="hljs-keyword">bool</span> row[N], col[N], dg[N], udg[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y, <span class="hljs-keyword">int</span> s)</span> </span>&#123;<br>    <span class="hljs-comment">// if (s &gt; n) return ;  // 我觉得只要算法是正确的，那么皇后数量就不会超过n</span><br>    <span class="hljs-keyword">if</span> (y == n) y = <span class="hljs-number">0</span>, x ++ ;  <span class="hljs-comment">// 列遍历结束</span><br>    <span class="hljs-keyword">if</span> (x == n) &#123;  <span class="hljs-comment">// 行遍历结束</span><br>        <span class="hljs-keyword">if</span> (s == n) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">puts</span>(g[i]);<br>            <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> ;<br>    &#125;<br>    <br>    <span class="hljs-comment">// 不放皇后</span><br>    <span class="hljs-comment">// g[x][y] = &#x27;.&#x27;;</span><br>    <span class="hljs-built_in">dfs</span>(x, y + <span class="hljs-number">1</span>, s);<br>    <br>    <span class="hljs-comment">// 放皇后</span><br>    <span class="hljs-keyword">if</span> (!row[x] &amp;&amp; !col[y] &amp;&amp; !dg[y + x] &amp;&amp; !udg[n - y + x]) &#123;<br>        g[x][y] = <span class="hljs-string">&#x27;Q&#x27;</span>;<br>        row[x] = col[y] = dg[y + x] = udg[n - y + x] = <span class="hljs-literal">true</span>;<br>        <span class="hljs-built_in">dfs</span>(x, y + <span class="hljs-number">1</span>, s + <span class="hljs-number">1</span>);<br>        g[x][y] = <span class="hljs-string">&#x27;.&#x27;</span>;<br>        row[x] = col[y] = dg[y + x] = udg[n - y + x] = <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    cin &gt;&gt; n;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n; j ++ )<br>            g[i][j] = <span class="hljs-string">&#x27;.&#x27;</span>;<br>            <br>    <span class="hljs-built_in">dfs</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-844-走迷宫"><a href="#AcWing-844-走迷宫" class="headerlink" title="AcWing 844. 走迷宫"></a>AcWing 844. 走迷宫</h2><p>模拟<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> PII = pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt;;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">110</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> g[N][N], d[N][N];<br><br><span class="hljs-keyword">int</span> hh, tt = <span class="hljs-number">-1</span>;<br>PII q[N * N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(d, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> d);<br>    d[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br>    q[ ++ tt] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">0</span>&#125;;<br>    <br>    <span class="hljs-keyword">int</span> dx[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, dy[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>&#125;;<br>    <br>    <span class="hljs-keyword">while</span> (hh &lt;= tt) &#123;<br>        <span class="hljs-keyword">auto</span> t = q[hh ++];<br>        <br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i ++ ) &#123;<br>            <span class="hljs-keyword">int</span> x = t.first + dx[i], y = t.second + dy[i];<br>            <br>            <span class="hljs-keyword">if</span> (x &gt;= <span class="hljs-number">0</span> &amp;&amp; x &lt; n &amp;&amp; y &gt;= <span class="hljs-number">0</span> &amp;&amp; y &lt; m &amp;&amp; g[x][y] == <span class="hljs-number">0</span> &amp;&amp; d[x][y] == <span class="hljs-number">-1</span>) &#123;<br>                d[x][y] = d[t.first][t.second] + <span class="hljs-number">1</span>;<br>                q[ ++ tt] = &#123;x, y&#125;;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> d[n - <span class="hljs-number">1</span>][m - <span class="hljs-number">1</span>];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; j ++ ) <br>            cin &gt;&gt; g[i][j];<br>    <br>    cout &lt;&lt; <span class="hljs-built_in">bfs</span>() &lt;&lt; endl;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br>STL<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> PII = pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt;;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">110</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> g[N][N], d[N][N];<br>queue&lt;PII&gt; q;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(d, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> d);<br>    d[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br>    q.<span class="hljs-built_in">push</span>(&#123;<span class="hljs-number">0</span>, <span class="hljs-number">0</span>&#125;);<br>    <br>    <span class="hljs-keyword">int</span> dx[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, dy[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>&#125;;<br>    <br>    <span class="hljs-keyword">while</span> (q.<span class="hljs-built_in">size</span>()) &#123;<br>        <span class="hljs-keyword">auto</span> t = q.<span class="hljs-built_in">front</span>(); q.<span class="hljs-built_in">pop</span>();<br>        <br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i ++ ) &#123;<br>            <span class="hljs-keyword">int</span> x = t.first + dx[i], y = t.second + dy[i];<br>            <br>            <span class="hljs-keyword">if</span> (x &gt;= <span class="hljs-number">0</span> &amp;&amp; x &lt; n &amp;&amp; y &gt;= <span class="hljs-number">0</span> &amp;&amp; y &lt; m &amp;&amp; g[x][y] == <span class="hljs-number">0</span> &amp;&amp; d[x][y] == <span class="hljs-number">-1</span>) &#123;<br>                d[x][y] = d[t.first][t.second] + <span class="hljs-number">1</span>;<br>                q.<span class="hljs-built_in">push</span>(&#123;x, y&#125;);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> d[n - <span class="hljs-number">1</span>][m - <span class="hljs-number">1</span>];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    cin &gt;&gt; n &gt;&gt; m;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; j ++ ) <br>            cin &gt;&gt; g[i][j];<br>    <br>    cout &lt;&lt; <span class="hljs-built_in">bfs</span>() &lt;&lt; endl;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-845-八数码"><a href="#AcWing-845-八数码" class="headerlink" title="AcWing 845. 八数码"></a>AcWing 845. 八数码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unordered_map&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br>queue&lt;string&gt; q;<br>unordered_map&lt;string, <span class="hljs-keyword">int</span>&gt; d;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bfs</span><span class="hljs-params">(string state)</span> </span>&#123;<br>    q.<span class="hljs-built_in">push</span>(state);<br>    d[state] = <span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-keyword">int</span> dx[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>&#125;, dy[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>&#125;;<br>    <br>    string end = <span class="hljs-string">&quot;12345678x&quot;</span>;<br>    <span class="hljs-keyword">while</span> (q.<span class="hljs-built_in">size</span>()) &#123;<br>        <span class="hljs-keyword">auto</span> t = q.<span class="hljs-built_in">front</span>(); q.<span class="hljs-built_in">pop</span>();<br>        <br>        <span class="hljs-keyword">if</span> (t == end) <span class="hljs-keyword">return</span> d[t];<br>        <br>        <span class="hljs-keyword">int</span> distance = d[t];<br>        <span class="hljs-keyword">int</span> index1 = t.<span class="hljs-built_in">find</span>(<span class="hljs-string">&#x27;x&#x27;</span>);  <span class="hljs-comment">// 索引表示</span><br>        <span class="hljs-keyword">int</span> x = index1 / <span class="hljs-number">3</span>, y = index1 % <span class="hljs-number">3</span>;  <span class="hljs-comment">// 坐标表示</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i ++ ) &#123;<br>            <span class="hljs-keyword">int</span> xx = x + dx[i], yy = y + dy[i];<br>            <span class="hljs-keyword">if</span> (xx &gt;= <span class="hljs-number">0</span> &amp;&amp; xx &lt; <span class="hljs-number">3</span> &amp;&amp; yy &gt;= <span class="hljs-number">0</span> &amp;&amp; yy &lt; <span class="hljs-number">3</span>) &#123;<br>                <span class="hljs-keyword">int</span> index2 = <span class="hljs-number">3</span> * xx + yy;<br>                <span class="hljs-built_in">swap</span>(t[index1], t[index2]);<br>                <span class="hljs-keyword">if</span> (!d.<span class="hljs-built_in">count</span>(t)) &#123;<br>                    d[t] = distance + <span class="hljs-number">1</span>;<br>                    q.<span class="hljs-built_in">push</span>(t);<br>                &#125;<br>                <span class="hljs-built_in">swap</span>(t[index1], t[index2]);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">char</span> s;<br>    string state;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">9</span>; i ++ ) &#123;<br>        cin &gt;&gt; s;<br>        state += s;<br>    &#125;<br>    <br>    cout &lt;&lt; <span class="hljs-built_in">bfs</span>(state) &lt;&lt; endl;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-846-树的重心"><a href="#AcWing-846-树的重心" class="headerlink" title="AcWing 846. 树的重心"></a>AcWing 846. 树的重心</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>, M = <span class="hljs-number">2</span> * N;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> h[N], e[M], ne[M], idx;<br><span class="hljs-keyword">bool</span> st[N];<br><span class="hljs-keyword">int</span> ans = N;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;<br>    e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span> </span>&#123;<br>    st[u] = <span class="hljs-literal">true</span>;<br>    <br>    <span class="hljs-keyword">int</span> sz = <span class="hljs-number">1</span>, mxsz = <span class="hljs-number">0</span>;  <span class="hljs-comment">// size：以结点u为根的子树规模 mxsz：删除结点u后所得连通块规模的最大值</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[u]; i != <span class="hljs-number">-1</span>; i = ne[i]) &#123;<br>        <span class="hljs-keyword">int</span> j = e[i];<br>        <span class="hljs-keyword">if</span> (!st[j]) &#123;<br>            <span class="hljs-keyword">int</span> s = <span class="hljs-built_in">dfs</span>(j);  <span class="hljs-comment">// s：u子树的规模</span><br>            mxsz = <span class="hljs-built_in">max</span>(mxsz, s);<br>            sz += s;<br>        &#125;<br>    &#125;<br>    mxsz = <span class="hljs-built_in">max</span>(mxsz, n - sz);<br>    <br>    ans = <span class="hljs-built_in">min</span>(ans, mxsz);<br>    <br>    <span class="hljs-keyword">return</span> sz;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);<br>    <br>    cin &gt;&gt; n;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> a, b;<br>        cin &gt;&gt; a &gt;&gt; b;<br>        <span class="hljs-built_in">add</span>(a, b); <span class="hljs-built_in">add</span>(b, a);<br>    &#125;<br>    <br>    <br>    <span class="hljs-built_in">dfs</span>(<span class="hljs-number">1</span>);<br>    <br>    cout &lt;&lt; ans &lt;&lt; endl;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-847-图中点的层次"><a href="#AcWing-847-图中点的层次" class="headerlink" title="AcWing 847. 图中点的层次"></a>AcWing 847. 图中点的层次</h2><p>模拟<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> h[N], e[N], ne[N], idx;<br><span class="hljs-keyword">int</span> d[N];<br><br><span class="hljs-keyword">int</span> hh, tt = <span class="hljs-number">-1</span>;<br><span class="hljs-keyword">int</span> q[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;<br>    e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(d, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> d);<br>    <br>    q[ ++ tt] = <span class="hljs-number">1</span>;<br>    d[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-keyword">while</span> (hh &lt;= tt) &#123;<br>        <span class="hljs-keyword">int</span> t = q[hh ++ ];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[t]; i != <span class="hljs-number">-1</span>; i = ne[i]) &#123;<br>            <span class="hljs-keyword">int</span> j = e[i];<br>            <span class="hljs-keyword">if</span> (d[j] == <span class="hljs-number">-1</span>) &#123;<br>                d[j] = d[t] + <span class="hljs-number">1</span>;<br>                q[ ++ tt] = j;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> d[n];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);<br>    <br>    cin &gt;&gt; n &gt;&gt; m;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> a, b;<br>        cin &gt;&gt; a &gt;&gt; b;<br>        <span class="hljs-built_in">add</span>(a, b);<br>    &#125;<br>    <br>    cout &lt;&lt; <span class="hljs-built_in">bfs</span>() &lt;&lt; endl;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br>STL<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> h[N], e[N], ne[N], idx;<br><span class="hljs-keyword">int</span> d[N];<br><br>queue&lt;<span class="hljs-keyword">int</span>&gt; q;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;<br>    e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(d, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> d);<br>    <br>    q.<span class="hljs-built_in">push</span>(<span class="hljs-number">1</span>);<br>    d[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-keyword">while</span> (q.<span class="hljs-built_in">size</span>()) &#123;<br>        <span class="hljs-keyword">int</span> t = q.<span class="hljs-built_in">front</span>(); q.<span class="hljs-built_in">pop</span>();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[t]; i != <span class="hljs-number">-1</span>; i = ne[i]) &#123;<br>            <span class="hljs-keyword">int</span> j = e[i];<br>            <span class="hljs-keyword">if</span> (d[j] == <span class="hljs-number">-1</span>) &#123;<br>                d[j] = d[t] + <span class="hljs-number">1</span>;<br>                q.<span class="hljs-built_in">push</span>(j);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> d[n];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);<br>    <br>    cin &gt;&gt; n &gt;&gt; m;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> a, b;<br>        cin &gt;&gt; a &gt;&gt; b;<br>        <span class="hljs-built_in">add</span>(a, b);<br>    &#125;<br>    <br>    cout &lt;&lt; <span class="hljs-built_in">bfs</span>() &lt;&lt; endl;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-848-有向图的拓扑序列"><a href="#AcWing-848-有向图的拓扑序列" class="headerlink" title="AcWing 848. 有向图的拓扑序列"></a>AcWing 848. 有向图的拓扑序列</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> h[N], e[N], ne[N], idx;<br><span class="hljs-keyword">int</span> d[N];<br><br><span class="hljs-keyword">int</span> hh, tt = <span class="hljs-number">-1</span>;<br><span class="hljs-keyword">int</span> q[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;<br>    e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">topsort</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">if</span> (!d[i]) q[ ++ tt] = i;<br>        <br>    <span class="hljs-keyword">while</span> (hh &lt;= tt) &#123;<br>        <span class="hljs-keyword">int</span> t = q[hh ++ ];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[t]; i != <span class="hljs-number">-1</span>; i = ne[i]) &#123;<br>            <span class="hljs-keyword">int</span> j = e[i];<br>            <span class="hljs-keyword">if</span> ( -- d[j] == <span class="hljs-number">0</span>) q[ ++ tt] =j;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> tt == n - <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> a, b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);<br>        <span class="hljs-built_in">add</span>(a, b);<br>        d[b] ++ ;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">topsort</span>()) <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, q[i]);<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;-1&quot;</span>);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-849-Dijkstra求最短路-I"><a href="#AcWing-849-Dijkstra求最短路-I" class="headerlink" title="AcWing 849. Dijkstra求最短路 I"></a>AcWing 849. Dijkstra求最短路 I</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">510</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> g[N][N], dist[N];<br><span class="hljs-keyword">bool</span> st[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">dijkstra</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(dist, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dist);<br>    dist[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> u = <span class="hljs-number">-1</span>;<br>        <span class="hljs-comment">// 其实和手算一样，第一个选取的一定是点1，随后也是选取距起始点最小的点。同样地，最后一个点不需要更新。</span><br>        <span class="hljs-comment">// 遍历找最近点</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>            <span class="hljs-keyword">if</span> (!st[j] &amp;&amp; (u == <span class="hljs-number">-1</span> || dist[u] &gt; dist[j])) u = j;<br>        <br>        st[u] = <span class="hljs-literal">true</span>;<br>        <br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>            dist[j] = <span class="hljs-built_in">min</span>(dist[j], dist[u] + g[u][j]);<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (dist[n] == INF) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    <span class="hljs-keyword">return</span> dist[n];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(g, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> g);<br>    <br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> a, b, c;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);<br>        g[a][b] = <span class="hljs-built_in">min</span>(g[a][b], c);<br>    &#125;<br>    <br>    <span class="hljs-keyword">int</span> t = <span class="hljs-built_in">dijkstra</span>();<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, t);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>关于0x3f3f3f3f</strong><br>首先我们要知道，无穷大加无穷大等于无穷大<br>但计算机因其存储方式，很容易发生整数溢出，这在没有大整数类和自动扩容机制的C++下尤为明显。<br>所以我们要选取一个足够大但又不会导致相加溢出的数充当无穷大<br>那么<br><code>0x3f == 0b0011 1111 == 0b0100 0000 - 0b1</code><br><code>0x3f + 0x3f ==0b0100 0000 - 0b1 + 0b0100 0000 == 0b1000 0000 - 0b10</code><br>没有发生溢出，满足必要性<br>但并没有说这个充当无穷大的值一定应为<code>0x3f3f3f3f</code>（充分性），所以我觉得可能是因为这个值在保证大的情况下可以加好几次</p><h2 id="AcWing-850-Dijkstra求最短路-II"><a href="#AcWing-850-Dijkstra求最短路-II" class="headerlink" title="AcWing 850. Dijkstra求最短路 II"></a>AcWing 850. Dijkstra求最短路 II</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> PII = pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt;;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">200010</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> h[N], e[N], w[N], ne[N], idx;  <span class="hljs-comment">// w[i]：e[i]到其对应head的距离</span><br><span class="hljs-keyword">int</span> dist[N];<br>priority_queue&lt;PII, vector&lt;PII&gt;, greater&lt;PII&gt;&gt; heap;  <span class="hljs-comment">// pair先按first排序后按second排序</span><br><span class="hljs-keyword">bool</span> st[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b, <span class="hljs-keyword">int</span> c)</span> </span>&#123;<br>    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++ ;<br>&#125;<br><br><span class="hljs-comment">// 堆优化dijkstra，和手算思路很符合</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">dijkstra</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(dist, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dist);<br>    dist[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>    heap.<span class="hljs-built_in">push</span>(&#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>&#125;);  <span class="hljs-comment">// 选取点1起始</span><br>    <br>    <span class="hljs-keyword">while</span> (heap.<span class="hljs-built_in">size</span>()) &#123;<br>        <span class="hljs-comment">// 直接取最近点</span><br>        <span class="hljs-keyword">auto</span> t = heap.<span class="hljs-built_in">top</span>(); heap.<span class="hljs-built_in">pop</span>();  <span class="hljs-comment">// t：距起始点最近的点</span><br>        <span class="hljs-keyword">int</span> ver = t.second, distance = t.first;  <span class="hljs-comment">// ver: vertex  distance：起始点到下标ver点的距离</span><br>        <br>        <span class="hljs-keyword">if</span> (st[ver]) <span class="hljs-keyword">continue</span>;  <span class="hljs-comment">// 跳过已加入st的点</span><br>        st[ver] = <span class="hljs-literal">true</span>;<br>        <br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[ver]; i != <span class="hljs-number">-1</span>; i = ne[i]) &#123;  <span class="hljs-comment">// 依次更新t的后继结点距st的距离，并将这些后继结点加入最小堆</span><br>            <span class="hljs-keyword">int</span> j = e[i];  <span class="hljs-comment">// j：下标为i的结点所存点的号</span><br>            <span class="hljs-keyword">if</span> (dist[j] &gt; distance + w[i]) &#123;<br>                dist[j] = distance + w[i];  <span class="hljs-comment">// w[i]：下标为i的结点所存点到其前趋——下标ver点的距离（图中）</span><br>                heap.<span class="hljs-built_in">push</span>(&#123;dist[j], j&#125;);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (dist[n] == INF) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    <span class="hljs-keyword">return</span> dist[n];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);<br>    <br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> a, b, c;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);<br>        <span class="hljs-built_in">add</span>(a, b, c);<br>    &#125;<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-built_in">dijkstra</span>();<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-853-有边数限制的最短路"><a href="#AcWing-853-有边数限制的最短路" class="headerlink" title="AcWing 853. 有边数限制的最短路"></a>AcWing 853. 有边数限制的最短路</h2><p>对于获得最短路径的最终状态来说，串联没有影响。<br>而对于有边数限制的最短路来说，串联会导致得到的结果是不符合要求的，超过边数限制的最短路。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">510</span>, M =<span class="hljs-number">10010</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Edge</span>&#123;</span><br>    <span class="hljs-keyword">int</span> a, b, c;<br>&#125;edges[M];<br><br><span class="hljs-keyword">int</span> n, m, k;<br><span class="hljs-keyword">int</span> dist[N], backup[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bellman_ford</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(dist, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dist);<br>    dist[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; k; i ++ ) &#123;<br>        <span class="hljs-built_in">memcpy</span>(backup, dist, <span class="hljs-keyword">sizeof</span> dist);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; j ++ ) &#123;<br>            <span class="hljs-keyword">auto</span> t = edges[j];<br>            dist[t.b] = <span class="hljs-built_in">min</span>(dist[t.b], backup[t.a] + t.c);  <span class="hljs-comment">// 松弛操作</span><br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (dist[n] &gt; INF / <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> INF;  <span class="hljs-comment">// INF减去一些数也是INF，这里是对C++实现的一种解决方法，INF更精确的下界可以设为INF - k * 10000：从INF走了k步权值为-10000所得距离仍应是INF。另外，此前无负权边使用dijkstra算法时使用-1来代表不可达，这只是一个标记而已，在有赋权边时距离有可能为-1，不能再将其作为标记，因此可以选INF</span><br>    <span class="hljs-keyword">return</span> dist[n];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;k);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> a, b, c;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);<br>        edges[i] = &#123;a, b, c&#125;;<br>    &#125;<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-built_in">bellman_ford</span>();<br>    <br>    <span class="hljs-keyword">if</span> (res == INF) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;impossible&quot;</span>);<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-851-spfa求最短路"><a href="#AcWing-851-spfa求最短路" class="headerlink" title="AcWing 851. spfa求最短路"></a>AcWing 851. spfa求最短路</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> h[N], e[N], w[N], ne[N], idx;<br><span class="hljs-keyword">int</span> dist[N];<br><span class="hljs-keyword">bool</span> st[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b, <span class="hljs-keyword">int</span> c)</span> </span>&#123;<br>    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++ ;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">spfa</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(dist, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dist);<br>    dist[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;<br>    <br>    queue&lt;<span class="hljs-keyword">int</span>&gt; q;<br>    <br>    q.<span class="hljs-built_in">push</span>(<span class="hljs-number">1</span>);<br>    st[<span class="hljs-number">1</span>] = <span class="hljs-literal">true</span>;<br>    <br>    <span class="hljs-keyword">while</span> (q.<span class="hljs-built_in">size</span>()) &#123;<br>        <span class="hljs-keyword">auto</span> t = q.<span class="hljs-built_in">front</span>(); q.<span class="hljs-built_in">pop</span>();<br>        st[t] = <span class="hljs-literal">false</span>;  <span class="hljs-comment">// highlight</span><br>        <br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[t]; i != <span class="hljs-number">-1</span>; i = ne[i]) &#123;<br>            <span class="hljs-keyword">int</span> j = e[i];<br>            <span class="hljs-keyword">if</span> (dist[j] &gt; dist[t] + w[i])&#123;<br>                dist[j] = dist[t] + w[i];<br>                <span class="hljs-keyword">if</span> (!st[j]) &#123;<br>                    q.<span class="hljs-built_in">push</span>(j);<br>                    st[j] = <span class="hljs-literal">true</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> dist[n];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);<br>    <br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> a, b, c;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);<br>        <span class="hljs-built_in">add</span>(a, b, c);<br>    &#125;<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-built_in">spfa</span>();<br>    <br>    <span class="hljs-keyword">if</span> (res == INF) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;impossible&quot;</span>);<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-852-spfa判断负环"><a href="#AcWing-852-spfa判断负环" class="headerlink" title="AcWing 852. spfa判断负环"></a>AcWing 852. spfa判断负环</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> h[N], e[N], w[N], ne[N], idx;<br><span class="hljs-keyword">int</span> dist[N], cnt[N];<br><span class="hljs-keyword">bool</span> st[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b, <span class="hljs-keyword">int</span> c)</span> </span>&#123;<br>    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++ ;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">spfa</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// memset(dist, 0x3f, sizeof dist);  // highlight 小明考了第一，就算是全班同学都减100分,小明和其他同学的相对值仍不变。同理dist的值不再重要，所以只要初始化为同一个值就即可。</span><br>    <br>    queue&lt;<span class="hljs-keyword">int</span>&gt; q;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) &#123;<br>        q.<span class="hljs-built_in">push</span>(i);<br>        st[i] = <span class="hljs-literal">true</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">while</span> (q.<span class="hljs-built_in">size</span>()) &#123;<br>        <span class="hljs-keyword">auto</span> t = q.<span class="hljs-built_in">front</span>(); q.<span class="hljs-built_in">pop</span>();<br>        st[t] = <span class="hljs-literal">false</span>;<br>        <br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[t]; i != <span class="hljs-number">-1</span>; i = ne[i]) &#123;<br>            <span class="hljs-keyword">int</span> j = e[i];<br>            <span class="hljs-keyword">if</span> (dist[j] &gt; dist[t] + w[i]) &#123;<br>                dist[j] = dist[t] + w[i];<br>                cnt[j] = cnt[t] + <span class="hljs-number">1</span>;<br>                <span class="hljs-keyword">if</span> (cnt[j] &gt;= n) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                <br>                <span class="hljs-keyword">if</span> (!st[j]) &#123;<br>                    q.<span class="hljs-built_in">push</span>(j);<br>                    st[j] = <span class="hljs-literal">true</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);<br>    <br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> a, b, c;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);<br>        <span class="hljs-built_in">add</span>(a, b, c);<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">spfa</span>()) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Yes&quot;</span>);<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;No&quot;</span>);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-854-Floyd求最短路"><a href="#AcWing-854-Floyd求最短路" class="headerlink" title="AcWing 854. Floyd求最短路"></a>AcWing 854. Floyd求最短路</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">210</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-keyword">int</span> n, m, Q;<br><span class="hljs-keyword">int</span> d[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">floyd</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= n; k ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>                d[i][j] = <span class="hljs-built_in">min</span>(d[i][j], d[i][k] + d[k][j]);  <span class="hljs-comment">// dp公式，先背下来吧</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;Q);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>;i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>            <span class="hljs-keyword">if</span> (i == j) d[i][j] = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">else</span> d[i][j] = INF;<br>            <br>    <span class="hljs-keyword">while</span> (m -- ) &#123;<br>        <span class="hljs-keyword">int</span> a, b, c;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);<br>        d[a][b] = <span class="hljs-built_in">min</span>(d[a][b], c);<br>    &#125;<br>    <br>    <span class="hljs-built_in">floyd</span>();<br>    <br>    <span class="hljs-keyword">while</span> (Q -- ) &#123;<br>        <span class="hljs-keyword">int</span> a, b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);<br>        <span class="hljs-keyword">if</span> (d[a][b] &gt; INF /<span class="hljs-number">2</span>) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;impossible&quot;</span>);<br>        <span class="hljs-keyword">else</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, d[a][b]);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202202252345102.png" alt=""></p><h2 id="AcWing-858-Prim算法求最小生成树"><a href="#AcWing-858-Prim算法求最小生成树" class="headerlink" title="AcWing 858. Prim算法求最小生成树"></a>AcWing 858. Prim算法求最小生成树</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">510</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> g[N][N];<br><span class="hljs-keyword">int</span> dist[N];<br><span class="hljs-keyword">bool</span> st[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">prim</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(dist, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> dist);<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> t = <span class="hljs-number">-1</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ )<br>            <span class="hljs-keyword">if</span> (!st[j] &amp;&amp; (t == <span class="hljs-number">-1</span> || dist[j] &lt; dist[t]))<br>                t = j;<br>                <br>        <span class="hljs-comment">// if (i)</span><br>        <span class="hljs-comment">//     if (dist[t] == INF) return INF;</span><br>        <span class="hljs-comment">//     else res += dist[t];</span><br>        <br>        <span class="hljs-comment">// 这样确实好看</span><br>        <span class="hljs-keyword">if</span> (i &amp;&amp; dist[t] == INF) <span class="hljs-keyword">return</span> INF;<br>        <span class="hljs-keyword">if</span> (i) res += dist[t];<br><br>        st[t] = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// 必须写在外面，第0个点也要加入集合。</span><br>        <br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ ) dist[j] = <span class="hljs-built_in">min</span>(dist[j], g[t][j]);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-built_in">memset</span>(g, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> g);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> a, b, c;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);<br>        g[a][b] = g[b][a] = <span class="hljs-built_in">min</span>(g[a][b], c);<br>    &#125;<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-built_in">prim</span>();<br>    <br>    <span class="hljs-keyword">if</span> (res == INF) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;impossible&quot;</span>);<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-859-Kruskal算法求最小生成树"><a href="#AcWing-859-Kruskal算法求最小生成树" class="headerlink" title="AcWing 859. Kruskal算法求最小生成树"></a>AcWing 859. Kruskal算法求最小生成树</h2><p><strong>kruskal是并查集的一个应用</strong></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>, M = <span class="hljs-number">200010</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Edge</span>&#123;</span><br>    <span class="hljs-keyword">int</span> a, b, w;<br>    <br>    <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span> &lt; (Edge &amp;e) <span class="hljs-keyword">const</span> &#123;<br>        <span class="hljs-keyword">return</span> w &lt; e.w;<br>    &#125;<br>&#125;edges[M];<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> p[M];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> p[x] == x ? x : p[x] = <span class="hljs-built_in">find</span>(p[x]);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">kruskal</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">sort</span>(edges, edges + m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) p[i] = i;<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>, cnt = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) &#123;<br>        <span class="hljs-keyword">auto</span> e = edges[i];<br>        <span class="hljs-keyword">int</span> aa = <span class="hljs-built_in">find</span>(e.a), bb = <span class="hljs-built_in">find</span>(e.b);<br>        <span class="hljs-keyword">if</span> (aa != bb) &#123;<br>            p[aa] = bb;<br>            res += e.w;<br>            cnt ++ ;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (cnt &lt; n - <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> INF;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= m; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> a, b, c;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);<br>        edges[i] = &#123;a, b, c&#125;;<br>    &#125;<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-built_in">kruskal</span>();<br>    <br>    <span class="hljs-keyword">if</span> (res == INF) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;impossible&quot;</span>);<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-860-染色法判定二分图"><a href="#AcWing-860-染色法判定二分图" class="headerlink" title="AcWing 860. 染色法判定二分图"></a>AcWing 860. 染色法判定二分图</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>, M = <span class="hljs-number">200010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> h[N], e[M], ne[M], idx;<br><span class="hljs-keyword">int</span> color[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;<br>    e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u, <span class="hljs-keyword">int</span> c)</span> </span>&#123;<br>    color[u] = c;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[u]; i != <span class="hljs-number">-1</span>; i = ne[i] )&#123;<br>        <span class="hljs-keyword">int</span> j =  e[i];<br>        <span class="hljs-keyword">if</span> (color[j] == c) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// 放这似乎快一点点点</span><br>        <span class="hljs-keyword">if</span> (!color[j] &amp;&amp; !<span class="hljs-built_in">dfs</span>(j, <span class="hljs-number">3</span> - c)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// highligh! 二值域可以用他们的和作为被减数来实现转换（不太会表达）</span><br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);<br>    <br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> a, b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);<br>        <span class="hljs-built_in">add</span>(a, b); <span class="hljs-built_in">add</span>(b, a);<br>    &#125;<br>    <br>    <span class="hljs-keyword">bool</span> flag = <span class="hljs-literal">true</span>;    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) &#123;<br>        <span class="hljs-keyword">if</span> (!color[i] &amp;&amp; !<span class="hljs-built_in">dfs</span>(i, <span class="hljs-number">1</span>)) &#123;<br>            flag =<span class="hljs-literal">false</span>;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (flag) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Yes&quot;</span>);<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;No&quot;</span>);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-861-二分图的最大匹配"><a href="#AcWing-861-二分图的最大匹配" class="headerlink" title="AcWing 861. 二分图的最大匹配"></a>AcWing 861. 二分图的最大匹配</h2><p>数组st在该情景下的意义可为：<strong>男生是否询问过女生</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">510</span>, M = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n1, n2, m;<br><span class="hljs-keyword">int</span> h[N], e[M], ne[M], idx;<br><span class="hljs-keyword">int</span> match[N];  <span class="hljs-comment">// match[i]：女生i的对象</span><br><span class="hljs-keyword">bool</span> query[N];  <span class="hljs-comment">// bool st[N];  // 男生是否询问过女生</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;<br>    e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">find</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[x]; i != <span class="hljs-number">-1</span>; i = ne[i]) &#123;  <span class="hljs-comment">// 遍历男生x的所有可联系女生</span><br>        <span class="hljs-keyword">int</span> j = e[i];  <span class="hljs-comment">// 女生的编号j</span><br>        <span class="hljs-keyword">if</span> (!query[j]) &#123;  <span class="hljs-comment">// 如果没询问过</span><br>            query[j] = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// 标记为询问，然后去问她</span><br>            <span class="hljs-keyword">if</span> (!match[j] || <span class="hljs-built_in">find</span>(match[j]))&#123;  <span class="hljs-comment">// 如果女生j没有对象，或者女生j的对象match[j]可以再找一个。  // highlight：query的作用就在这里，递归产生的find栈不会再去询问match[j]自己的对象j</span><br>                match[j] = x;  <span class="hljs-comment">// 那女生j把男生x作为对象</span><br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;  <span class="hljs-comment">// 男生x成功找到对象（在未询问女生中）</span><br>            &#125;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;  <span class="hljs-comment">// 男生x没找着对象（在未询问女生中）</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);<br>    <br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;n1, &amp;n2, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) &#123;<br>        <span class="hljs-keyword">int</span> a, b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);<br>        <span class="hljs-built_in">add</span>(a, b);<br>    &#125;<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n1; i ++ ) &#123;<br>        <span class="hljs-built_in">memset</span>(query, <span class="hljs-literal">false</span>, <span class="hljs-keyword">sizeof</span> query);  <span class="hljs-comment">// 重复使用query，每个男生最初都没有询问过女生</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">find</span>(i)) res ++ ;<br>    &#125;<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h1 id="第四讲-数学知识"><a href="#第四讲-数学知识" class="headerlink" title="第四讲 数学知识"></a>第四讲 数学知识</h1><h2 id="AcWing-866-试除法判定质数"><a href="#AcWing-866-试除法判定质数" class="headerlink" title="AcWing 866. 试除法判定质数"></a>AcWing 866. 试除法判定质数</h2><p>$d | n \iff \frac{n}{d} | n$<br>令我们枚举的d较小，即 $ d \leq \frac{n}{d} \iff d^2 \leq n \iff d \leq \sqrt{n} $<br>对应的代码就是</p><ol><li><code>i &lt;= n / i</code></li><li><code>i * i &lt;= n</code></li><li><code>i &lt;= sqrt(n)</code></li></ol><p>推荐使用方式1，因为<br>2：当循环结束时，必然有$ i ^ 2 &lt;= n$，$ (i + 1) ^ 2 &gt; n $的情况，这时若$ n \approx 2^{32} - 1$（int最大值），那么$ (i + 1) ^ 2 $<strong>会溢出</strong>为负值继续循环一次，<strong>很危险</strong>。<br>3：函数<code>sqrt()</code>采用二分算法，时间复杂度为$ O(logn) $，应用它虽然减少了循环次数却也<strong>增加了单次循环时间</strong>，总时间复杂度即$ O(\sqrt{n}) * O(logn)$<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">int</span> n;<br><br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">is_prime</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (x &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= x / i; i ++ )<br>        <span class="hljs-keyword">if</span> (x % i == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">while</span> (n -- )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a;<br>        cin &gt;&gt; a;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">is_prime</span>(a)) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Yes&quot;</span>);<br>        <span class="hljs-keyword">else</span> <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;No&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-867-分解质因数"><a href="#AcWing-867-分解质因数" class="headerlink" title="AcWing 867. 分解质因数"></a>AcWing 867. 分解质因数</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">int</span> n;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">divide</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n / i; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">if</span> (n % i == <span class="hljs-number">0</span>)<br>        &#123;<br>            <span class="hljs-keyword">int</span> s = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">while</span> (n % i == <span class="hljs-number">0</span>) n /= i, s ++ ;<br>            cout &lt;&lt; i &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; s &lt;&lt; endl;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">1</span>) cout &lt;&lt; n &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; <span class="hljs-number">1</span> &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    cin &gt;&gt; n;<br>    <span class="hljs-keyword">while</span> (n -- )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a;<br>        cin &gt;&gt; a;<br>        <span class="hljs-built_in">divide</span>(a);<br>        cout &lt;&lt; endl;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-868-筛质数"><a href="#AcWing-868-筛质数" class="headerlink" title="AcWing 868. 筛质数"></a>AcWing 868. 筛质数</h2><p>朴素筛法：筛掉所有数的倍数，时间复杂度：$O(nlogn)$<br>略</p><p><strong>Eratosthenes筛法（埃氏筛法）：筛掉所有质数的倍数</strong>，时间复杂度：$O(nloglogn) \approx O(n)$，<br>Eratosthenes筛法的一种证明：由算数基本定理：每个大于1的自然数，要么本身就是质数，要么可以写为2个或以上的质数的积，而且这些质因子按大小排列之后，写法仅有一种方式。那么所有大于1的自然数可以划分为两个集合：质数集合、以质数为因数的集合，那么我们把质数的倍数筛掉后就不存在以质数为因数的集合了。&gt;=2的自然数集都可以这么筛，那2~n的集合自然也可以这么筛。</p><p>线性筛法（欧拉筛法）：在线性时间内筛出素数。每个合数只被其最小质因子筛掉<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1000010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> primes[N], cnt;<br><span class="hljs-keyword">bool</span> st[N];  <span class="hljs-comment">// 0：没被筛过 1：被筛过</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">get_primes</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">if</span> (!st[i])<br>        &#123;<br>            primes[cnt ++ ] = i;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i + i; j &lt;= n; j += i) st[j] = <span class="hljs-literal">true</span>;<br>        &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    cin &gt;&gt; n;<br>    <span class="hljs-built_in">get_primes</span>(n);<br>    <br>    <span class="hljs-comment">// for (int i = 0; i &lt; cnt; i ++ ) cout &lt;&lt; primes[i] &lt;&lt; &#x27; &#x27;;</span><br>    <span class="hljs-comment">// cout &lt;&lt; endl;</span><br>    <br>    cout &lt;&lt; cnt;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-869-试除法求约数"><a href="#AcWing-869-试除法求约数" class="headerlink" title="AcWing 869. 试除法求约数"></a>AcWing 869. 试除法求约数</h2><p>$1 \sim n$中所有约数的个数 = $ \frac{n}{1} + \frac{n}{2} + \dots + \frac{n}{n} = nlogn $，那么每个数的平均约数个数 = $ logn $<br>那么对每个的约数排序的时间复杂度为$O(logn * log(logn))（sort部分） &lt; O(\sqrt n)（for部分）$</p><p>那么该组合算法的时间复杂度$O(\sqrt n)$<br>本题数据量为：$n<em>\sqrt a = 100 </em> \sqrt {2 <em> 10 ^ 9} \approx 100 </em> 4万 = 400 万 &lt; 1亿$<br>4万 ^ 2 = 1.6 <em> 10 ^ 9,<br>5万 ^ 2 = 2.5 </em> 10 ^ 9<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">int</span> n;<br><br><span class="hljs-function">vector&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">get_divisors</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    vector&lt;<span class="hljs-keyword">int</span>&gt; res;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n / i; i ++ )<br>        <span class="hljs-keyword">if</span> (n % i == <span class="hljs-number">0</span>)<br>        &#123;<br>            res.<span class="hljs-built_in">push_back</span>(i);<br>            <span class="hljs-keyword">if</span> (i != n / i) res.<span class="hljs-built_in">push_back</span>(n / i);<br>        &#125;<br>    <br>    <span class="hljs-built_in">sort</span>(res.<span class="hljs-built_in">begin</span>(), res.<span class="hljs-built_in">end</span>());<br>    <br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    cin &gt;&gt; n;<br>    <br>    <span class="hljs-keyword">while</span> (n -- )<br>    &#123;<br>        <span class="hljs-keyword">int</span> x;<br>        cin &gt;&gt; x;<br>        <span class="hljs-keyword">auto</span> ans = <span class="hljs-built_in">get_divisors</span>(x);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> i : ans) cout &lt;&lt; i &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span>;<br>        cout &lt;&lt; endl;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-870-约数个数"><a href="#AcWing-870-约数个数" class="headerlink" title="AcWing 870. 约数个数"></a>AcWing 870. 约数个数</h2><p>由算数基本定理:</p><script type="math/tex; mode=display">N = {p_{1} ^ {\alpha_1}}{p_{2} ^ {\alpha_2}} \dots {p_{n} ^ {\alpha_n}}</script><p>设 $d$ 是 $N$ 的约数，则</p><script type="math/tex; mode=display">d = {p_{1} ^ {\beta_1}}{p_{2} ^ {\beta_2}} \dots {p_{n} ^ {\beta_n}}</script><p>他们具有相同的质因子 $q _ i$ ，且 $ 0 \leq \beta_i \leq \alpha_i$<br>那么 $ N $ 的因数个数，即d的数量为 <script type="math/tex">(\alpha_1 +1) * ((\alpha_2 +1)) * (\alpha_n +1)</script></p><p>另外：在int范围内，约数个数最多的数大概有1500个约数，也就是说int范围每个数的约数个数都不超过1500<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unordered_map&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> LL = <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">110</span>, MOD = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;<br><br><span class="hljs-keyword">int</span> n;<br>unordered_map&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; alphas;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    cin &gt;&gt; n;<br>    <br>    <span class="hljs-keyword">while</span> (n -- )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a;<br>        cin &gt;&gt; a;<br>        <br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= a / i; i ++ )<br>            <span class="hljs-keyword">while</span> (a % i == <span class="hljs-number">0</span>)<br>            &#123;<br>                a /= i;<br>                alphas[i] ++ ;<br>            &#125;<br>        <span class="hljs-keyword">if</span> (a &gt; <span class="hljs-number">1</span>) alphas[a] ++ ;<br>    &#125;<br>    <br>    LL res = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> a : alphas) res = res * (a.second + <span class="hljs-number">1</span>) % MOD;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-871-约数之和"><a href="#AcWing-871-约数之和" class="headerlink" title="AcWing 871. 约数之和"></a>AcWing 871. 约数之和</h2><p>接上题,将 $N$ 的约数 $d$ 每一项的可能值（ $ \beta <em> i $ 从 $ 0 $ 遍历至 $ \alpha </em> i $）写成和式再积起来即可</p><script type="math/tex; mode=display">约数之和 = (p _ 1 ^ 0 + p _ 1 ^ 1  + \dots + p _ 1 ^ {\alpha _ 1} )(p _ 2 ^ 0 + p _ 2 ^ 1  + \dots + p _ 2 ^ {\alpha _ 1} ) \dots (p _ n ^ 0 + p _ n ^ 1  + \dots + p _ n ^ {\alpha _ 1} )</script><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unordered_map&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> LL = <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">110</span>, MOD = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;<br><br><span class="hljs-keyword">int</span> n;<br>unordered_map&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt; pas;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    cin &gt;&gt; n;<br>    <br>    <span class="hljs-keyword">while</span> (n -- )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a;<br>        cin &gt;&gt; a;<br>        <br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= a / i; i ++ )<br>            <span class="hljs-keyword">while</span> (a % i == <span class="hljs-number">0</span>)<br>            &#123;<br>                a /= i;<br>                pas[i] ++ ;<br>            &#125;<br>        <span class="hljs-keyword">if</span> (a &gt; <span class="hljs-number">1</span>) pas[a] ++ ;<br>    &#125;<br>    <br>    LL res = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> pa : pas)<br>    &#123;<br>        LL p = pa.first, b = pa.second;<br>        LL term = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> (b -- ) term = (<span class="hljs-number">1</span> + p * term) % MOD;  <span class="hljs-comment">// 等比数列和的递归写法：每一大项都可以拆为 1 + 公比 * 小项</span><br>        res = res * term % MOD;<br>    &#125;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-872-最大公约数"><a href="#AcWing-872-最大公约数" class="headerlink" title="AcWing 872. 最大公约数"></a>AcWing 872. 最大公约数</h2><p>$(a, b) = (b, a\ mod\ b)$<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">int</span> n;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">gcd</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> b ? <span class="hljs-built_in">gcd</span>(b, a % b) : a;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <span class="hljs-keyword">while</span> (n -- )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a, b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, <span class="hljs-built_in">gcd</span>(a,b));<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-873-欧拉函数"><a href="#AcWing-873-欧拉函数" class="headerlink" title="AcWing 873. 欧拉函数"></a>AcWing 873. 欧拉函数</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">int</span> n;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">phi</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> res = x;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= x / i; i ++ )<br>        <span class="hljs-keyword">if</span> (x % i == <span class="hljs-number">0</span>)<br>        &#123;<br>            res = res / i * (i - <span class="hljs-number">1</span>);<br>            <span class="hljs-keyword">while</span> (x % i == <span class="hljs-number">0</span>) x /= i;<br>        &#125;<br>    <span class="hljs-keyword">if</span> (x &gt; <span class="hljs-number">1</span>) res = res / x * (x - <span class="hljs-number">1</span>);<br>    <br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <span class="hljs-keyword">while</span> (n -- )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, <span class="hljs-built_in">phi</span>(a));<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-874-筛法求欧拉函数"><a href="#AcWing-874-筛法求欧拉函数" class="headerlink" title="AcWing 874. 筛法求欧拉函数"></a>AcWing 874. 筛法求欧拉函数</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> LL = <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1000010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> primes[N], cnt;<br><span class="hljs-keyword">int</span> phi[N];<br><span class="hljs-keyword">bool</span> st[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">get_eulers</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    phi[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">if</span> (!st[i])<br>        &#123;<br>            primes[cnt ++ ] = i;<br>            phi[i] = i - <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; primes[j] &lt;= n / i; j ++ )<br>        &#123;<br>            st[primes[j] * i] = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">if</span> (i % primes[j] == <span class="hljs-number">0</span>)<br>            &#123;   <br>                phi[primes[j] * i] = phi[i] * primes[j];<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            <span class="hljs-keyword">else</span><br>                phi[primes[j] * i] = phi[i] * (primes[j] - <span class="hljs-number">1</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-built_in">get_eulers</span>(n);<br>    <br>    LL res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) res += phi[i];<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-875-快速幂"><a href="#AcWing-875-快速幂" class="headerlink" title="AcWing 875. 快速幂"></a>AcWing 875. 快速幂</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> LL = <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><br><span class="hljs-function">LL <span class="hljs-title">qmi</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span> p)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (k)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (k &amp; <span class="hljs-number">1</span>) res = (LL)res * a %p;<br>        k &gt;&gt;= <span class="hljs-number">1</span>;<br>        a = (LL)a * a % p;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">while</span> (n -- )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a, b, c;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;c);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, <span class="hljs-built_in">qmi</span>(a, b, c));<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-876-快速幂求逆元"><a href="#AcWing-876-快速幂求逆元" class="headerlink" title="AcWing 876. 快速幂求逆元"></a>AcWing 876. 快速幂求逆元</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> LL = <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><br><span class="hljs-function">LL <span class="hljs-title">qmi</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b, <span class="hljs-keyword">int</span> p)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (b)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (b &amp; <span class="hljs-number">1</span>) res = (LL)res * a % p;<br>        b &gt;&gt;= <span class="hljs-number">1</span>;<br>        a = (LL)a * a % p;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">while</span> (n -- )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a, p;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;p);<br>        <br>        <span class="hljs-keyword">if</span> (a % p == <span class="hljs-number">0</span>) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;impossible&quot;</span>);  <span class="hljs-comment">// 题目已保证p是质数，那么a, p不互质的唯一情况是a, p均含有公因子p，那么此时a % p == 0</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, <span class="hljs-built_in">qmi</span>(a, p - <span class="hljs-number">2</span>, p));<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-877-扩展欧几里得算法"><a href="#AcWing-877-扩展欧几里得算法" class="headerlink" title="AcWing 877. 扩展欧几里得算法"></a>AcWing 877. 扩展欧几里得算法</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">exgcd</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b, <span class="hljs-keyword">int</span> &amp;x, <span class="hljs-keyword">int</span> &amp;y)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">// return b ? gcd(b, a % b) : a;</span><br>    <span class="hljs-keyword">if</span> (b)<br>    &#123;<br>        <span class="hljs-keyword">int</span> d = <span class="hljs-built_in">exgcd</span>(b, a % b, y, x);<br>        y -= a / b * x;<br>        <span class="hljs-keyword">return</span> d;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        x = <span class="hljs-number">1</span>, y = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">return</span> a;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">while</span> (n -- )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a, b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);<br>        <br>        <span class="hljs-keyword">int</span> x, y;<br>        <span class="hljs-built_in">exgcd</span>(a, b, x, y);<br>        <br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d %d\n&quot;</span>, x, y);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-878-线性同余方程"><a href="#AcWing-878-线性同余方程" class="headerlink" title="AcWing 878. 线性同余方程"></a>AcWing 878. 线性同余方程</h2><script type="math/tex; mode=display">ax \equiv b (mod\ m) \tag{1}</script><script type="math/tex; mode=display">ax = my + b</script><p>令 $ y = -y $</p><script type="math/tex; mode=display">ax + my = b \tag{2}</script><p>由扩展欧几里得可以求得：</p><script type="math/tex; mode=display">ax_0 + my_0 = d = gcd(a, b) \tag{3}</script><p>由贝祖定理：<br>若 $x$, $y$ 有解，则$ d | b $<br>那么只需将等式$(3)$乘$ \frac{b}{d} $，变为</p><script type="math/tex; mode=display">ax_0 * \frac{b}{d} + my_0 * \frac{b}{d} = b \tag{4}</script><p>此时由 $(2)$ $(4)$ 同构，可得</p><script type="math/tex; mode=display">x = x_0 * \frac{b}{d}</script><p>虽然直接这样写会WA，但是在数学上是正确的。<br><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203071815727.png" alt=""><br><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203071819844.png" alt=""><br>错误的原因在于我们的答案在LL范围内，而题目要求“输出答案必须在 $int$ 范围之内”，我们可以 $ \% m $ 直接把答案压到最小剩余系范围内，这样就一定在int范围内了</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> LL = <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">exgcd</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b, <span class="hljs-keyword">int</span> &amp;x, <span class="hljs-keyword">int</span> &amp;y)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (b)<br>    &#123;<br>        <span class="hljs-keyword">int</span> d = <span class="hljs-built_in">exgcd</span>(b, a % b, y, x);<br>        y -= a / b * x;<br>        <span class="hljs-keyword">return</span> d;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        x = <span class="hljs-number">1</span>, y = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">return</span> a;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">while</span> (n -- )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a, b, m;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;a, &amp;b, &amp;m);<br>        <span class="hljs-keyword">int</span> x, y;<br>        <span class="hljs-keyword">int</span> d = <span class="hljs-built_in">exgcd</span>(a, m, x, y);<br>        <span class="hljs-keyword">if</span> (b % d) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;impossible&quot;</span>);<br>        <span class="hljs-keyword">else</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, (LL)x * b / d % m);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-204-表达整数的奇怪方式"><a href="#AcWing-204-表达整数的奇怪方式" class="headerlink" title="AcWing 204. 表达整数的奇怪方式"></a>AcWing 204. 表达整数的奇怪方式</h2><p>注意本题输入顺序及表达（<strong>与一般表示相反</strong>）！先输入模数再输入同余数<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> LL = <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">30</span>;<br><br><span class="hljs-keyword">int</span> n;<br><br><span class="hljs-function">LL <span class="hljs-title">exgcd</span><span class="hljs-params">(LL a, LL b, LL &amp;x, LL &amp;y)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (b)<br>    &#123;<br>        LL d = <span class="hljs-built_in">exgcd</span>(b, a % b, y, x);<br>        y -= a / b * x;<br>        <span class="hljs-keyword">return</span> d;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        x = <span class="hljs-number">1</span>, y = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">return</span> a;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>   <br>    LL x = <span class="hljs-number">0</span>;<br>    LL m1, a1;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld%lld&quot;</span>, &amp;m1, &amp;a1);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i ++ )<br>    &#123;<br>        LL m2, a2;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld%lld&quot;</span>, &amp;m2, &amp;a2);<br>        LL k1, k2;<br>        LL d = <span class="hljs-built_in">exgcd</span>(m1, m2, k1, k2);  <span class="hljs-comment">// k1：“gcd方程”特解</span><br>        <span class="hljs-keyword">if</span> ((a2 - a1) % d)<br>        &#123;<br>            x = <span class="hljs-number">-1</span>;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <br>        k1 *= (a2 - a1) / d;  <span class="hljs-comment">// k1：原方程特解</span><br>        LL t = m2 / d;<br>        k1 = (k1 % t + t) % t;  <span class="hljs-comment">// k1：原方程最小非负解</span><br>        <br>        x = k1 * m1 + a1;  <span class="hljs-comment">// x：原方程组最小非负解</span><br>        <br>        LL m = m1 / d * m2;  <span class="hljs-comment">// lcm</span><br>        a1 = k1 * m1 + a1;<br>        m1 = m;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (x != <span class="hljs-number">-1</span>) x = (a1 % m1 + m1) % m1;<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld\n&quot;</span>, x);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-883-高斯消元解线性方程组"><a href="#AcWing-883-高斯消元解线性方程组" class="headerlink" title="AcWing 883. 高斯消元解线性方程组"></a>AcWing 883. 高斯消元解线性方程组</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">110</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">double</span> eps = <span class="hljs-number">1e-8</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">double</span> a[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">gauss</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> c, r;<br>    <span class="hljs-keyword">for</span> (c = <span class="hljs-number">0</span>, r = <span class="hljs-number">0</span>; c &lt; n; c ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> t = r;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = r; i &lt; n; i ++ )  <span class="hljs-comment">// 找每列绝对值最大的那行</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">fabs</span>(a[i][c]) &gt; <span class="hljs-built_in">fabs</span>(a[t][c]))<br>                t = i;<br>        <br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">fabs</span>(a[t][c]) &lt; eps) <span class="hljs-keyword">continue</span>;<br>        <br>        <span class="hljs-comment">// 当前列之前的列不需要进行行交换、也不用陪当前列单位化，因为已经被消成0了</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = c; i &lt;= n; i ++ ) <span class="hljs-built_in">swap</span>(a[t][i], a[r][i]);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n; i &gt;= c; i -- ) a[r][i] /= a[r][c];<br>        <span class="hljs-comment">// 遍历（专业名词忘了）下面的行，将当前列消为0</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = r + <span class="hljs-number">1</span>; i &lt; n; i ++ )<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">fabs</span>(a[i][c]) &gt; eps)<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = n; j &gt;= c; j -- )<br>                    a[i][j] -= a[r][j] * a[i][c];<br>        <br>        r ++ ;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (r &lt; n)<br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i =r; i &lt; n; i ++ )<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">fabs</span>(a[i][n] &gt; eps))  <span class="hljs-comment">// 0 0 ... 0 C这种情况</span><br>                <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;  <span class="hljs-comment">// 0 0 ... 0 0这种情况</span><br>    &#125;<br>    <br>    <span class="hljs-comment">// 自下至上消掉非对角线元素</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i -- )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i + <span class="hljs-number">1</span>; j &lt; n; j ++ )<br>            a[i][n] -= a[i][j] * a[j][n];<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n + <span class="hljs-number">1</span>; j ++ )<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lf&quot;</span>, &amp;a[i][j]);<br>            <br>    <span class="hljs-keyword">int</span> t = <span class="hljs-built_in">gauss</span>();<br>    <span class="hljs-keyword">if</span> (t == <span class="hljs-number">2</span>) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;No solution&quot;</span>);<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (t == <span class="hljs-number">1</span>) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Infinite group solutions&quot;</span>);<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (t == <span class="hljs-number">0</span>)<br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>        &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">fabs</span>(a[i][n]) &lt; eps) a[i][n] = <span class="hljs-number">0</span>;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%.2lf\n&quot;</span>, a[i][n]);<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-884-高斯消元解异或线性方程组"><a href="#AcWing-884-高斯消元解异或线性方程组" class="headerlink" title="AcWing 884. 高斯消元解异或线性方程组"></a>AcWing 884. 高斯消元解异或线性方程组</h2><p>({0, 1}, ^)群，在{0, 1}域下，^等价于+，&amp;等价于*<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">110</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> a[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">gauss</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> c, r;<br>    <span class="hljs-keyword">for</span> (c = <span class="hljs-number">0</span>, r = <span class="hljs-number">0</span>; c &lt; n; c ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> t = r;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = r; i &lt; n; i ++ )<br>            <span class="hljs-keyword">if</span> (a[i][c])<br>                t = i;<br>                <br>        <span class="hljs-keyword">if</span> (a[t][c] == <span class="hljs-number">0</span>) <span class="hljs-keyword">continue</span>;<br>        <br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = c; i &lt;= n; i ++ ) <span class="hljs-built_in">swap</span>(a[t][i], a[r][i]);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = r + <span class="hljs-number">1</span>; i &lt; n; i ++ )<br>            <span class="hljs-keyword">if</span> (a[i][c])  <span class="hljs-comment">// 首一，需要消掉本行1后的元素</span><br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = c; j &lt;= n ; j ++ )<br>                    a[i][j] ^= a[r][j];<br>                    <br>        r ++ ;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (r &lt; n)  <span class="hljs-comment">// 秩小于行数</span><br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = r; i &lt; n; i ++ )<br>            <span class="hljs-keyword">if</span> (a[i][n])  <span class="hljs-comment">// 0 0 ... 0 1</span><br>                <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i -- )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i + <span class="hljs-number">1</span>; j &lt; n; j ++ )<br>            a[i][n] ^= a[j][n] &amp; a[i][j];<br>            <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n + <span class="hljs-number">1</span>; j ++ )<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i][j]);<br><br>    <span class="hljs-keyword">int</span> t = <span class="hljs-built_in">gauss</span>();<br>    <br>    <span class="hljs-keyword">if</span> (t == <span class="hljs-number">2</span>) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;No solution&quot;</span>);<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (t == <span class="hljs-number">1</span>) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Multiple sets of solutions&quot;</span>);<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (t == <span class="hljs-number">0</span>) <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, a[i][n]);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="AcWing-885-求组合数-I"><a href="#AcWing-885-求组合数-I" class="headerlink" title="AcWing 885. 求组合数 I"></a>AcWing 885. 求组合数 I</h2><script type="math/tex; mode=display">C_a^b = C_{a-1}^{b-1} +C_{a-1}^b</script><p>从a中元素选b个元素 等价于</p><ol><li>某个元素被选中，接着从剩余a-1个中选取b-1个</li><li>某个元素未被选中，接着从剩余a-1个钟选取b个<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">2010</span>, MOD = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> c[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; N; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= i; j ++ )<br>            <span class="hljs-keyword">if</span> (!j) c[i][j] = <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">else</span> c[i][j] = (c[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>] + c[i - <span class="hljs-number">1</span>][j]) % MOD;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-built_in">init</span>();<br>    <br>    <span class="hljs-keyword">while</span> (n -- )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a, b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);<br>        <br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, c[a][b]);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-886-求组合数-II"><a href="#AcWing-886-求组合数-II" class="headerlink" title="AcWing 886. 求组合数 II"></a>AcWing 886. 求组合数 II</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> LL = <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>, mod = <span class="hljs-number">1e9</span> +<span class="hljs-number">7</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> fact[N], infact[N];  <span class="hljs-comment">// factorial, inverse element of factorial</span><br><br><span class="hljs-comment">// 只要两个10^9相乘就要转LL防止爆int</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">qmi</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span> p)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (k)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (k &amp; <span class="hljs-number">1</span>) res = (LL)res * a % p;<br>        k &gt;&gt;= <span class="hljs-number">1</span>;<br>        a = (LL)a * a % p;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    fact[<span class="hljs-number">0</span>] = infact[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; N; i ++ )<br>    &#123;<br>        fact[i] = (LL)fact[i - <span class="hljs-number">1</span>] * i % mod;<br>        infact[i] = (LL)infact[i - <span class="hljs-number">1</span>] * <span class="hljs-built_in">qmi</span>(i, mod - <span class="hljs-number">2</span>, mod) % mod;<br>    &#125;<br>    <br>    <span class="hljs-keyword">while</span> (n -- )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a, b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, (LL)fact[a] * infact[b] % mod * infact[a - b] % mod);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-887-求组合数-III"><a href="#AcWing-887-求组合数-III" class="headerlink" title="AcWing 887. 求组合数 III"></a>AcWing 887. 求组合数 III</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> LL = <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">int</span> n;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">qmi</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span> p)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">1</span>; <br>    <span class="hljs-keyword">while</span> (k)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (k &amp; <span class="hljs-number">1</span>) res = (LL)res * a % p;<br>        k &gt;&gt;= <span class="hljs-number">1</span>;<br>        a = (LL)a * a % p;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">C</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b, <span class="hljs-keyword">int</span> p)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (b &gt; a) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = b, j = a;i &gt;= <span class="hljs-number">1</span>; i -- , j -- )<br>    &#123;<br>        res = (LL)res * j % p;<br>        res = (LL)res * <span class="hljs-built_in">qmi</span>(i, p - <span class="hljs-number">2</span>, p) % p;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">lucas</span><span class="hljs-params">(LL a, LL b, <span class="hljs-keyword">int</span> p)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (a &lt; p &amp;&amp; b &lt; p) <span class="hljs-keyword">return</span> <span class="hljs-built_in">C</span>(a, b, p);<br>    <span class="hljs-keyword">return</span> (LL)<span class="hljs-built_in">lucas</span>(a / p, b / p, p) * <span class="hljs-built_in">C</span>(a % p, b % p, p) % p;  <span class="hljs-comment">// highlight：这里要递归使用lucas&#x27;s Theorem以完全分解至p进制！</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">while</span> (n -- )<br>    &#123;<br>        LL a, b;<br>        <span class="hljs-keyword">int</span> p;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%lld%lld%d&quot;</span>, &amp;a, &amp;b, &amp;p);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, <span class="hljs-built_in">lucas</span>(a, b, p));<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-888-求组合数-IV"><a href="#AcWing-888-求组合数-IV" class="headerlink" title="AcWing 888. 求组合数 IV"></a>AcWing 888. 求组合数 IV</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">5010</span>;<br><br><span class="hljs-keyword">int</span> primes[N], cnt;<br><span class="hljs-keyword">bool</span> st[N];<br><span class="hljs-keyword">int</span> sum[N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">get_primes</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">if</span> (!st[i]) primes[cnt ++ ] = i;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; primes[j] &lt;= n / i; j ++ )<br>        &#123;<br>            st[primes[j] * i] = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">if</span> (i % primes[j] == <span class="hljs-number">0</span>) <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> p)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (x)<br>    &#123;<br>        res += x / p;<br>        x /= p;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function">vector&lt;<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">mul</span><span class="hljs-params">(vector&lt;<span class="hljs-keyword">int</span>&gt; &amp;A, <span class="hljs-keyword">int</span> b)</span></span><br><span class="hljs-function"></span>&#123;<br>    vector&lt;<span class="hljs-keyword">int</span>&gt; res;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, t = <span class="hljs-number">0</span>; i &lt; A.<span class="hljs-built_in">size</span>() || t; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">if</span> (i &lt; A.<span class="hljs-built_in">size</span>()) t += A[i] * b;<br>        res.<span class="hljs-built_in">push_back</span>(t % <span class="hljs-number">10</span>);<br>        t /= <span class="hljs-number">10</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">while</span> (res.<span class="hljs-built_in">back</span>() == <span class="hljs-number">0</span> &amp;&amp; res.<span class="hljs-built_in">size</span>() &gt; <span class="hljs-number">1</span>) res.<span class="hljs-built_in">pop_back</span>();<br>    <br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> a, b;<br>    <br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);<br>    <br>    <span class="hljs-built_in">get_primes</span>(a);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; cnt; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> p = primes[i];<br>        sum[i] = <span class="hljs-built_in">get</span>(a, p) - <span class="hljs-built_in">get</span>(b, p) - <span class="hljs-built_in">get</span>(a - b, p);<br>    &#125;<br>    <br>    vector&lt;<span class="hljs-keyword">int</span>&gt; res;<br>    res.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">1</span>);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; cnt; i ++ )<br>        <span class="hljs-keyword">while</span> (sum[i] -- )<br>        <span class="hljs-comment">// for (int j = 0; j &lt; sum[i]; j ++ )</span><br>            res = <span class="hljs-built_in">mul</span>(res, primes[i]);<br>            <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = res.<span class="hljs-built_in">size</span>() - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i -- ) <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, res[i]);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&quot;</span>);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-889-满足条件的01序列"><a href="#AcWing-889-满足条件的01序列" class="headerlink" title="AcWing 889. 满足条件的01序列"></a>AcWing 889. 满足条件的01序列</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> LL = <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N =<span class="hljs-number">100010</span>, mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;<br><br><span class="hljs-keyword">int</span> n;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">qmi</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> k, <span class="hljs-keyword">int</span> p)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (k)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (k &amp; <span class="hljs-number">1</span>) res = (LL)res * a % p;<br>        k &gt;&gt;= <span class="hljs-number">1</span>;<br>        a = (LL)a * a % p;<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">int</span> a = <span class="hljs-number">2</span> * n, b = n;<br>    <br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = b, j = a; i &gt;= <span class="hljs-number">1</span>; i --, j -- )<br>    &#123;<br>        res = (LL)res * j % mod;<br>        res = (LL)res * <span class="hljs-built_in">qmi</span>(i, mod - <span class="hljs-number">2</span>, mod) % mod;<br>    &#125;<br>    res = (LL)res * <span class="hljs-built_in">qmi</span>(n + <span class="hljs-number">1</span>, mod - <span class="hljs-number">2</span>, mod) % mod;<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-890-能被整除的数"><a href="#AcWing-890-能被整除的数" class="headerlink" title="AcWing 890. 能被整除的数"></a>AcWing 890. 能被整除的数</h2>容斥原理应用，见得少真的想不到呜呜呜<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> LL = <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">20</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> p[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;p[i]);<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-number">1</span> &lt;&lt; m; i ++ )  <span class="hljs-comment">// 遍历2 ^ m - 1种状态(除全0，即不选集合)</span><br>    &#123;<br>        <span class="hljs-keyword">int</span> t = <span class="hljs-number">1</span>, cnt = <span class="hljs-number">0</span>;  <span class="hljs-comment">// t：选中集合对应质数的积，cnt：选中集合的数量</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; m; j ++ )  <span class="hljs-comment">// 遍历i的每一位二进制数（遍历所有集合的选中状态）</span><br>            <span class="hljs-keyword">if</span> (i &gt;&gt; j &amp; <span class="hljs-number">1</span>)  <span class="hljs-comment">// 若选中集合</span><br>            &#123;<br>                <span class="hljs-keyword">if</span> ((LL)t * p[j] &gt; n)  <span class="hljs-comment">// 若选中集合对应质数的积大于给定整数，说明给定整数中一定没有选中集合对应质数的公倍数。</span><br>                &#123;<br>                    t = <span class="hljs-number">-1</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>                t *= p[j];<br>                cnt ++ ;<br>            &#125;<br>        <br>        <span class="hljs-keyword">if</span> (t != <span class="hljs-number">-1</span>)<br>        &#123;<br>            <span class="hljs-keyword">if</span> (cnt &amp; <span class="hljs-number">1</span>) res += n / t;  <span class="hljs-comment">// 若选中奇数个集合，自增</span><br>            <span class="hljs-keyword">else</span> res -= n / t;  <span class="hljs-comment">// 若选中偶数个集合， 自减</span><br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-891-Nim游戏"><a href="#AcWing-891-Nim游戏" class="headerlink" title="AcWing 891. Nim游戏"></a>AcWing 891. Nim游戏</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">int</span> n;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (n -- )<br>    &#123;<br>        <span class="hljs-keyword">int</span> x;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;x);<br>        res ^= x;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (res) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Yes&quot;</span>);<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;No&quot;</span>);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-892-台阶-Nim游戏"><a href="#AcWing-892-台阶-Nim游戏" class="headerlink" title="AcWing 892. 台阶-Nim游戏"></a>AcWing 892. 台阶-Nim游戏</h2>对于这种问题，可以先模拟 $ n=1, 2, 3, 4, \dots $ 这些简单情况，然后大胆推理（好吧其实我不知道还有什么别的办法）</li></ol><p>$n = 1$时：先手直接将第 $1$ 级台阶上的石子 $a_1$ 拿到第 $0$ 级，先手必胜。<br>$n = 2$时，先手在某一步:</p><ol><li>若 $a_1 = 0$ ，<br> 若 $a_2 = 0$，先手败。<br> 若 $a_2 \neq 0$ ，先手只能将 $a_2$ 减少，$ a_1 $增加，敌手只需不停重复 $n = 1$的情况即可让先手败。 </li><li>若 $a_1 \neq 0$ ，<br> 若 $a_2 = 0$，先手做 $n = 1$ 时情况，先手胜<br> 若 $a_2 \neq 0$ ，先手做 $n = 1$ 时情况，让敌手进入 $a_1 = 0, a_2 \neq 0$的情况，敌手必败，先手必胜。</li></ol><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a);<br>        <span class="hljs-keyword">if</span> (i &amp; <span class="hljs-number">1</span>) res ^= a;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (res) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Yes&quot;</span>);<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;No&quot;</span>);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-893-集合-Nim游戏"><a href="#AcWing-893-集合-Nim游戏" class="headerlink" title="AcWing 893. 集合-Nim游戏"></a>AcWing 893. 集合-Nim游戏</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unordered_set&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">110</span>, M = <span class="hljs-number">10010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> s[N], f[M];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">sg</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">// 记忆化搜索</span><br>    <span class="hljs-keyword">if</span> (~f[x]) <span class="hljs-keyword">return</span> f[x];<br>    <br>    <span class="hljs-comment">// 遍历x可转移至的所有状态，并将其sg值加入集合</span><br>    unordered_set&lt;<span class="hljs-keyword">int</span>&gt; set;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> sub = s[i];<br>        <span class="hljs-keyword">if</span> (x &gt;= sub) set.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">sg</span>(x - sub));<br>    &#125;<br>    <br>    <span class="hljs-comment">// 在集合的补集中找到mex（不在集合中的最小数）</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; ; i ++ )<br>        <span class="hljs-keyword">if</span> (!set.<span class="hljs-built_in">count</span>(i))<br>            <span class="hljs-keyword">return</span> f[x] = i;  <span class="hljs-comment">// 记忆化搜索</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;m);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;s[i]);<br>    <br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> f);<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a);<br>        res ^= <span class="hljs-built_in">sg</span>(a);<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (res) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Yes&quot;</span>);<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;No&quot;</span>);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-894-拆分-Nim游戏"><a href="#AcWing-894-拆分-Nim游戏" class="headerlink" title="AcWing 894. 拆分-Nim游戏"></a>AcWing 894. 拆分-Nim游戏</h2><p>和上一题最大的区别是每个<strong>新状态</strong>不再是单个状态的sg值，而是<strong>拆分出的两个子状态</strong>的sg异或和（SG原理）。<br>因为两堆石子无序，所以我们假设第一堆大于等于第二堆，枚举所有可能的新状态（两个拆分子状态），然后将其sg异或和插入集合。<br><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202203110045503.png" alt=""></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unordered_set&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">110</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> f[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">sg</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (~f[x]) <span class="hljs-keyword">return</span> f[x];<br>    <br>    unordered_set&lt;<span class="hljs-keyword">int</span>&gt; S;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; x; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= i; j ++ )<br>            S.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">sg</span>(i) ^ <span class="hljs-built_in">sg</span>(j));<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; ; i ++ )<br>        <span class="hljs-keyword">if</span> (!S.<span class="hljs-built_in">count</span>(i))<br>            <span class="hljs-keyword">return</span> f[x] = i;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> f);<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a);<br>        res ^= <span class="hljs-built_in">sg</span>(a);<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (res) <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Yes&quot;</span>);<br>    <span class="hljs-keyword">else</span> <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;No&quot;</span>);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="第五讲-动态规划"><a href="#第五讲-动态规划" class="headerlink" title="第五讲 动态规划"></a>第五讲 动态规划</h1><h2 id="背包问题"><a href="#背包问题" class="headerlink" title="背包问题"></a>背包问题</h2><h2 id="Acwing-2-01背包问题"><a href="#Acwing-2-01背包问题" class="headerlink" title="Acwing 2. 01背包问题"></a>Acwing 2. 01背包问题</h2><p>朴素版：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> v[N], w[N];<br><span class="hljs-keyword">int</span> f[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;v[i], &amp;w[i]);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++ )<br>        &#123;<br>            f[i][j] = f[i - <span class="hljs-number">1</span>][j];<br>            <span class="hljs-keyword">if</span> (j &gt;= v[i]) f[i][j] = <span class="hljs-built_in">max</span>(f[i][j], f[i - <span class="hljs-number">1</span>][j - v[i]] + w[i]);<br>        &#125;<br>        <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, f[n][m]);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br>空间优化版（滚动数组）：<br>改写思路：</p><ol><li>将f声明为一维数组</li><li>将f曾经的第一纬度删掉，此时赋值号右侧为”上层”，左侧为”本层”</li><li>去除<code>f[j] = f[j]</code>恒等式，将<code>if (j &gt;= v[i])</code>整合进第二层<code>for</code>循环</li><li>若从左向右更新，当更新右侧格子时，左边格子已经被更新为本层格子而非上层格子，所以将第二层<code>for</code>循环改为从右向左更新<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> v[N], w[N];<br><span class="hljs-keyword">int</span> f[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;v[i], &amp;w[i]);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = m; j &gt;= v[i]; j -- )<br>            f[j] = <span class="hljs-built_in">max</span>(f[j], f[j - v[i]] + w[i]);<br>        <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, f[m]);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li></ol><h2 id="Acwing-3-完全背包问题"><a href="#Acwing-3-完全背包问题" class="headerlink" title="Acwing 3. 完全背包问题"></a>Acwing 3. 完全背包问题</h2><p>朴素版：<br>本题TLE</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> v[N], w[N];<br><span class="hljs-keyword">int</span> f[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;v[i], &amp;w[i]);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= m; j ++ )<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k * v[i] &lt;= j; k ++ )<br>                f[i][j] = <span class="hljs-built_in">max</span>(f[i][j], f[i - <span class="hljs-number">1</span>][j - k * v[i]] + k * w[i]);<br>                <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, f[n][m]);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>“就近转移”优化：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> v[N], w[N];<br><span class="hljs-keyword">int</span> f[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;v[i], &amp;w[i]);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= m; j ++ )<br>        &#123;<br>            f[i][j] = f[i - <span class="hljs-number">1</span>][j];<br>            <span class="hljs-keyword">if</span> (j &gt;= v[i]) f[i][j] = <span class="hljs-built_in">max</span>(f[i][j], f[i][j - v[i]] + w[i]);<br>        &#125;<br>                <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, f[n][m]);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br>滚动数组优化：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> v[N], w[N];<br><span class="hljs-keyword">int</span> f[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;v[i], &amp;w[i]);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = v[i]; j &lt;= m; j ++ )<br>            f[j] = <span class="hljs-built_in">max</span>(f[j], f[j - v[i]] + w[i]);<br>                <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, f[m]);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="Acwing-4-多重背包问题"><a href="#Acwing-4-多重背包问题" class="headerlink" title="Acwing 4. 多重背包问题"></a>Acwing 4. 多重背包问题</h2><p>注意：这里有三重循环，分别是<br>物品序号——当前容量——<strong>物品件数</strong><br>当物品件数变多时，其单独作为一重循环会极大地增加时间复杂度，<br>所以在多包2中，我们将每个物品<strong>构造成</strong>$logs$个物品，他们的体积和价值的系数（件数）呈指数序列$1, 2, 4, 8, \dots, k, c$（最后两项我还没想出来怎么用数学语言表述），本质上就是将其二进制表示然后计算其位权，最后若不能恰好表示则有剩余件数c<br>这样我们就用空间换时间，将其变为了01背包问题，去除了最后一重循环，但第一重循环的范围从$N$增加为$NlogS$<br>总时间复杂度由 $O(n \cdot m \cdot s)$ 变为 $O(nlogs \cdot m)$</p><p>朴素版：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">110</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> v[N], w[N], s[N];<br><span class="hljs-keyword">int</span> f[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d%d&quot;</span>, &amp;v[i], &amp;w[i], &amp;s[i]);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= m; j ++ )<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt;= s[i] &amp;&amp; k * v[i] &lt;= j; k ++ )<br>                f[i][j] = <span class="hljs-built_in">max</span>(f[i][j], f[i - <span class="hljs-number">1</span>][j - k * v[i]] + k * w[i]);<br>                <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, f[n][m]);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="Acwing-5-多重背包问题-II"><a href="#Acwing-5-多重背包问题-II" class="headerlink" title="Acwing 5. 多重背包问题 II"></a>Acwing 5. 多重背包问题 II</h2><p>优化思路写在上一题和朴素做法做对比了<br>空间换时间，位优化版：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">11000</span>, M = <span class="hljs-number">2010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> v[N], w[N], cnt;<br><span class="hljs-keyword">int</span> f[M];  <span class="hljs-comment">// 注意这里就应该是M，前面是因为N和M同范围</span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    cin &gt;&gt; n &gt;&gt; m;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a, b, s;<br>        cin &gt;&gt; a &gt;&gt; b &gt;&gt; s;<br>        <span class="hljs-keyword">int</span> k  = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> (k &lt;= s)<br>        &#123;<br>            cnt ++ ;<br>            v[cnt] = k * a, w[cnt] = k * b;<br>            s -= k;<br>            k &lt;&lt;= <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (s &gt; <span class="hljs-number">0</span>)<br>        &#123;<br>            cnt ++ ;<br>            v[cnt] = s * a, w[cnt] = s * b;<br>        &#125;<br>    &#125;<br>    <br>    n = cnt;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = m; j &gt;= v[i]; j -- )<br>            f[j] = <span class="hljs-built_in">max</span>(f[j], f[j - v[i]] + w[i]);<br>            <br>    cout &lt;&lt; f[m] &lt;&lt; endl;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Acwing-9-分组背包问题"><a href="#Acwing-9-分组背包问题" class="headerlink" title="Acwing 9. 分组背包问题"></a>Acwing 9. 分组背包问题</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">110</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> v[N][N], w[N][N], s[N];<br><span class="hljs-keyword">int</span> f[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>    &#123;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;s[i]);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= s[i]; j ++ )<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;v[i][j], &amp;w[i][j]);<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = m; j &gt;= <span class="hljs-number">0</span>;j -- )<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt;= s[i]; k ++ )<br>                <span class="hljs-keyword">if</span> (v[i][k] &lt;= j) f[j] = <span class="hljs-built_in">max</span>(f[j], f[j - v[i][k]] + w[i][k]);<br>                <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, f[m]);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="线性DP-1"><a href="#线性DP-1" class="headerlink" title="线性DP"></a>线性DP</h2><h2 id="Acwing-898-数字三角形"><a href="#Acwing-898-数字三角形" class="headerlink" title="Acwing 898. 数字三角形"></a>Acwing 898. 数字三角形</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">510</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> f[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0xc0</span>, <span class="hljs-keyword">sizeof</span> f);<br>    <span class="hljs-comment">// for (int i = 0; i &lt;= n; i ++ )</span><br>    <span class="hljs-comment">//     for (int j = 0; j &lt;= i + 1; j ++ )</span><br>    <span class="hljs-comment">//         f[i][j] = -INF;</span><br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= i; j ++ )<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;f[i][j]);<br>            <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= i; j ++ )<br>            f[i][j] = <span class="hljs-built_in">max</span>(f[i][j] + f[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>], f[i][j] + f[i - <span class="hljs-number">1</span>][j]);<br>    <br>    <span class="hljs-keyword">int</span> sum = -INF;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= n; j ++ ) sum = <span class="hljs-built_in">max</span>(sum, f[n][j]);<br>        <br>    cout &lt;&lt; sum &lt;&lt; endl;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Acwing-895-最长上升子序列"><a href="#Acwing-895-最长上升子序列" class="headerlink" title="Acwing 895. 最长上升子序列"></a>Acwing 895. 最长上升子序列</h2><p>不记录转移<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> a[N], f[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i]);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>    &#123;<br>        f[i] = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= i; j ++ )<br>            <span class="hljs-keyword">if</span> (a[j] &lt; a[i])<br>                f[i] = <span class="hljs-built_in">max</span>(f[i], f[j] + <span class="hljs-number">1</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        res = <span class="hljs-built_in">max</span>(res, f[i]);<br>        <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><p>记录转移<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> a[N], f[N], g[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i]);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>    &#123;<br>        f[i] = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= i; j ++ )<br>            <span class="hljs-keyword">if</span> (a[j] &lt; a[i])<br>                <span class="hljs-keyword">if</span> (f[i] &lt; f[j] + <span class="hljs-number">1</span>)<br>                &#123;<br>                    f[i] = f[j] + <span class="hljs-number">1</span>;<br>                    g[i] = j;<br>                &#125;<br>    &#125;<br>    <br>    <span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">if</span> (f[k] &lt; f[i])<br>            k = i;<br>        <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, f[k]);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, len = f[k]; i &lt; len; i ++)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, a[k]);<br>        k = g[k];<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="Acwing-896-最长上升子序列-II"><a href="#Acwing-896-最长上升子序列-II" class="headerlink" title="Acwing 896. 最长上升子序列 II"></a>Acwing 896. 最长上升子序列 II</h2><p>用了和yls相同的思路，但是二分部分采用了<code>lower_bound</code><br>向量q的定义是：<strong>长度为i的严格递增子串中，末尾元素最小为q[i]</strong><br>这样的向量q一定是严格递增的，因为若<code>q[i] &gt;= q[i + 1]</code>，那么q[i + 1]所对应的长度为i + 1的子串的前i个元素所形成的子串的末尾元素 &lt; q[i] &lt; q[i + 1]，与定义矛盾。<br>所以新进来的元素要么加在末尾（接在目前最长的递增子串后），要么替代第一个大于等于它的元素（更新满足q定义的递增子串的末尾），这里的思想是<strong>贪心</strong>：对于同样长度的子串，它的末尾元素越小越好，这样它才有机会接上更多的元素。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N =<span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> a[N];<br>vector&lt;<span class="hljs-keyword">int</span>&gt; q;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i]);<br>    <br>    q.<span class="hljs-built_in">push_back</span>(a[<span class="hljs-number">0</span>]);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">if</span> (a[i] &gt; q.<span class="hljs-built_in">back</span>()) q.<span class="hljs-built_in">push_back</span>(a[i]);<br>        <span class="hljs-keyword">else</span> *<span class="hljs-built_in">lower_bound</span>(q.<span class="hljs-built_in">begin</span>(), q.<span class="hljs-built_in">end</span>(), a[i]) = a[i];<br>    &#125;<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, q.<span class="hljs-built_in">size</span>());<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Acwing-897-最长公共子序列"><a href="#Acwing-897-最长公共子序列" class="headerlink" title="Acwing 897. 最长公共子序列"></a>Acwing 897. 最长公共子序列</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">char</span> a[N], b[N];<br><span class="hljs-keyword">int</span> f[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s%s&quot;</span>, a + <span class="hljs-number">1</span>, b + <span class="hljs-number">1</span>);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>         <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++ )<br>         &#123;<br>             f[i][j] = <span class="hljs-built_in">max</span>(f[i - <span class="hljs-number">1</span>][j], f[i][j - <span class="hljs-number">1</span>]);<br>             <span class="hljs-keyword">if</span> (a[i] == b[j]) f[i][j] = <span class="hljs-built_in">max</span>(f[i][j], f[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>] + <span class="hljs-number">1</span>);<br>         &#125;<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, f[n][m]);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Acwing-902-最短编辑距离"><a href="#Acwing-902-最短编辑距离" class="headerlink" title="Acwing 902. 最短编辑距离"></a>Acwing 902. 最短编辑距离</h2><p>这道题对我而言，lc官方的视频题解更好理解，学习要获取多方资源才行。<br><strong>状态表示</strong>：<code>f[i][j]</code>表示将<code>a[1 .. i]</code>和<code>b[1 .. j]</code>整相等所需要的最小操作数。<br><strong>状态计算</strong>：<br>当遍历到某个<code>f[i][j]</code>时，两段文本的末尾元素有两种情况：</p><ol><li>$a[i] = b[j]$，这时不需要操作这两段文本的末尾元素，直接从他们的前一个转移即可（只要把前面那两段整相等了，那么这两段<strong>无需操作</strong>自然相等），<strong><code>f[i][j] = f[i - 1][j - 1]</code></strong></li><li>$a[i] \neq b[j]$，我们可以进行三种操作，这三种操作分别是：</li></ol><ul><li>删除：<strong>操作1次</strong>，将a的末尾元素<code>a[i]</code>删除，然后把<code>a[1 .. i - 1]</code>和<code>b[1 .. j]</code>整成相等的，这步所需要的最小操作数为<code>f[i - 1][j]</code>，<strong><code>f[i][j] = 1 + f[i - 1][j]</code></strong></li><li>插入：<strong>操作1次</strong>，在a的末尾元素后插入插入一个新元素<code>a[i + 1] = b[j]</code>，这样我们就可以像情况1那样不考虑这两个末尾元素，而是考虑子结构<code>a[1 .. i]</code>和<code>b[1 .. j - 1]</code>，这步所需要的最小操作数为<code>f[i][j - 1]</code>，<strong><code>f[i][j] = 1 + f[i][j - 1]</code></strong></li><li>替换：<strong>操作1次</strong>，将a的末尾元素<code>a[i]</code>替换为<code>b[j]</code>，同样地，就可以不考虑这两个末尾元素，而是考虑子结构<code>a[1 .. i - 1]</code>和<code>b[1 .. j - 1]</code>，这步所需要的最小操作数为<code>f[i - 1][j - 1]</code>，<strong><code>f[i][j] = 1 + f[i - 1][j - 1]</code></strong><br><strong>可以看出这三种情况都是先进行了1步操作，然后再进行将子结构整相等的操作。</strong></li></ul><p>因此我们可以写出这样的状态转移方程：</p><script type="math/tex; mode=display">f[i][j] = \begin{cases}f[i - 1][j - 1] & ,a[i] = b[j] \\\1 + min(f[i - 1][j], f[i][j - 1], f[i - 1][j - 1]) & ,a[i] \neq b[j]\end{cases}</script><p><strong>注意到这里存在<code>[i - 1]</code>这种字样，谨记yxc老师说的，这种情况我们的存储和循环都要从1起，同时要对0行、0列进行初始化</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">char</span> a[N], b[N];<br><span class="hljs-keyword">int</span> f[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%s&quot;</span>, &amp;n, a + <span class="hljs-number">1</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%s&quot;</span>, &amp;m, b + <span class="hljs-number">1</span>);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) f[i][<span class="hljs-number">0</span>] = i;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++ ) f[<span class="hljs-number">0</span>][j] = j;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++ )<br>        &#123;<br>            <span class="hljs-keyword">if</span> (a[i] == b[j]) f[i][j] = f[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>];<br>            <span class="hljs-keyword">else</span> f[i][j] = <span class="hljs-number">1</span> + <span class="hljs-built_in">min</span>(f[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>], <span class="hljs-built_in">min</span>(f[i - <span class="hljs-number">1</span>][j], f[i][j - <span class="hljs-number">1</span>]));<br>            <span class="hljs-comment">// else f[i][j] = 1 + min(f[i - 1][j - 1], f[i - 1][j], f[i][j - 1]);</span><br>        &#125;<br>        <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, f[n][m]);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="Acwing-899-编辑距离"><a href="#Acwing-899-编辑距离" class="headerlink" title="Acwing 899. 编辑距离"></a>Acwing 899. 编辑距离</h2><p>多次使用上一题的算法得到最短编辑距离然后比较、计数即可。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">20</span>, M = <span class="hljs-number">1010</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">char</span> str[M][N];<br><span class="hljs-keyword">int</span> f[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">min_edit_distance</span><span class="hljs-params">(<span class="hljs-keyword">char</span> a[], <span class="hljs-keyword">char</span> b[])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> f);<br>    <br>    <span class="hljs-keyword">int</span> la = <span class="hljs-built_in">strlen</span>(a + <span class="hljs-number">1</span>), lb = <span class="hljs-built_in">strlen</span>(b + <span class="hljs-number">1</span>);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= la; i ++ ) f[i][<span class="hljs-number">0</span>] = i;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;= lb; j ++ ) f[<span class="hljs-number">0</span>][j] = j;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= la; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= lb; j ++ )<br>            <span class="hljs-keyword">if</span> (a[i] == b[j]) f[i][j] = f[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>];<br>            <span class="hljs-keyword">else</span> f[i][j] = <span class="hljs-number">1</span> + <span class="hljs-built_in">min</span>(f[i - <span class="hljs-number">1</span>][j], <span class="hljs-built_in">min</span>(f[i][j - <span class="hljs-number">1</span>], f[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>]));<br>        <br>    <span class="hljs-keyword">return</span> f[la][lb];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, str[i] + <span class="hljs-number">1</span>);<br>    <br>    <span class="hljs-keyword">while</span> (m -- )<br>    &#123;<br>        <span class="hljs-keyword">char</span> tar[N];  <span class="hljs-comment">// target</span><br>        <span class="hljs-keyword">int</span> ub;  <span class="hljs-comment">// upperbound</span><br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s%d&quot;</span>, tar + <span class="hljs-number">1</span>, &amp;ub);<br>        <br>        <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">min_edit_distance</span>(str[i], tar) &lt;= ub) res ++ ;<br>        <br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="区间DP-1"><a href="#区间DP-1" class="headerlink" title="区间DP"></a>区间DP</h2><h2 id="Acwing-282-石子合并"><a href="#Acwing-282-石子合并" class="headerlink" title="Acwing 282. 石子合并"></a>Acwing 282. 石子合并</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">310</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> s[N];<br><span class="hljs-keyword">int</span> f[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;s[i]);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) s[i] += s[i - <span class="hljs-number">1</span>];  <span class="hljs-comment">// highlight</span><br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> len = <span class="hljs-number">2</span>; len &lt;= n; len ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i + len - <span class="hljs-number">1</span> &lt;= n; i ++ )<br>        &#123;<br>            <span class="hljs-keyword">int</span> l = i, r = i + len - <span class="hljs-number">1</span>;<br>            f[l][r] = INF;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = l; k &lt; r; k ++ )<br>                f[l][r] = <span class="hljs-built_in">min</span>(f[l][r], f[l][k] + f[k + <span class="hljs-number">1</span>][r] + s[r] - s[l - <span class="hljs-number">1</span>]);<br>        &#125;<br>        <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, f[<span class="hljs-number">1</span>][n]);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="计数类DP"><a href="#计数类DP" class="headerlink" title="计数类DP"></a>计数类DP</h2><h2 id="Acwing-900-整数划分"><a href="#Acwing-900-整数划分" class="headerlink" title="Acwing 900. 整数划分"></a>Acwing 900. 整数划分</h2><p>这种dp是在其他dp的基础上，计算所有转移的<strong>方案数</strong>，所以转移方程的形式是 $’+’$ 而不是 $’max’$ 或 $’min’$。</p><p>完全背包dp+计数<br>状态表示（最优子结构）：<br><code>f[i][j]</code>：在<code>1 .. i</code>中选，且总和为<code>j</code>的方案的<strong>数</strong><br>状态转移：<br>由<br><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs inform7">f<span class="hljs-comment">[i]</span><span class="hljs-comment">[j]</span> = f<span class="hljs-comment">[i - 1]</span><span class="hljs-comment">[j]</span> + f<span class="hljs-comment">[i - 1]</span><span class="hljs-comment">[j - i]</span> + f<span class="hljs-comment">[i - 1]</span><span class="hljs-comment">[j - i * 2]</span> + ... + f<span class="hljs-comment">[i - 1]</span><span class="hljs-comment">[j - i * s]</span><br>f<span class="hljs-comment">[i]</span><span class="hljs-comment">[j - i]</span>           = f<span class="hljs-comment">[i - 1]</span><span class="hljs-comment">[j - i]</span> + f<span class="hljs-comment">[i - 1]</span><span class="hljs-comment">[j - i * 2]</span> + ... + f<span class="hljs-comment">[i - 1]</span><span class="hljs-comment">[j - i * s]</span><br></code></pre></td></tr></table></figure><br>可得<br><code>f[i][j] = f[i - 1][j] + f[i][j - i]</code><br>采用滚动数组后：<br><code>f[j] = f[j] + f[j - i]</code><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>, mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> f[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    f[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i; j &lt;= n; j ++ )<br>            f[j] = (f[j] + f[j - i]) % mod;<br>            <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, f[n]);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><p>其他dp+计数：<br>状态表示：<br><code>f[i][j]</code>：总和为<code>i</code>，且由<code>j</code>个数表示的方案的<strong>数</strong><br>状态转移：</p><ol><li><code>f[i][j]</code>的最小数是1：将这个最小数1减去，其对应方案数<code>f[i - 1][j - 1]</code></li><li><code>f[i][j]</code>的最小数大于1：将所有数减去1,其对应方案数<code>f[i - j][j]</code></li></ol><p>转移的状态不重不漏，故<br><code>f[i][j] = f[i - 1][j - 1] + f[i - j][j]</code></p><p>结果表示：<br>总方案数即为总和为<code>n</code>，且由任意个数表示的方案，即<code>f[n][1] + f[n][2] + ... + f[n][n]</code><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1010</span>, mod = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> f[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    f[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= i; j ++ )<br>            f[i][j] = (f[i - <span class="hljs-number">1</span>][j - <span class="hljs-number">1</span>] + f[i - j][j]) % mod;<br>            <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) res = (res + f[n][i]) % mod;<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="数位统计DP"><a href="#数位统计DP" class="headerlink" title="数位统计DP"></a>数位统计DP</h2><h2 id="Acwing-338-计数问题"><a href="#Acwing-338-计数问题" class="headerlink" title="Acwing 338. 计数问题"></a>Acwing 338. 计数问题</h2><p>大无语题<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">int</span> a, b;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_sz</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (n)<br>    &#123;<br>        res ++ ;<br>        n /= <span class="hljs-number">10</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">count</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> sz = <span class="hljs-built_in">get_sz</span>(n);<br>    <span class="hljs-comment">// 设整数为abc d efg， d为当前遍历到的数，下标为i</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= sz; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> p = <span class="hljs-built_in">pow</span>(<span class="hljs-number">10</span>, i - <span class="hljs-number">1</span>);  <span class="hljs-comment">// p为efg这几位所能形成的最大值（用来切掉efg段用的）</span><br>        <span class="hljs-keyword">int</span> dl = n / p /<span class="hljs-number">10</span>, di = n / p % <span class="hljs-number">10</span>, dr = n % p;<br>        <span class="hljs-comment">// digit_l：切掉efg段得abcd，再切掉1个10进制位得abc</span><br>        <span class="hljs-comment">// digit_i：切掉efg段得abcd，取最后1个十进制位得成d</span><br>        <span class="hljs-comment">// digit_r：取efg段得efg</span><br>        <br>        <span class="hljs-comment">// 000 &lt; abc段 &lt;= abc - 1</span><br>        <span class="hljs-keyword">if</span> (x) res += dl * p;  <span class="hljs-comment">// x != 0，那么abc段遍历000 .. abc-1，efg段遍历000 .. 999，做笛卡尔积得到abc*1000种方案</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!x &amp;&amp; dl) res += (dl - <span class="hljs-number">1</span>) * p;  <span class="hljs-comment">// x == 0 且 abc段 != 0，那么abc段遍历001 .. abc-1（没有0000efg这种表示方法），efg段遍历000 .. 999，做笛卡尔积得到(abc - 1) * 1000种方案</span><br>        <br>        <span class="hljs-comment">// abc段 == abc</span><br>        <span class="hljs-keyword">if</span> (di &gt; x  &amp;&amp; (x || dl)) res += p;  <span class="hljs-comment">// 第i位数di &gt; x， 那么abc段 = abc， efg段遍历000 .. 999， 做笛卡尔积得到1 * 1000种方案</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (di == x &amp;&amp; (x || dl)) res += dr + <span class="hljs-number">1</span>;  <span class="hljs-comment">// 第i位数di == x， 那么abc段 = abc，efg段遍历000 .. efg，做笛卡尔积得到1 * (efg + 1)种方案</span><br>        <span class="hljs-comment">// 记得限制abc和d不能同时为0</span><br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> res;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b), a || b)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (a &gt; b) <span class="hljs-built_in">swap</span>(a, b);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">9</span>; i ++ )<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, <span class="hljs-built_in">count</span>(b, i) - <span class="hljs-built_in">count</span>(a - <span class="hljs-number">1</span>, i));<br>        <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="状态压缩DP"><a href="#状态压缩DP" class="headerlink" title="状态压缩DP"></a>状态压缩DP</h2><h2 id="Acwing-291-蒙德里安的梦想"><a href="#Acwing-291-蒙德里安的梦想" class="headerlink" title="Acwing 291. 蒙德里安的梦想"></a>Acwing 291. 蒙德里安的梦想</h2><p>这种问题将所有状态压缩为数，一定要分清各个数据结构的维度是状态还是行列！<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> LL = <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">12</span>, M = <span class="hljs-number">1</span> &lt;&lt; N;<br><br><span class="hljs-keyword">int</span> n, m;<br>LL f[N][M];  <span class="hljs-comment">// f[i][j]含义：第i列，状态为j时的可行状态数</span><br><span class="hljs-keyword">bool</span> st[M];  <span class="hljs-comment">// state1</span><br>vector&lt;<span class="hljs-keyword">int</span>&gt; state[M];  <span class="hljs-comment">// state2，state[i][j]：某列状态为i时，其前一列的可行状态j</span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">while</span> (cin &gt;&gt; n &gt;&gt; m, n || m)<br>    &#123;<br>        <span class="hljs-comment">// 预处理可行状态state1（满足奇偶关系）</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1</span> &lt;&lt; n; i ++ )  <span class="hljs-comment">// 所有状态</span><br>        &#123;<br>            <span class="hljs-keyword">int</span> cnt = <span class="hljs-number">0</span>;  <span class="hljs-comment">// 每个0段的大小</span><br>            <span class="hljs-keyword">bool</span> is_valid = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// 假设状态i有效</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n; j ++ )  <span class="hljs-comment">// 用j遍历状态i的每一位数</span><br>                <span class="hljs-keyword">if</span> (i &gt;&gt; j &amp; <span class="hljs-number">1</span>)  <span class="hljs-comment">// i的第j个数为1</span><br>                &#123;<br>                    <span class="hljs-keyword">if</span> (cnt &amp; <span class="hljs-number">1</span>)  <span class="hljs-comment">// 第j个数前面的0段为奇数段</span><br>                    &#123;<br>                        is_valid = <span class="hljs-literal">false</span>;  <span class="hljs-comment">// 状态i不行</span><br>                        <span class="hljs-keyword">break</span>;  <span class="hljs-comment">// 不用看了</span><br>                    &#125;<br>                    <span class="hljs-keyword">else</span> cnt = <span class="hljs-number">0</span>;  <span class="hljs-comment">// 第j个数前面的0段为偶数段。目前可行，接着遍历，对下个0段重新计数</span><br>                &#125;<br>                <span class="hljs-keyword">else</span> cnt ++ ;  <span class="hljs-comment">// i的第j个数为0，0段大小加1</span><br>            <span class="hljs-keyword">if</span> (cnt &amp; <span class="hljs-number">1</span>) is_valid = <span class="hljs-literal">false</span>;  <span class="hljs-comment">// 特判最后一个0段，因为它后面没有1</span><br>            st[i] = is_valid;  <span class="hljs-comment">// 将该状态记录进state1</span><br>        &#125;<br>        <br>        <span class="hljs-comment">// 预处理可行状态state2（满足冲突关系）</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1</span> &lt;&lt; n; i ++ )  <span class="hljs-comment">// 第i列起始小格的状态</span><br>        &#123;<br>            state[i].<span class="hljs-built_in">clear</span>();  <span class="hljs-comment">// 清空，准备装入可行状态</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">1</span> &lt;&lt; n; j ++ )  <span class="hljs-comment">// 第i - 1列插进来的小长方形</span><br>                <span class="hljs-keyword">if</span> ((i &amp; j) == <span class="hljs-number">0</span> &amp;&amp; st[i | j])  <span class="hljs-comment">// 两相邻列无交集（不冲突）且第i - 1列插进来后满足奇偶关系</span><br>                    state[i].<span class="hljs-built_in">push_back</span>(j);  <span class="hljs-comment">// 装入i的可行状态的前一列的可行状态</span><br>        &#125;<br>        <br>        <span class="hljs-comment">// 动态规划</span><br>        <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span> f);<br>        f[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i ++ )  <span class="hljs-comment">// 第i列</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">1</span> &lt;&lt; n; j ++ )  <span class="hljs-comment">// 第i列的状态j</span><br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> k : state[j])  <span class="hljs-comment">// 当第i列状态为j时，i - 1列的可行状态k</span><br>                    f[i][j] += f[i - <span class="hljs-number">1</span>][k];  <span class="hljs-comment">// 把前一列每个可行状态的方案数加入本列本状态的方案数。</span><br>                    <br>        cout &lt;&lt; f[m][<span class="hljs-number">0</span>] &lt;&lt; endl;  <span class="hljs-comment">// 下标为m且没有插到棋盘外的方案数即为最终答案（第一维下标应为0 .. m - 1）</span><br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="Acwing-91-最短Hamilton路径"><a href="#Acwing-91-最短Hamilton路径" class="headerlink" title="Acwing 91. 最短Hamilton路径"></a>Acwing 91. 最短Hamilton路径</h2><p>本题应将状态（走过路径）压缩至第一维度<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">21</span>, M = <span class="hljs-number">1</span> &lt;&lt; N;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> w[N][N];<br><span class="hljs-keyword">int</span> f[M][N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    cin &gt;&gt; n;<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n; j ++ )<br>            cin &gt;&gt; w[i][j];<br>            <br>    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">0x3f</span>, <span class="hljs-keyword">sizeof</span> f);<br>    <br>    f[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;  <span class="hljs-comment">// 初始状态在点0，故第0位是00...01 = 1，第一维度为1，第二维度是0</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1</span> &lt;&lt; n; i ++ )  <span class="hljs-comment">// 枚举所有状态</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; n; j ++ )  <span class="hljs-comment">// 对每个状态枚举所有点j</span><br>            <span class="hljs-keyword">if</span> (i &gt;&gt; j &amp; <span class="hljs-number">1</span>)  <span class="hljs-comment">// 找到一个走过的点j</span><br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt; n; k ++ )  <span class="hljs-comment">// 枚举点j的上一点k</span><br>                    <span class="hljs-keyword">if</span> (i &gt;&gt; k &amp; <span class="hljs-number">1</span>)  <span class="hljs-comment">// 找到一个走过的点k</span><br>                        f[i][j] = <span class="hljs-built_in">min</span>(f[i][j], f[i - (<span class="hljs-number">1</span> &lt;&lt; j)][k] + w[k][j]);  <span class="hljs-comment">//更新经点k走到点j的最短路径的距离（先将点j对应的二进制位减去，代表当前路只走到k的状态，然后获取距离、加上k -&gt; j的距离，然后打擂）</span><br>                        <br>    cout &lt;&lt; f[(<span class="hljs-number">1</span> &lt;&lt; n) - <span class="hljs-number">1</span>][n - <span class="hljs-number">1</span>] &lt;&lt; endl;  <span class="hljs-comment">// 选出Hamilton路径，即状态为全1，即(1 &lt;&lt; n) - 1、重点为n - 1的路径</span><br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="树形DP"><a href="#树形DP" class="headerlink" title="树形DP"></a>树形DP</h2><h2 id="Acwing-285-没有上司的舞会"><a href="#Acwing-285-没有上司的舞会" class="headerlink" title="Acwing 285. 没有上司的舞会"></a>Acwing 285. 没有上司的舞会</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">6010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> h[N], e[N], ne[N], idx;<br><span class="hljs-keyword">int</span> has_father[N];<br><span class="hljs-keyword">int</span> happy[N];<br><span class="hljs-keyword">int</span> f[N][N];<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span></span><br><span class="hljs-function"></span>&#123;<br>    e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span></span><br><span class="hljs-function"></span>&#123;<br>    f[u][<span class="hljs-number">1</span>] = happy[u];<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = h[u]; ~i; i = ne[i])<br>    &#123;<br>        <span class="hljs-keyword">int</span> j = e[i];<br>        <span class="hljs-built_in">dfs</span>(j);<br>        f[u][<span class="hljs-number">1</span>] += f[j][<span class="hljs-number">0</span>];<br>        f[u][<span class="hljs-number">0</span>] += <span class="hljs-built_in">max</span>(f[j][<span class="hljs-number">0</span>], f[j][<span class="hljs-number">1</span>]);<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-built_in">memset</span>(h, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> h);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;happy[i]);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n - <span class="hljs-number">1</span>; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a, b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);<br>        <span class="hljs-built_in">add</span>(b, a);<br>        has_father[a] = <span class="hljs-literal">true</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">int</span> root = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (has_father[root]) root ++ ;<br>    <br>    <span class="hljs-built_in">dfs</span>(root);<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, <span class="hljs-built_in">max</span>(f[root][<span class="hljs-number">0</span>], f[root][<span class="hljs-number">1</span>]));<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="记忆化搜索"><a href="#记忆化搜索" class="headerlink" title="记忆化搜索"></a>记忆化搜索</h2><h2 id="Acwing-901-滑雪"><a href="#Acwing-901-滑雪" class="headerlink" title="Acwing 901. 滑雪"></a>Acwing 901. 滑雪</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">310</span>;<br><br><span class="hljs-keyword">int</span> n, m;<br><span class="hljs-keyword">int</span> h[N][N];<br><span class="hljs-keyword">int</span> f[N][N];<br><br><span class="hljs-keyword">int</span> dx[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>&#125;, dy[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>&#125;;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">dp</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x ,<span class="hljs-keyword">int</span> y)</span>  <span class="hljs-comment">// 这两个参数其实是行、列</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span>&amp; v = f[x][y];<br>    <br>    <span class="hljs-keyword">if</span> (~v) <span class="hljs-keyword">return</span> v;<br>    <br>    v = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a = x + dx[i], b = y + dy[i];<br>        <span class="hljs-keyword">if</span> (a &gt;= <span class="hljs-number">1</span> &amp;&amp; a &lt;= n &amp;&amp; b &gt;= <span class="hljs-number">1</span> &amp;&amp; b &lt;= m &amp;&amp; h[x][y] &gt; h[a][b])  <span class="hljs-comment">// 不知道范围时可以看看下面循环的范围，同一个方向上的新坐标还应在该方向的范围内</span><br>            v = <span class="hljs-built_in">max</span>(v, <span class="hljs-built_in">dp</span>(a, b) + <span class="hljs-number">1</span>);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> v;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);<br>    <br>    <span class="hljs-built_in">memset</span>(f, <span class="hljs-number">-1</span>, <span class="hljs-keyword">sizeof</span> f);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++ )<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;h[i][j]);<br>            <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )  <span class="hljs-comment">// 看这里的范围</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">1</span>; j &lt;= m; j ++ )<br>            res = <span class="hljs-built_in">max</span>(res, <span class="hljs-built_in">dp</span>(i, j));<br>            <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="第六讲-贪心"><a href="#第六讲-贪心" class="headerlink" title="第六讲 贪心"></a>第六讲 贪心</h1><h2 id="区间问题"><a href="#区间问题" class="headerlink" title="区间问题"></a>区间问题</h2><h2 id="AcWing-905-区间选点"><a href="#AcWing-905-区间选点" class="headerlink" title="AcWing 905. 区间选点"></a>AcWing 905. 区间选点</h2><p>贪心策略：</p><ol><li>将所有区间按右端点非降序排序</li><li>遍历所有区间</li></ol><ul><li>若当前区间中已包含点，pass</li><li>若当前区间不包含点，在其右端点加一个点<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Range</span></span><br><span class="hljs-class">&#123;</span><br>    <span class="hljs-keyword">int</span> l, r;<br>    <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span>&lt; (<span class="hljs-keyword">const</span> Range &amp;W) <span class="hljs-keyword">const</span><br>    &#123;<br>        <span class="hljs-keyword">return</span> r &lt; W.r;<br>    &#125;<br>&#125;range[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a, b;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);<br>        range[i] = &#123;a, b&#125;;<br>    &#125;<br>    <br>    <span class="hljs-built_in">sort</span>(range, range + n);<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> ed = -INF;  <span class="hljs-comment">// 当前最优区间（右端点被尽可能多的区间包含的区间）的右端点，同时也是最新加的点的坐标</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>    &#123;<br>        Range rg = range[i];<br>        <span class="hljs-keyword">if</span> (ed &lt; rg.l)<br>        &#123;<br>            res ++ ;  <span class="hljs-comment">// 加入一个点</span><br>            ed = rg.r;  <span class="hljs-comment">// 将该区间选为最优区间，更新最优右端点</span><br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h2 id="AcWing-908-最大不相交区间数量"><a href="#AcWing-908-最大不相交区间数量" class="headerlink" title="AcWing 908. 最大不相交区间数量"></a>AcWing 908. 最大不相交区间数量</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Range</span></span><br><span class="hljs-class">&#123;</span><br>    <span class="hljs-keyword">int</span> l, r;<br>    <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span>&lt; (<span class="hljs-keyword">const</span> Range&amp; W) <span class="hljs-keyword">const</span><br>    &#123;<br>        <span class="hljs-keyword">return</span> r &lt; W.r;<br>    &#125;<br>&#125;range[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    cin &gt;&gt; n;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a, b;<br>        cin &gt;&gt; a &gt;&gt; b;<br>        range[i] = &#123;a, b&#125;;<br>    &#125;<br>    <br>    <span class="hljs-built_in">sort</span>(range, range + n);<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> ed = -INF;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">if</span> (range[i].l &gt; ed)<br>        &#123;<br>            res ++ ;<br>            ed = range[i].r;<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-906-区间分组"><a href="#AcWing-906-区间分组" class="headerlink" title="AcWing 906. 区间分组"></a>AcWing 906. 区间分组</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Range</span></span><br><span class="hljs-class">&#123;</span><br>    <span class="hljs-keyword">int</span> l, r;<br>    <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span>&lt; (<span class="hljs-keyword">const</span> Range&amp; W) <span class="hljs-keyword">const</span><br>    &#123;<br>        <span class="hljs-keyword">return</span> l &lt; W.l;<br>    &#125;<br>&#125;range[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> l, r;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);<br>        range[i] = &#123;l, r&#125;;<br>    &#125;<br>    <br>    <span class="hljs-built_in">sort</span> (range, range + n);<br>    <br>    priority_queue&lt;<span class="hljs-keyword">int</span>, vector&lt;<span class="hljs-keyword">int</span>&gt;, greater&lt;<span class="hljs-keyword">int</span>&gt;&gt; ed_heap;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>    &#123;<br>        Range rg = range[i];<br>        <span class="hljs-keyword">if</span> (ed_heap.<span class="hljs-built_in">empty</span>() || ed_heap.<span class="hljs-built_in">top</span>() &gt;= rg.l) ed_heap.<span class="hljs-built_in">push</span>(rg.r);<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>            ed_heap.<span class="hljs-built_in">pop</span>();<br>            ed_heap.<span class="hljs-built_in">push</span>(rg.r);<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, ed_heap.<span class="hljs-built_in">size</span>());<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="AcWing-907-区间覆盖"><a href="#AcWing-907-区间覆盖" class="headerlink" title="AcWing 907. 区间覆盖"></a>AcWing 907. 区间覆盖</h2><p>贪心策略：</p><ol><li>将所有区间按左端点非降序排序</li><li>遍历区间，每次：在所有能覆盖st的区间中选择右端点最大的那个区间，然后将这个右端点更新为新的st（每次都覆盖从左边st起 连续的 尽可能多的 长度）<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Range</span></span><br><span class="hljs-class">&#123;</span><br>    <span class="hljs-keyword">int</span> l, r;<br>    <span class="hljs-keyword">bool</span> <span class="hljs-keyword">operator</span>&lt; (<span class="hljs-keyword">const</span> Range&amp; W) <span class="hljs-keyword">const</span><br>    &#123;<br>        <span class="hljs-keyword">return</span> l &lt; W.l;<br>    &#125;<br>&#125;range[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> st, ed;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;st, &amp;ed);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> l, r;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;l, &amp;r);<br>        range[i] = &#123;l, r&#125;;<br>    &#125;<br>    <br>    <span class="hljs-built_in">sort</span>(range, range + n);<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">bool</span> success = <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> j = i, r = -INF;<br>        <span class="hljs-keyword">while</span> (j &lt; n &amp;&amp; range[j].l &lt;= st)<br>        &#123;<br>            r = <span class="hljs-built_in">max</span>(r, range[j].r);<br>            j ++ ;<br>        &#125;<br>        <br>        <span class="hljs-keyword">if</span> (r &lt; st) <span class="hljs-keyword">break</span>;<br>        <br>        res ++ ;<br>        <span class="hljs-keyword">if</span> (r &gt;= ed)  <span class="hljs-comment">// 只有进入这里才是找到了</span><br>        &#123;<br>            success = <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <br>        st = r;<br>        i = j - <span class="hljs-number">1</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span> (!success) res = <span class="hljs-number">-1</span>;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></li></ol><h2 id="Huffman树"><a href="#Huffman树" class="headerlink" title="Huffman树"></a>Huffman树</h2><h2 id="AcWing-148-合并果子"><a href="#AcWing-148-合并果子" class="headerlink" title="AcWing 148. 合并果子"></a>AcWing 148. 合并果子</h2><p>这个题没有要求合并两堆的位置必须相邻，所以可以直接贪心（每次合并所需的体力最小）。另外贪心一般是局部最优解，但这个应该是全局最优解。<br>若要求了相邻，那么只能动态规划。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;queue&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">10010</span>;<br><br><span class="hljs-keyword">int</span> n;<br>priority_queue&lt;<span class="hljs-keyword">int</span>, vector&lt;<span class="hljs-keyword">int</span>&gt;, greater&lt;<span class="hljs-keyword">int</span>&gt;&gt; heap;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> a;<br>        cin &gt;&gt; a;<br>        heap.<span class="hljs-built_in">push</span>(a);<br>    &#125;<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (heap.<span class="hljs-built_in">size</span>() &gt; <span class="hljs-number">1</span>)<br>    &#123;<br>        <span class="hljs-keyword">int</span> a = heap.<span class="hljs-built_in">top</span>(); heap.<span class="hljs-built_in">pop</span>();<br>        <span class="hljs-keyword">int</span> b = heap.<span class="hljs-built_in">top</span>(); heap.<span class="hljs-built_in">pop</span>();<br>        <span class="hljs-keyword">int</span> c = a + b;<br>        res += c;<br>        heap.<span class="hljs-built_in">push</span>(c);<br>    &#125;<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="排序不等式"><a href="#排序不等式" class="headerlink" title="排序不等式"></a>排序不等式</h2><h2 id="AcWing-913-排队打水"><a href="#AcWing-913-排队打水" class="headerlink" title="AcWing 913. 排队打水"></a>AcWing 913. 排队打水</h2><p>上课讲了挺多遍，但是没有证明<br>当打水时间数组（非严格）单调递增时，总打水时间最小<br>$proof:$<br>假设打水时间数组不单调递增，即存在某个 $i$ 使得 $t<em>i &gt; t</em>{i + 1}$ （单调递减）时，总打水时间更小。<br>那么二者之后（含）的打水总时间为<br>$t<em>{减} = t_i * (n - i) + t</em>{i + 1} <em> (n - i - 1)$<br>若将其交换，二者单调递增后，二者之后（含）的打水总时间为<br>$t<em>{增} = t</em>{i + 1} </em> (n - i) + t_i * (n - i - 1)$</p><p>那么：</p><script type="math/tex; mode=display">t_{减} - t_{增} = t_i - t_{i + 1} > 0</script><script type="math/tex; mode=display">t_{减} > t_{增}</script><p>与假设自身矛盾，故不存在$t<em>i &gt; t</em>{i + 1}$ （单调递减）时，总打水时间最小。<br>$Q.E.D$</p><p>ps. 贪心算法的证明一般采用<strong>反证法</strong>、<strong>同时满足$\leq$和$\geq$</strong>、<strong>数学归纳法</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> LL = <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> a[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i]);<br>    <br>    <span class="hljs-built_in">sort</span>(a, a + n);<br>    <br>    LL res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>        res += a[i] * (n - i - <span class="hljs-number">1</span>);<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> LL = <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> a[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i]);<br>    <br>    <span class="hljs-built_in">sort</span>(a + <span class="hljs-number">1</span>, a + n + <span class="hljs-number">1</span>);<br>    <br>    LL res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i ++ )<br>        res += a[i] * (n - i);<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><br><strong>第二种表示方法</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> LL = <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> a[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i]);<br>    <br>    <span class="hljs-built_in">sort</span>(a, a + n);<br>    <span class="hljs-built_in">reverse</span>(a, a + n);<br>    <br>    LL res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) res += a[i] * i;  <span class="hljs-comment">// 把要等着i的人放在前面存储，这样表示方便</span><br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="绝对值不等式"><a href="#绝对值不等式" class="headerlink" title="绝对值不等式"></a>绝对值不等式</h2><h2 id="AcWing-104-货仓选址"><a href="#AcWing-104-货仓选址" class="headerlink" title="AcWing 104. 货仓选址"></a>AcWing 104. 货仓选址</h2><p><strong>中位数</strong>，考试扣了我15分的题。<br>排序不等式：<br>对于升序序列 $\{x_i\}$</p><script type="math/tex; mode=display">d = |x_1 - x| + |x_2 - x| + \dots + |x_n - x|  \\\= (|x_1 - x| + |x_n - x|) + (|x_2 - x| + |x_{n - 1} - x|) + \dots</script><p>引理：</p><script type="math/tex; mode=display">|a - x| + |b - x| \geq |b - a|，当且仅当 a \leq x \leq b 时等号成立</script><p>那么：</p><script type="math/tex; mode=display">d \geq (x_n - x_1) + (x_{n - 1} - x_2) + \dots，当且仅当 x 在每对数中间时等号成立</script><p>所以，<br>若 $n$ 为奇数，则 $x$ 为中位数时，$d$ 最小<br>若 $n$ 为偶数，则 $x$ 在中位数对所形成的闭区间中时，$d$ 最小</p><p>二维最短曼哈顿距离：因坐标轴独立，故可以分别计算相加<br><strong>二维最短欧几里得距离：费马点</strong><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">100010</span>;<br><br><span class="hljs-keyword">int</span> n;<br><span class="hljs-keyword">int</span> a[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;a[i]);<br>    <br>    <span class="hljs-built_in">sort</span>(a, a + n);<br>    <br>    <span class="hljs-keyword">int</span> res = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ ) res += <span class="hljs-built_in">abs</span>(a[i] - a[n / <span class="hljs-number">2</span>]);<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure></p><h2 id="推公式"><a href="#推公式" class="headerlink" title="推公式"></a>推公式</h2><h2 id="AcWing-125-耍杂技的牛"><a href="#AcWing-125-耍杂技的牛" class="headerlink" title="AcWing 125. 耍杂技的牛"></a>AcWing 125. 耍杂技的牛</h2><p>推公式（感觉是猜公式hh）<br><del>叠牛汉：</del><br>题目给出：</p><script type="math/tex; mode=display">风险值 = w前缀和 - s</script><p>那么自然想到两个变量分别的排放顺序：</p><ol><li>$w$ 轻的放上面、$w$ 重的放下面</li><li>$s$ 小的放上面、$s$ 大的放下面</li></ol><p>那么需要找到一个公式把他们综合起来然后按其贪心。<br>（猜一个权重相等的形式： $w+s$，越大越往下放）<br><strong>贪心策略：将所有牛按$w + s$非降序排序所得到的 最高风险值 最小</strong><br>（想个办法证明它对。）</p><p>$proof:$</p><p>假设$w + s$不单调递增，即存在某个 $i$ 使得 $w<em>i + s</em>{i} &gt; w<em>{i + 1} + s</em>{i +1} $ （单调递减）时，最大风险值更小。</p><p>那么：</p><div class="table-container"><table><thead><tr><th style="text-align:center">状态\风险值\牛</th><th style="text-align:center">i</th><th style="text-align:center">i + 1</th></tr></thead><tbody><tr><td style="text-align:center">交换前（降序）</td><td style="text-align:center">$\sum_{i = 1}^{i - 1}w_i - s_i$</td><td style="text-align:center">$\sum<em>{i = 1}^{i}w_i - s</em>{i +1}$</td></tr><tr><td style="text-align:center">交换后（升序）</td><td style="text-align:center">$\sum<em>{i = 1}^{i - 1}w_i - s</em>{i + 1}$</td><td style="text-align:center">$\sum<em>{i = 1}^{i - 1}w_i + w</em>{i + 1} - s_i$</td></tr></tbody></table></div><p>因我们想知道交换前后二者最大危险值的<strong>相对大小</strong>，所以可以同时先化简他们</p><p>$ - \sum_{i = 1}^{i - 1}w_i$，有：</p><div class="table-container"><table><thead><tr><th style="text-align:center">状态\风险值\牛</th><th style="text-align:center">i</th><th style="text-align:center">i + 1</th></tr></thead><tbody><tr><td style="text-align:center">交换前（降序）</td><td style="text-align:center">$ - s_i$</td><td style="text-align:center">$w<em>i - s</em>{i +1}$</td></tr><tr><td style="text-align:center">交换后（升序）</td><td style="text-align:center">$ - s_{i + 1}$</td><td style="text-align:center">$w_{i + 1} - s_i$</td></tr></tbody></table></div><p>$+(s<em>i +s</em>{i +1})$，有：</p><div class="table-container"><table><thead><tr><th style="text-align:center">状态\风险值\牛</th><th style="text-align:center">i</th><th style="text-align:center">i + 1</th></tr></thead><tbody><tr><td style="text-align:center">交换前（降序）</td><td style="text-align:center">$ s_{i + 1}$</td><td style="text-align:center">$w<em>i + s</em>{i}$</td></tr><tr><td style="text-align:center">交换后（升序）</td><td style="text-align:center">$ s_{i} $</td><td style="text-align:center">$w<em>{i + 1} + s</em>{i +1}$</td></tr></tbody></table></div><p>因为</p><script type="math/tex; mode=display">w_i + s_{i} > s_{i}\ and\ w_i + s_{i} > w_{i + 1} + s_{i +1}</script><p>所以</p><script type="math/tex; mode=display">w_i + s_{i} > max(s_i, w_{i + 1} + s_{i +1})</script><script type="math/tex; mode=display">max(s_{i + 1}, w_i + s_{i}) > max(s_i, w_{i + 1} + s_{i +1})</script><p>即降序的最大风险值更大，与假设矛盾。</p><p>故原命题成立</p><p>$Q.E.D$</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> PII = pair&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>&gt;;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">50010</span>, INF = <span class="hljs-number">0x3f3f3f3f</span>;<br><br><span class="hljs-keyword">int</span> n;<br>PII cows[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">int</span> w, s;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>, &amp;w, &amp;s);<br>        cows[i] = &#123;w + s, s&#125;;<br>    &#125;<br>    <br>    <span class="hljs-built_in">sort</span>(cows, cows + n);<br>    <br>    <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>, res = -INF;  <span class="hljs-comment">// w前缀和，最大风险值</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i ++ )<br>    &#123;<br>        <span class="hljs-keyword">auto</span> cow = cows[i];<br>        <span class="hljs-keyword">int</span> s = cow.second, w = cow.first - s;<br>        res = <span class="hljs-built_in">max</span>(res, sum - s);<br>        sum += w;<br>    &#125;<br>    <br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>算法竞赛</category>
      
    </categories>
    
    
    <tags>
      
      <tag>算法</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>深度学习之路</title>
    <link href="/2022/01/22/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/"/>
    <url>/2022/01/22/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/</url>
    
    <content type="html"><![CDATA[<h2 id="明确概念"><a href="#明确概念" class="headerlink" title="明确概念"></a>明确概念</h2><h3 id="人工智能、机器学习、深度学习"><a href="#人工智能、机器学习、深度学习" class="headerlink" title="人工智能、机器学习、深度学习"></a>人工智能、机器学习、深度学习</h3><p>人工智能是研究、开发用于模拟、延伸和扩展人的智能的理论、方法、技术及应用系统的一门技术科学。</p><p>机器学习是使计算机具有智能的一类算法，如神经网络算法。</p><p>深度学习是机器学习中一种基于对数据进行表征学习的算法，可认为是改良版的神经网络算法。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201201010779.png" alt="一图流"></p><h3 id="mxnet、pytorch、tensorflow"><a href="#mxnet、pytorch、tensorflow" class="headerlink" title="mxnet、pytorch、tensorflow"></a>mxnet、pytorch、tensorflow</h3><p>待补充</p><h3 id="AnaConda、Conda、MiniConda"><a href="#AnaConda、Conda、MiniConda" class="headerlink" title="AnaConda、Conda、MiniConda"></a>AnaConda、Conda、MiniConda</h3><p>待补充</p><h2 id="关于conda"><a href="#关于conda" class="headerlink" title="关于conda"></a>关于conda</h2><p>虽说，学习一样知识不应过于关注其以外的内容，就像学习编程语言不应过于关注IDE，能跑就行，学习深度学习，也不应过于关注环境，同样能跑就行。</p><p>但我有强迫症，研究conda到底是个什么东西，要从这个Warning说起。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221004567.png" alt=""></p><p>google查询发现是pytorch和CUDA的版本兼容问题，需要cudatoolkit=11.3，但</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221007700.png" alt=""></p><p>我的虚拟环境装的CUDA版本就是11.3，所以它可能用了我base环境里的10.3的CUDA。</p><p>问题引入完毕，我们先来看看conda到底是什么</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221031685.png" alt=""></p><p>Conda 是一个开源包管理系统和环境管理系统。</p><p>可见Conda是pip功能的一个超集，不只可以管理包、还可以管理环境。</p><p>那让我们看看Conda所管理的环境，事实上这个目录是Conda的base环境。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221123760.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221133818.png" alt=""></p><p>再看看python环境</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221124861.png" alt=""></p><p>可以看到，Conda环境确实是python环境的超集。</p><p>再来看看Conda所管理的其他环境，进入<code>~\envs</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221138279.png" alt=""></p><p>除Conda自带的base环境外，我还创建了两个Conda环境：<code>gluon</code>和<code>myenv</code></p><p>进入myenv看看</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221139607.png" alt=""></p><p>可见也是python环境的超集。</p><p>那么为了区分二者，我们可以简单地认为Conda环境不是python环境，它包含的功能比python环境要多。</p><p>接下来介绍一下两种环境如何安装包。</p><p>python环境下，python官方推荐使用pip进行包管理。</p><p>接下来插入一下多个python环境并存的情况。</p><p>当系统中有多个python环境时，比如我有一个python3.9，一个python3.10（下面那个估计是微软自己装的依赖）。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221507668.png" alt=""></p><p>它优先使用的python环境是在系统环境变量中靠上的那个</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221510126.png" alt=""></p><p>如图，在系统环境变量中python39比python310靠上，所以在命令行中操作时若输入了二者环境中都有的程序时，会优先使用上面环境中的程序。</p><p>下面以pip程序来举个例子</p><p>先来看看两个python环境下的pip程序都有哪些</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221515550.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221025665.png" alt=""></p><p>接下来试着调用一下这些程序</p><p>当调用两个环境下独有的程序时，使用相应的环境。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221516087.png" alt=""></p><p>当调用两个环境下共有的程序时，使用系统环境变量中靠上的环境。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221516247.png" alt=""></p><p>那么Conda命令行的pip呢？</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221521574.png" alt=""></p><p>可以看出这个现象是等价于在我们的python环境变量上方加入了Conda环境。</p><p>这样，直接使用pip就会往Conda环境里下载包（装程序）。</p><p>同样地，在哪个Conda环境下使用pip，就会往哪个Conda环境里下载包。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221525795.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221526158.png" alt=""></p><p><code>conda</code>命令自不用说，也是往自己的环境里下载包（激活不同的Conda环境一试便知）</p><p>既然在Conda命令行下<code>conda install SomePackage</code> 和<code>pip install SomePackage</code>是往同一个地方下载包，那么他们有什么区别吗？</p><p>以下引自其他博客。</p><p>pip是用来安装python包的，安装的是python wheel或者源代码的包。从源码安装的时候需要有编译器的支持，pip也不会去支持python语言之外的依赖项。</p><p>conda是用来安装conda package，虽然大部分conda包是python的，但它支持了不少非python语言写的依赖项，比如mkl cuda这种c c++写的包。然后，conda安装的都是编译好的二进制包，不需要你自己编译。所以，pip有时候系统环境没有某个编译器可能会失败，conda不会。这导致了conda装东西的体积一般比较大，尤其是mkl这种，动不动几百兆甚至一G多。</p><p>conda和pip对于环境依赖的处理不同，总体来讲，conda比pip更加严格，conda会检查当前环境下所有包之间的依赖关系，pip可能对之前安装的包就不管了。这样做的话，conda基本上安上了就能保证工作，pip有时候可能装上了也不work。</p><p>这个我比较有感触，比如cudatoolkit它是一个C++库，就只能用<code>conda install cudatoolkit=11.3</code>，而不能用<code>pip install cudatoolkit==11.3</code>，注意一点微小的区别，<code>conda install SomePackage</code> 指定版本时要用<code>=</code>，而<code>pip install SomePackage</code>指定版本时要用<code>==</code>。</p><p>另外，pip还可以指定版本的上下界，如<code>pip install &#39;SomePackage&gt;=1.0.4&#39;</code>。（能不能同时指定还未知）</p><p>conda应该也能，暂时用不到就懒得测试了，再说。</p><p>另外，我说了半天的<code>cudatoolkit</code>和NVIDIA的<code>CUDA</code>是一回事吗？</p><p>不是，<code>cudatoolkit</code>可以理解为<code>CUDA</code>在深度学习场景下的最小安装，只包含了CUDA中的动态链接库，这样就足以支持深度学习框架。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221548540.png" alt=""></p><p>确实就只有库。</p><p>装好了，爽。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221912550.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221914084.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201221912187.png" alt=""></p><h2 id="jupyter-notebook、jupyter-lab的优雅启动方式"><a href="#jupyter-notebook、jupyter-lab的优雅启动方式" class="headerlink" title="jupyter notebook、jupyter lab的优雅启动方式"></a>jupyter notebook、jupyter lab的优雅启动方式</h2><ol><li><p>生成配置文件</p><p><code>jupyter notebook --generate-config</code></p></li><li><p>改两行代码，去掉注释使其生效</p><p>改默认路径</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">c.NotebookApp.notebook_dir = <span class="hljs-string">r&#x27;E:\d2l-zh-2.0-pytorch&#x27;</span><br></code></pre></td></tr></table></figure><p>改默认浏览器</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">c.NotebookApp.browser = <span class="hljs-string">&#x27;C:/Program Files (x86)/Microsoft/Edge/Application/msedge.exe %s&#x27;</span><br></code></pre></td></tr></table></figure></li><li><p>把快捷方式拷到桌面上</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201222321111.png" alt=""></p><p>这个快捷方式可以在开始菜单找到</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201222323816.png" alt=""></p><p>但是怎么创建的我给忘了。。</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>机器学习</category>
      
      <category>深度学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>深度学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JAVA Open EXAM Study</title>
    <link href="/2022/01/09/JAVA-Open-EXAM-Study/"/>
    <url>/2022/01/09/JAVA-Open-EXAM-Study/</url>
    
    <content type="html"><![CDATA[<h1 id="JAVA-Open-EXAM-Study"><a href="#JAVA-Open-EXAM-Study" class="headerlink" title="JAVA Open EXAM Study"></a>JAVA Open EXAM Study</h1><h2 id="Chap1-概述"><a href="#Chap1-概述" class="headerlink" title="Chap1 概述"></a>Chap1 概述</h2><h3 id="开发环境配置、环境变量、系统变量、编译是哪个、虚拟机是哪个？"><a href="#开发环境配置、环境变量、系统变量、编译是哪个、虚拟机是哪个？" class="headerlink" title="开发环境配置、环境变量、系统变量、编译是哪个、虚拟机是哪个？"></a>开发环境配置、环境变量、系统变量、编译是哪个、虚拟机是哪个？</h3><p>JAVA_HOME：JAVA安装目录</p><p><strong>PATH：%JAVA_HOME%\bin</strong></p><p>CLASSPATH：用户级类库</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071139160.png" alt=""></p><p>编译程序：JDK（含javac.exe和java.exe）</p><p>运行程序：JRE（含java.exe）</p><p>虚拟机：JVM</p><p>关系：</p><ol><li><p>JVM+核心类库(lib/*.jar)=JRE</p></li><li><p>JDK&gt;JRE&gt;JVM</p></li></ol><h3 id="源文件后缀、中间字节码后缀？"><a href="#源文件后缀、中间字节码后缀？" class="headerlink" title="源文件后缀、中间字节码后缀？"></a>源文件后缀、中间字节码后缀？</h3><p>.java</p><p>.class</p><h3 id="源文件命名？编译后出现几个字节码？"><a href="#源文件命名？编译后出现几个字节码？" class="headerlink" title="源文件命名？编译后出现几个字节码？"></a>源文件命名？编译后出现几个字节码？</h3><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071135270.png" alt=""></p><p>关于2）：内部类也会生成class字节码文件，若为匿名内部类，则<code>文件名=&quot;外部类&quot;+&quot;$&quot;+num（该外部类的第几个内部类）+&quot;.class&quot;</code></p><h2 id="Chap2、3-语法"><a href="#Chap2、3-语法" class="headerlink" title="Chap2、3 语法"></a>Chap2、3 语法</h2><h3 id="用户标识符命名规则？"><a href="#用户标识符命名规则？" class="headerlink" title="用户标识符命名规则？"></a>用户标识符命名规则？</h3><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071452570.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071508222.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071510806.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071510931.png" alt="is me"></p><h3 id="基本数据类型？类型转换？"><a href="#基本数据类型？类型转换？" class="headerlink" title="基本数据类型？类型转换？"></a>基本数据类型？类型转换？</h3><p>8中基本数据类型及其存储需求、默认值。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071458249.png" alt=""></p><p>类型转换：</p><ol><li>隐式转换（自动转换）</li></ol><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071456962.png" alt=""></p><p>更精确的隐式类型转换图</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071514399.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071537459.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071543526.png" alt=""></p><ol><li>强制转换</li></ol><p><code>(类型名)转换数值</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071538863.png" alt=""></p><h3 id="数据作用域、初始化？"><a href="#数据作用域、初始化？" class="headerlink" title="数据作用域、初始化？"></a>数据作用域、初始化？</h3><p>成员变量：编译器</p><p>形参：实参</p><p>局部变量、块变量：用户</p><p>数组初始化：基本数据类型为各自默认初始值，对象（Object）类型为null</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071532268.png" alt=""></p><h3 id="运算符？"><a href="#运算符？" class="headerlink" title="运算符？"></a>运算符？</h3><p>优先级：单目 &gt; <strong>算术</strong> &gt; 移位 &gt; <strong>关系</strong> &gt; <strong>逻辑</strong> &gt; 三目 &gt; 赋值</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071527958.png" alt="image-20220107152753858"></p><h3 id="参数传递？（函数栈帧）"><a href="#参数传递？（函数栈帧）" class="headerlink" title="参数传递？（函数栈帧）"></a><strong>参数传递</strong>？（函数栈帧）</h3><ol><li>画出主调方法和被调方法的栈帧，其中含有引用或值（基本数据类型）</li><li>画出堆（new出来的对象变量放这）或常量池（直接在代码中给出的变量放这，重复变量只放一个）</li><li>画出箭头将引用指向对应的变量</li><li>分析</li></ol><p>static执行的时机</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201091109699.png" alt=""></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.exam.grammar;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test3</span> </span>&#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> staticVar;<br>    <span class="hljs-keyword">int</span> instanceVar;<br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setStaticVar</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span></span>&#123;<br>        staticVar=i;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setVar</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span></span>&#123;<br>        staticVar=i;<br>        instanceVar=i;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;staticVar=&quot;</span>+Test3.staticVar);<br>        setStaticVar(<span class="hljs-number">11</span>);<br>        System.out.println(<span class="hljs-string">&quot;staticVar=&quot;</span>+Test3.staticVar);<br>        Test3 test3=<span class="hljs-keyword">new</span> Test3();<br>        test3.setVar(<span class="hljs-number">13</span>);<br>        System.out.println(<span class="hljs-string">&quot;staticVar=&quot;</span>+Test3.staticVar);<br>        System.out.println(<span class="hljs-string">&quot;test3&#x27;s instanceVar=&quot;</span>+test3.instanceVar);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">staticVar</span>=0<br><span class="hljs-attribute">staticVar</span>=11<br><span class="hljs-attribute">staticVar</span>=13<br>test3<span class="hljs-string">&#x27;s instanceVar=13</span><br></code></pre></td></tr></table></figure><h2 id="Chap4-面向对象"><a href="#Chap4-面向对象" class="headerlink" title="Chap4 面向对象"></a>Chap4 面向对象</h2><h3 id="访问权限修饰符？非访问权限修饰符？"><a href="#访问权限修饰符？非访问权限修饰符？" class="headerlink" title="访问权限修饰符？非访问权限修饰符？"></a>访问权限修饰符？非访问权限修饰符？</h3><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071617524.png" alt=""></p><h3 id="继承？多态？覆盖？重载？"><a href="#继承？多态？覆盖？重载？" class="headerlink" title="继承？多态？覆盖？重载？"></a>继承？多态？覆盖？重载？</h3><p>子类可以继承父类的所有成员，但被<code>private</code>修饰的成员是不可见的。</p><p>在继承机制中，不允许在子类中降低成员(包括变量和方法)的访问权限。</p><p>如果子类中新定义的静态成员变量与父类中的某个静态成员变量同名，则这两个静态成员变量相互独立。</p><p>编译时类型由声明该变量时使用的类型（引用的类型）决定</p><p>运行时类型由实际赋给该变量的对象的类型（实例的类型）决定。</p><p><strong>因为有编译时类型的限制，所以变量所调用的方法只能来自编译时类型的方法</strong></p><p>覆盖：函数原型完全一致，即返回值类型、方法名、参数列表</p><p>重载：方法名相同而参数列表不同</p><h3 id="对象初始化-实例化过程？（作业二）"><a href="#对象初始化-实例化过程？（作业二）" class="headerlink" title="对象初始化/实例化过程？（作业二）"></a>对象初始化/实例化过程？（作业二）</h3><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201071715394.png" alt=""></p><p>注：1处不准确，若是第一次加载类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.exam.oop;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *    控制台打印</span><br><span class="hljs-comment"> */</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Log</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">baseFieldInit</span><span class="hljs-params">()</span></span>&#123;System.out.println(<span class="hljs-string">&quot;Base Normal Field&quot;</span>);<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">baseStaticFieldInit</span><span class="hljs-params">()</span></span>&#123;System.out.println(<span class="hljs-string">&quot;Base Static Field&quot;</span>);<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">fieldInit</span><span class="hljs-params">()</span></span>&#123;System.out.println(<span class="hljs-string">&quot;Normal Field&quot;</span>);<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">staticFieldInit</span><span class="hljs-params">()</span></span>&#123;System.out.println(<span class="hljs-string">&quot;Static Field&quot;</span>);<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;&#125;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *基类</span><br><span class="hljs-comment"> */</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Base</span> </span>&#123;<br>    <span class="hljs-comment">/*1*/</span> <span class="hljs-keyword">static</span> &#123;System.out.println(<span class="hljs-string">&quot;Base Static Block 1&quot;</span>);&#125;<br>    <span class="hljs-comment">/*1*/</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String staticValue=Log.baseStaticFieldInit();<br>    <span class="hljs-comment">/*1*/</span> <span class="hljs-keyword">static</span> &#123;System.out.println(<span class="hljs-string">&quot;Base Static Block 2&quot;</span>);&#125;<br><br>    <span class="hljs-comment">/*3*/</span> &#123;System.out.println(<span class="hljs-string">&quot;Base Normal Block 1&quot;</span>);&#125;<br>    <span class="hljs-comment">/*3*/</span> <span class="hljs-keyword">private</span> String value=Log.baseFieldInit();<br>    <span class="hljs-comment">/*3*/</span> &#123;System.out.println(<span class="hljs-string">&quot;Base Normal Block 2&quot;</span>);&#125;<br><br>    <span class="hljs-comment">/*4*/</span> Base()&#123;System.out.println(<span class="hljs-string">&quot;Base Constructor&quot;</span>);&#125;<br><br>    <span class="hljs-comment">/*3*/</span> &#123;System.out.println(<span class="hljs-string">&quot;Base Normal Block 3&quot;</span>);&#125;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *派生类</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Derived</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Base</span></span>&#123;<br>    <span class="hljs-comment">/*2*/</span> <span class="hljs-keyword">static</span> &#123;System.out.println(<span class="hljs-string">&quot;Static Block 1&quot;</span>);&#125;<br>    <span class="hljs-comment">/*2*/</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String staticValue=Log.staticFieldInit();<br>    <span class="hljs-comment">/*2*/</span> <span class="hljs-keyword">static</span> &#123;System.out.println(<span class="hljs-string">&quot;Static Block 2&quot;</span>);&#125;<br><br>    <span class="hljs-comment">/*5*/</span> &#123;System.out.println(<span class="hljs-string">&quot;Normal Block 1&quot;</span>);&#125;<br>    <span class="hljs-comment">/*5*/</span> <span class="hljs-keyword">private</span> String value=Log.fieldInit();<br>    <span class="hljs-comment">/*5*/</span> &#123;System.out.println(<span class="hljs-string">&quot;Normal Block 2&quot;</span>);&#125;<br>    <span class="hljs-comment">/*6*/</span> Derived()&#123;System.out.println(<span class="hljs-string">&quot;Derived Constructor&quot;</span>);&#125;<br><br>    <span class="hljs-comment">/*5*/</span> &#123;System.out.println(<span class="hljs-string">&quot;Normal Block 3&quot;</span>);&#125;<br>    <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *  MAIN 主线程</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;<br>        Derived d=<span class="hljs-keyword">new</span> Derived();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>（1 2只在加载进正文段时执行一次）</p><ol><li>父类static字段/块</li><li>子类static字段/块</li><li>子类构造方法进<code>super()</code>，父类构造方法进<code>this()</code>，父类非static字段/块（包括构造方法后的）</li><li>父类构造方法其余操作</li><li>子类构造方法<code>super()</code>结束，子类构造方法进<code>this()</code>，子类非static字段/块（包括构造方法后的）</li><li>子类构造方法其余操作</li></ol><p>注：方法只有指名道姓时才会被调用。</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs scss">Base Static Block 1  <span class="hljs-comment">// 父类static</span><br>Base Static Field  <span class="hljs-comment">// 父类static</span><br>Base Static Block 2  <span class="hljs-comment">// 父类static</span><br>Static Block 1  <span class="hljs-comment">// 子类static</span><br>Static Field  <span class="hljs-comment">// 子类static</span><br>Static Block 2  <span class="hljs-comment">// 子类static</span><br>Base <span class="hljs-attribute">Normal</span> Block 1  <span class="hljs-comment">// 父类非static</span><br>Base <span class="hljs-attribute">Normal</span> Field  <span class="hljs-comment">// 父类非static</span><br>Base <span class="hljs-attribute">Normal</span> Block 2  <span class="hljs-comment">// 父类非static</span><br>Base <span class="hljs-attribute">Normal</span> Block 3   <span class="hljs-comment">// 父类非static</span><br>Base Constructor  <span class="hljs-comment">// 父类构造方法其余操作</span><br><span class="hljs-attribute">Normal</span> Block 1  <span class="hljs-comment">// 子类非static</span><br><span class="hljs-attribute">Normal</span> Field  <span class="hljs-comment">// 子类非static</span><br><span class="hljs-attribute">Normal</span> Block 2  <span class="hljs-comment">// 子类非static</span><br><span class="hljs-attribute">Normal</span> Block 3  <span class="hljs-comment">// 子类非static</span><br>Derived Constructor  <span class="hljs-comment">// 子类构造方法其余操作</span><br></code></pre></td></tr></table></figure><p>初始化过程常与动态绑定结合出题</p><ul><li>如果通过子类构造函数调用父类构造函数（无论显示还是隐式），父类在构造时调用了被子类重写的方法，实际上调用的是子类覆盖的方法。<ul><li><strong>优点：通过继承相同的父类，初始化不同子类时，父类会调用不同的复写方法（真正new的那个子类的复写方法），从而实现多态性。</strong></li><li><strong>缺点：若是在父类构造函数中调用被子类重写的方法，会致使导致重写的方法在子类构造器的全部代码以前执行（子类构造函数在<code>super()</code>中，还没有<code>this()</code>），从而致使子类重写的方法访问不到子类实例变量的值，因为此时这些变量尚未被初始化。</strong>（作业二）</li></ul></li></ul><p>作业二魔改版</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.exam.oop2;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Base</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name = <span class="hljs-string">&quot;base&quot;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Base</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// this();  // 这里只是为了理解，程序角度并不正确</span><br>        tellName();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tellName</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;Base tell name: &quot;</span> + name);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Derived2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Base</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name = <span class="hljs-string">&quot;derived2&quot;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Derived2</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// super();</span><br>        <span class="hljs-comment">// this();  // 这里只是为了理解，程序角度并不正确</span><br>        tellName();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tellName</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;Derived2 tell name: &quot;</span> + name);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Derived</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Base</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name = <span class="hljs-string">&quot;derived&quot;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Derived</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// super();</span><br>        <span class="hljs-comment">// this();  // 这里只是为了理解，程序角度并不正确</span><br>        tellName();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tellName</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;Derived tell name: &quot;</span> + name);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DerivedDerived</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Derived</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name = <span class="hljs-string">&quot;derivedDerived&quot;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">DerivedDerived</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// super();</span><br>        <span class="hljs-comment">// this();  // 这里只是为了理解，程序角度并不正确</span><br>        tellName();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tellName</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;DerivedDerived tell name: &quot;</span> + name);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">new</span> Derived();<br>        <span class="hljs-keyword">new</span> Derived2();<br>        <span class="hljs-keyword">new</span> DerivedDerived();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>结果</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs applescript">Derived <span class="hljs-keyword">tell</span> <span class="hljs-built_in">name</span>: null<br>Derived <span class="hljs-keyword">tell</span> <span class="hljs-built_in">name</span>: derived<br>Derived2 <span class="hljs-keyword">tell</span> <span class="hljs-built_in">name</span>: null<br>Derived2 <span class="hljs-keyword">tell</span> <span class="hljs-built_in">name</span>: derived2<br>DerivedDerived <span class="hljs-keyword">tell</span> <span class="hljs-built_in">name</span>: null<br>DerivedDerived <span class="hljs-keyword">tell</span> <span class="hljs-built_in">name</span>: null<br>DerivedDerived <span class="hljs-keyword">tell</span> <span class="hljs-built_in">name</span>: derivedDerived<br></code></pre></td></tr></table></figure><p>流程：</p><ol><li><strong>new Derived();</strong></li><li><strong>Derived里的super(</strong>) 进Base()</li><li><strong>Base里的this()</strong>：<code>private String name = &quot;base&quot;;</code>，这时Base.name=”base”,Derived.name=null</li><li><strong>Base里的其他</strong>：<code>tellName()</code>，这个方法被主调类重写了，所以调的是Derived.tellname()</li><li><strong>Derived里的this（）</strong>：<code>private String name = &quot;derived&quot;;</code>,这时Base.name=”base”,Derived.name=”derived”</li><li><strong>Derived里的其他</strong>：tellName()，自己就是将其重写的主调类，所以调的是Derived.tellname()</li><li><strong>new Derived2();</strong></li><li>…</li></ol><p>其他流程都差不多，要注意的是父类构造函数调的方法一定是被真正new的子类重写的</p><h3 id="接口？抽象类？"><a href="#接口？抽象类？" class="headerlink" title="接口？抽象类？"></a>接口？抽象类？</h3><p>详见<strong>课后小结</strong></p><p>接口：interface</p><p>接口是对希望符合这个接口的类的一组<strong>需求</strong>。</p><p>接口没有实例。</p><p>接口中的所有方法都是<code>public</code>，所有字段都是<code>public static final</code></p><p>实现接口的类若非抽象类，则必须实现接口中的所有方法</p><p>实现接口时必须将方法声明为<code>public</code>，因为缺省访问权限为包内权限，编译器会报错，认为你试图提供更严格的（更弱的）访问权限</p><p>当方法冲突时：</p><ol><li><p>超类冲突，超类优先</p></li><li><p>接口冲突，抛给程序员解决</p><p>使用<code>&#123;接口名&#125;.super.&#123;方法名&#125;</code>解决冲突</p></li></ol><p><strong>接口可以使用extends多继承</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.exam.grammar;<br><br><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">A</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">displayA</span><span class="hljs-params">()</span></span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">B</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">displayB</span><span class="hljs-params">()</span></span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">C</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">A</span>, <span class="hljs-title">B</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">displayC</span><span class="hljs-params">()</span></span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test4</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">C</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">displayA</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;This is interface A&#x27;s implement.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">displayB</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;This is interface B&#x27;s implement.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">displayC</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;This is interface C&#x27;s implement.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Test4 test4 = <span class="hljs-keyword">new</span> Test4();<br>        test4.displayA();<br>        test4.displayB();<br>        test4.displayC();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>抽象类：abstract</p><p>可以提供方法实现</p><p>修饰符任意</p><p>抽象类也只能被单继承</p><h3 id="内部类？匿名内部类？"><a href="#内部类？匿名内部类？" class="headerlink" title="内部类？匿名内部类？"></a>内部类？匿名内部类？</h3><p>内部类（inner class）：定义在另一个类中的类。</p><p>使用内部类的原因：</p><ol><li>内部类可以对同一个包中的其他类隐藏</li><li>内部类方法可以访问外围类的作用域中所有的数据，包括原本私有的数据</li><li>便于<strong>回调</strong></li></ol><p>语法格式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OuterClass</span> </span>&#123;   <span class="hljs-comment">// 外部类</span><br>    <span class="hljs-comment">// ...</span><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InnerClass</span> </span>&#123; <span class="hljs-comment">// 嵌套类，或称为内部类</span><br>        <span class="hljs-comment">// ...</span><br>    &#125;<br>&#125;<br>Copy<br></code></pre></td></tr></table></figure><p>内部类与外围类的字段、方法处于相同地位（都是外围类的成员）</p><p>内部类可以直接访问外围类成员</p><p><strong>匿名内部类</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.course.anonymousinnerclasstest;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Class1</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;I am Class1&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Class2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Class1</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;I am Class2&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Class1 commonClassObject = <span class="hljs-keyword">new</span> Class2();<br>        commonClassObject.display();<br><br>        Class1 anonymousInnerClassObject = <span class="hljs-keyword">new</span> Class1() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span><span class="hljs-params">()</span> </span>&#123;<br>                System.out.println(<span class="hljs-string">&quot;I am Class3&quot;</span>);<br>            &#125;<br>        &#125;;<br>        anonymousInnerClassObject.display();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Chap5-异常"><a href="#Chap5-异常" class="headerlink" title="Chap5 异常"></a>Chap5 异常</h2><h3 id="异常处理机制？"><a href="#异常处理机制？" class="headerlink" title="异常处理机制？"></a>异常处理机制？</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">try</span> &#123;<br>    ...<br>&#125; <span class="hljs-keyword">catch</span>(Exception e) &#123;<br>    ...<br>&#125; <span class="hljs-keyword">finally</span> &#123;<br>    ...<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.exam.exception;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            System.out.print(<span class="hljs-string">&#x27;a&#x27;</span>);<br>            method1(args);<br>            System.out.print(<span class="hljs-string">&#x27;e&#x27;</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            System.out.print(<span class="hljs-string">&#x27;m&#x27;</span>);<br>        &#125;<br>        System.out.print(<span class="hljs-string">&#x27;f&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">method1</span><span class="hljs-params">(String[] a)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            method2(a);<br>            System.out.print(<span class="hljs-string">&#x27;b&#x27;</span>);<br><span class="hljs-comment">//        &#125; catch (Exception e) &#123;</span><br><span class="hljs-comment">//            System.out.print(&#x27;n&#x27;);</span><br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            System.out.print(<span class="hljs-string">&#x27;c&#x27;</span>);<br>        &#125;<br>        System.out.print(<span class="hljs-string">&#x27;d&#x27;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">method2</span><span class="hljs-params">(String[] a)</span> </span>&#123;<br>        System.out.println(a[a.length]);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>正常的结果<code>abcdef</code>,<code>m</code>和<code>n</code>作为捕获异常的标志</p><p>带注释，存在异常抛出</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">acmf</span><br></code></pre></td></tr></table></figure><p>去掉注释，各try块正常接受异常<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">ancdef</span><br></code></pre></td></tr></table></figure></p><p>出现异常立刻中断，找本try块的catch、finally，如果没有被catch就往主调函数抛直到被catch或不能再抛而报错。</p><p><strong>带资源的try</strong></p><p>资源在try块结束后会自动关闭，不需要finally</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">try</span> (FileInputStream fileInputStream = <span class="hljs-keyword">new</span> FileInputStream(<span class="hljs-string">&quot;file1.data&quot;</span>);<br>     ObjectInputStream objectInputStream = <span class="hljs-keyword">new</span> ObjectInputStream(fileInputStream)) &#123;<br>            Equation equation = (Equation) objectInputStream.readObject();<br>            System.out.println(<span class="hljs-string">&quot;已将文件\&quot;file1.data\&quot;中的byte数组反序列化为一元二次方程对象&quot;</span>);<br>            equation.display();<br>        &#125; <span class="hljs-keyword">catch</span> (IOException | ClassNotFoundException e) &#123;<br>            System.out.println(e.getMessage());<br>        &#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">try</span> (Scanner scanner = <span class="hljs-keyword">new</span> Scanner(System.in)) &#123;<br>...<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="声明语句？"><a href="#声明语句？" class="headerlink" title="声明语句？"></a>声明语句？</h3><p>throws</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Equation</span><span class="hljs-params">(<span class="hljs-keyword">double</span> a, <span class="hljs-keyword">double</span> b, <span class="hljs-keyword">double</span> c)</span> <span class="hljs-keyword">throws</span> AWrongException</span><br></code></pre></td></tr></table></figure><h3 id="抛出语句？"><a href="#抛出语句？" class="headerlink" title="抛出语句？"></a>抛出语句？</h3><p>throw</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (a == <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AWrongException(<span class="hljs-string">&quot;二次项系数不能为0！&quot;</span>);<br></code></pre></td></tr></table></figure><h2 id="Chap6-核心类"><a href="#Chap6-核心类" class="headerlink" title="Chap6 核心类"></a>Chap6 核心类</h2><h3 id="包装类？-star-Interger"><a href="#包装类？-star-Interger" class="headerlink" title="包装类？:star:Interger"></a>包装类？:star:Interger</h3><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201081143437.png" alt="image-20220108114300287"></p><p>自动装箱</p><p><strong>编译器</strong>加上<code>Integer.valueOf()</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201081143638.png" alt=""></p><p>自动拆箱</p><p><strong>编译器</strong>加上<code>.intValue()</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201081144378.png" alt=""></p><p><strong>Integer类的方法</strong></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201081151007.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201081155072.png" alt=""></p><p>直译</p><p><code>compareTo</code>：比较</p><p><code>intValue</code>：int型值</p><p><code>parseInt</code>：转为int型</p><p><code>valueOf</code>：取()作为Integer的值</p><p><code>toString</code>：转为String型</p><h3 id="String？（除正则）"><a href="#String？（除正则）" class="headerlink" title="String？（除正则）"></a>String？（除正则）</h3><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090929205.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090930896.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090931010.png" alt=""></p><p>另，前两个方法应为：</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090939965.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090938257.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090932520.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090933210.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090933167.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090933683.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090934578.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201091010731.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201091010256.png" alt=""></p><h3 id="泛型类？（选择、考使用、遇到的问题）"><a href="#泛型类？（选择、考使用、遇到的问题）" class="headerlink" title="泛型类？（选择、考使用、遇到的问题）"></a>泛型类？（选择、考使用、遇到的问题）</h3><p>泛型类：有一个或多个类型的类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Pair</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">private</span> T first;<br>    <span class="hljs-keyword">private</span> T second;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Pair</span><span class="hljs-params">()</span> </span>&#123;<br>        first = <span class="hljs-keyword">null</span>;<br>        second = <span class="hljs-keyword">null</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Pair</span><span class="hljs-params">(T first, T second)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.first = first;<br>        <span class="hljs-keyword">this</span>.second = second;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> T <span class="hljs-title">getFirst</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> first;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> T <span class="hljs-title">getSecond</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> second;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setFirst</span><span class="hljs-params">(T first)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.first = first;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setSecond</span><span class="hljs-params">(T second)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.second = second;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090953078.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090944975.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090954313.png" alt=""></p><p>泛型方法</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090958902.png" alt=""></p><p>有界泛型</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201091002061.png" alt=""></p><p>定义：</p><p><code>&lt;T extends 类型1&gt;</code>：继承自类型1的任意类型T</p><p>使用：</p><p><code>&lt;? extends 类型1&gt;</code>：继承自类型1的任意类型</p><p><code>&lt;? super 类型1&gt;</code>：是类型1父类的任意类型</p><p>类型擦除</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201091000994.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090954631.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090956060.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201090957800.png" alt=""></p><p>StringBuffer</p><p><img src="C:/Users/XuWanpeng/AppData/Roaming/Typora/typora-user-images/image-20220109101510866.png" alt=""></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        StringBuffer stringBuffer=<span class="hljs-keyword">new</span> StringBuffer(<span class="hljs-string">&quot;2022年1月9日&quot;</span>);<br>        stringBuffer.append(<span class="hljs-string">&quot;我&quot;</span>);<br>        stringBuffer.append(<span class="hljs-string">&quot;学不完&quot;</span>);<br>        stringBuffer.append(<span class="hljs-string">&quot;了&quot;</span>);<br>        stringBuffer.delete(<span class="hljs-number">11</span>,<span class="hljs-number">12</span>);<br>        stringBuffer.insert(<span class="hljs-number">10</span>,<span class="hljs-string">&quot;终于&quot;</span>);<br>        String string=stringBuffer.toString();<br>        System.out.println(string);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="IO？"><a href="#IO？" class="headerlink" title="IO？"></a>IO？</h3><p>节点流、包装流考1-2选择</p><p>略</p><p>Scanner要会应用。</p><h2 id="Chap7-图形编程GUI"><a href="#Chap7-图形编程GUI" class="headerlink" title="Chap7 图形编程GUI"></a>Chap7 图形编程GUI</h2><p>先把这几个包写上</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.awt.*;<br><span class="hljs-keyword">import</span> java.awt.event.*;<br><span class="hljs-keyword">import</span> javax.swing.*;<br></code></pre></td></tr></table></figure><p>创建GUI程序可以有两种思路</p><p>第一种是直接生成JFarme的实例，使用它自带的方法。（少）</p><p>第二种是写一个继承自JFarme的类（实名类或匿名类），按我们的需要重载它的方法，最后只需要一句话生成它的实例即可。（多）</p><p>第二种方法有一个好处是可以直接在类里调用方法，不用指定对象。</p><h3 id="布局管理器有哪些？布局管理器怎么用？组件怎么放？"><a href="#布局管理器有哪些？布局管理器怎么用？组件怎么放？" class="headerlink" title="布局管理器有哪些？布局管理器怎么用？组件怎么放？"></a>布局管理器有哪些？布局管理器怎么用？组件怎么放？</h3><p>布局管理器有哪些？</p><ol><li><p>FlowLayout 流布局（Jpanel默认）</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201091513625.png" alt=""></p></li><li><p><strong>BoarderLayout 边框布局</strong>（JFrame默认）</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201091514549.png" alt=""></p></li><li><p>GridLayout 网格布局</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201091515514.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201091518993.png" alt=""></p></li><li><p>CardLayout 卡片布局</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201091518895.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201091518872.png" alt=""></p></li><li><p>GridBagLayout</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201091520104.png" alt=""></p></li></ol><h3 id="事件处理机制？（监听器）"><a href="#事件处理机制？（监听器）" class="headerlink" title="事件处理机制？（监听器）"></a>事件处理机制？（监听器）</h3><ol><li>对本类<strong>实现事件处理接口</strong></li><li>使用<strong>匿名内部类</strong>（多个方法，如鼠标事件MouseAdapter）/<strong>lambda表达式</strong>（函数式方法，如按键事件ActionListener）</li><li>使用<strong>外部类</strong></li></ol><p>本质上都是往里传一个自定义了方法的<strong>类</strong></p><h3 id="绘制图像？（Paint-Grahpics-g-、repaint-）"><a href="#绘制图像？（Paint-Grahpics-g-、repaint-）" class="headerlink" title="绘制图像？（Paint(Grahpics g)、repaint()）"></a>绘制图像？（Paint(Grahpics g)、repaint()）</h3><p>一个例子解决这些问题</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.exam.gui;<br><br><span class="hljs-keyword">import</span> java.awt.*;<br><span class="hljs-keyword">import</span> java.awt.event.*;<br><span class="hljs-keyword">import</span> javax.swing.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GUIDemo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">JFrame</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ActionListener</span> </span>&#123;<br>    <span class="hljs-keyword">boolean</span> draw = <span class="hljs-keyword">false</span>;<br>    <span class="hljs-keyword">private</span> JButton jButton1 = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">private</span> JButton jButton2 = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">private</span> JButton jButton3 = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">private</span> JButton jButton4 = <span class="hljs-keyword">null</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">GUIDemo</span><span class="hljs-params">(String title)</span> </span>&#123;<br>        setTitle(title);<br>        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);<br><span class="hljs-comment">//        setLayout(new FlowLayout());</span><br>        setLayout(<span class="hljs-keyword">new</span> BorderLayout());<br>        setBounds(<span class="hljs-number">500</span>, <span class="hljs-number">250</span>, <span class="hljs-number">300</span>, <span class="hljs-number">200</span>);<br>        jButton1 = <span class="hljs-keyword">new</span> JButton(<span class="hljs-string">&quot;按钮1&quot;</span>);<br>        jButton2 = <span class="hljs-keyword">new</span> JButton(<span class="hljs-string">&quot;按钮2&quot;</span>);<br>        jButton3 = <span class="hljs-keyword">new</span> JButton(<span class="hljs-string">&quot;按钮1&quot;</span>);<br>        jButton4 = <span class="hljs-keyword">new</span> JButton(<span class="hljs-string">&quot;按钮4&quot;</span>);<br>        jButton3.setText(<span class="hljs-string">&quot;按钮3&quot;</span>);<br><span class="hljs-comment">//        add(jButton1);</span><br><span class="hljs-comment">//        add(jButton2);</span><br><span class="hljs-comment">//        add(jButton3);</span><br>        add(jButton1, BorderLayout.NORTH);<br>        add(jButton2, BorderLayout.SOUTH);<br>        add(jButton3, BorderLayout.WEST);<br>        add(jButton4, BorderLayout.EAST);<br>        add(<span class="hljs-keyword">new</span> JButton(<span class="hljs-string">&quot;按钮5&quot;</span>), BorderLayout.CENTER);<br><br>        <span class="hljs-comment">// 传匿名内部类</span><br>        jButton1.addActionListener(<span class="hljs-keyword">new</span> ActionListener() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">actionPerformed</span><span class="hljs-params">(ActionEvent e)</span> </span>&#123;<br>                jButton1.setEnabled(<span class="hljs-keyword">false</span>);<br>            &#125;<br>        &#125;);<br><br>        <span class="hljs-comment">// 传lambda</span><br>        jButton2.addActionListener(e -&gt; jButton2.setEnabled(<span class="hljs-keyword">false</span>));<br><br>        <span class="hljs-comment">// 传lambda</span><br>        jButton3.addActionListener(e -&gt; &#123;<br>            draw = <span class="hljs-keyword">false</span>;  <span class="hljs-comment">// 控制是否绘图</span><br>            JFrame jFrame = <span class="hljs-keyword">new</span> JFrame(<span class="hljs-string">&quot;图&quot;</span>) &#123;<br>                <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">paint</span><span class="hljs-params">(Graphics g)</span> </span>&#123;<br>                    <span class="hljs-keyword">super</span>.paint(g);<br>                    g.setColor(Color.RED);<br>                    <span class="hljs-keyword">if</span> (draw) &#123;  <span class="hljs-comment">// 防止窗口在实例化时即显示图形</span><br>                        g.drawOval(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>);<br>                        g.drawRect(<span class="hljs-number">300</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>);<br>                    &#125;<br>                &#125;<br>            &#125;;<br>            jFrame.setBounds(<span class="hljs-number">200</span>, <span class="hljs-number">200</span>, <span class="hljs-number">500</span>, <span class="hljs-number">300</span>);<br>            jFrame.setVisible(<span class="hljs-keyword">true</span>);<br>            jFrame.addMouseListener(<span class="hljs-keyword">new</span> MouseAdapter() &#123;<br>                <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">mouseClicked</span><span class="hljs-params">(MouseEvent e)</span> </span>&#123;<br>                    draw = <span class="hljs-keyword">true</span>;<br>                    jFrame.repaint();<br>                &#125;<br>            &#125;);<br>        &#125;);<br><br>        <span class="hljs-comment">// 传本类</span><br>        jButton4.addActionListener(<span class="hljs-keyword">this</span>);<br>        setVisible(<span class="hljs-keyword">true</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">actionPerformed</span><span class="hljs-params">(ActionEvent e)</span> </span>&#123;<br>        jButton4.setEnabled(<span class="hljs-keyword">false</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        GUIDemo guiDemo = <span class="hljs-keyword">new</span> GUIDemo(<span class="hljs-string">&quot;考试&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Graphics-g怎么画圆形？正方形？"><a href="#Graphics-g怎么画圆形？正方形？" class="headerlink" title="Graphics g怎么画圆形？正方形？"></a>Graphics g怎么画圆形？正方形？</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">paint</span><span class="hljs-params">(Graphics g)</span> </span>&#123;<br>    <span class="hljs-keyword">super</span>.paint(g);<br>        g.setColor(Color.RED);<br>        g.drawOval(x,y,w,h);<br>        g.drawRect(x,y,w,h)；    <span class="hljs-comment">//矩形</span><br>    &#125;<br></code></pre></td></tr></table></figure><p><strong>常用组件</strong></p><p><code>JButton</code></p><p>无常用方法</p><p><code>JTextField</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201091554831.png" alt=""></p><p><code>JLabel</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201091554166.png" alt=""></p><p><strong>JFarme常用方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java">setTitle(title);<br><br>setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);<br><br>setLayout(<span class="hljs-keyword">new</span> BorderLayout());<br><br>setLocation(x,y);<br>setSize(w,h);<br>setBounds(x, y, w, h);<br><br>add()<br>    <br>setVisible(<span class="hljs-keyword">true</span>);<br></code></pre></td></tr></table></figure><h2 id="Chap8-线程"><a href="#Chap8-线程" class="headerlink" title="Chap8 线程"></a>Chap8 线程</h2><h3 id="线程类定义？（构造线程的方法？）"><a href="#线程类定义？（构造线程的方法？）" class="headerlink" title="线程类定义？（构造线程的方法？）"></a>线程类定义？（构造线程的方法？）</h3><p>线程是一个继承自Thread的对象或一个实现了Runnable接口的对象</p><ol><li><p>继承Thread</p><p><code>extends Thread</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">myThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Thread</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">//code</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ol><ol><li><p>实现Runnable接口，通过Thread包装</p><p><code>implements Runnable</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">myThread</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Runnable</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">//code</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ol><p>开始线程</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Thread t1 = <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">this</span>);<br>t1.start();<br></code></pre></td></tr></table></figure><h3 id="线程六态转换的方法？"><a href="#线程六态转换的方法？" class="headerlink" title="线程六态转换的方法？"></a>线程六态转换的方法？</h3><p>线程的六种状态：</p><ul><li>New 新建</li><li>Runnable 可运行</li><li>Blocked 阻塞</li><li>Waiting 等待</li><li>Timed waiting 计时等待</li><li>Terminated 终止</li></ul><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201091613069.png" alt=""></p><p>start：新建-&gt;可运行</p><p>yield：运行-&gt;可运行</p><p>stop：运行-&gt;终止</p><p>join：可运行-&gt;等待/计时等待</p><p>wait：挂起，可运行-&gt;等待/计时等待，只能因等待期满唤醒或被notify唤醒</p><p>notify：唤醒，等待/计时等待-&gt;可运行</p><p>sleep：暂停程序，运行-&gt;计时等待，睡眠期满时，等待-&gt;<strong>可运行</strong>（仍要等待时间片）</p><p><strong>计时等待都要指定参数</strong></p><h3 id="线程同步？（synchronized互斥）"><a href="#线程同步？（synchronized互斥）" class="headerlink" title="线程同步？（synchronized互斥）"></a>线程同步？（synchronized互斥）</h3><p>同步方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title">get</span> <span class="hljs-params">()</span></span><br></code></pre></td></tr></table></figure><p>同步语句块</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">get</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">synchronized</span> (对象/类/<span class="hljs-keyword">this</span>)&#123;<br>        ...<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Guard.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.exam.thread;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Guard</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> value = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">final</span> String str = <span class="hljs-string">&quot;&quot;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getValue</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">synchronized</span> (str) &#123;<br>            System.out.println(<span class="hljs-string">&quot;=====start=====&quot;</span>);<br>            System.out.println(<span class="hljs-string">&quot;get value is: &quot;</span> + value);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setValue</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">synchronized</span> (str) &#123;<br>            value++;<br>            System.out.println(<span class="hljs-string">&quot;value + 1: &quot;</span> + value);<br>            System.out.println(<span class="hljs-string">&quot;======end======&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>MyThread.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.exam.thread;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Thread</span> </span>&#123;<br>    Guard guard;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyThread</span><span class="hljs-params">(Guard guard)</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.guard=guard;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">10</span>;i++)&#123;<br>            guard.getValue();<br>            <span class="hljs-keyword">try</span>&#123;<br>                sleep(<span class="hljs-number">1000</span>);  <span class="hljs-comment">// 静态方法</span><br>            &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>                e.getStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></p><p>YourThread.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.exam.thread;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">YourThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Thread</span> </span>&#123;<br>    Guard guard;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">YourThread</span><span class="hljs-params">(Guard guard)</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.guard=guard;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">10</span>;i++)&#123;<br>            guard.setValue();<br>            <span class="hljs-keyword">try</span>&#123;<br>                sleep(<span class="hljs-number">1000</span>);  <span class="hljs-comment">// 静态方法</span><br>            &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>                e.getStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Test.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.exam.thread;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;<br>        Guard guard=<span class="hljs-keyword">new</span> Guard();<br>        MyThread myThread=<span class="hljs-keyword">new</span> MyThread(guard);<br>        YourThread yourThread=<span class="hljs-keyword">new</span> YourThread(guard);<br>        myThread.start();<br>        yourThread.start();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs routeros">=====<span class="hljs-attribute">start</span>=====<br><span class="hljs-builtin-name">get</span> value is: 0<br>value + 1: 1<br>======<span class="hljs-attribute">end</span>======<br>=====<span class="hljs-attribute">start</span>=====<br><span class="hljs-builtin-name">get</span> value is: 1<br>value + 1: 2<br>======<span class="hljs-attribute">end</span>======<br>=====<span class="hljs-attribute">start</span>=====<br><span class="hljs-builtin-name">get</span> value is: 2<br>value + 1: 3<br>======<span class="hljs-attribute">end</span>======<br>=====<span class="hljs-attribute">start</span>=====<br><span class="hljs-builtin-name">get</span> value is: 3<br>value + 1: 4<br>======<span class="hljs-attribute">end</span>======<br>=====<span class="hljs-attribute">start</span>=====<br><span class="hljs-builtin-name">get</span> value is: 4<br>value + 1: 5<br>======<span class="hljs-attribute">end</span>======<br>=====<span class="hljs-attribute">start</span>=====<br><span class="hljs-builtin-name">get</span> value is: 5<br>value + 1: 6<br>======<span class="hljs-attribute">end</span>======<br>=====<span class="hljs-attribute">start</span>=====<br><span class="hljs-builtin-name">get</span> value is: 6<br>value + 1: 7<br>======<span class="hljs-attribute">end</span>======<br>=====<span class="hljs-attribute">start</span>=====<br><span class="hljs-builtin-name">get</span> value is: 7<br>value + 1: 8<br>======<span class="hljs-attribute">end</span>======<br>=====<span class="hljs-attribute">start</span>=====<br><span class="hljs-builtin-name">get</span> value is: 8<br>value + 1: 9<br>======<span class="hljs-attribute">end</span>======<br>=====<span class="hljs-attribute">start</span>=====<br><span class="hljs-builtin-name">get</span> value is: 9<br>value + 1: 10<br>======<span class="hljs-attribute">end</span>======<br><br>进程已结束,退出代码0<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>编程语言</category>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>《Java语言及网络编程》作业</title>
    <link href="/2022/01/02/%E3%80%8AJava%E8%AF%AD%E8%A8%80%E5%8F%8A%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E3%80%8B%E4%BD%9C%E4%B8%9A/"/>
    <url>/2022/01/02/%E3%80%8AJava%E8%AF%AD%E8%A8%80%E5%8F%8A%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E3%80%8B%E4%BD%9C%E4%B8%9A/</url>
    
    <content type="html"><![CDATA[<h1 id="作业一"><a href="#作业一" class="headerlink" title="作业一"></a>作业一</h1><h2 id="第一题"><a href="#第一题" class="headerlink" title="第一题"></a>第一题</h2><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>计算多项式1！+2！+3！…+n!，当多项式之和超过10000时停止，并输出累加之和以及n的值。</p><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>将多项式记为$\sum\limits_{i=1}^{n}i!$ ，那么显然程序需要两部分</p><ul><li>对$i$求其阶乘$i!$的部分，在factorial方法中完成</li><li>对$i!$进行循环求和的部分，在main方法中完成</li></ul><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">First</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">int</span> n = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; sum &lt;= <span class="hljs-number">10000</span>; i++) &#123;<br>            sum += factorial(i);<br>            n = i;<br>        &#125;<br>        System.out.println(<span class="hljs-string">&quot;sum=&quot;</span> + sum);<br>        System.out.println(<span class="hljs-string">&quot;n=&quot;</span> + n);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">factorial</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> x == <span class="hljs-number">1</span> ? <span class="hljs-number">1</span> : x * factorial(x - <span class="hljs-number">1</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="运行截图"><a href="#运行截图" class="headerlink" title="运行截图"></a>运行截图</h3><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201021748550.png" alt=""></p><h2 id="第二题"><a href="#第二题" class="headerlink" title="第二题"></a>第二题</h2><h3 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h3><p>从标准输入端输入一个字符，判断字符是数字、西文字母还是其他的字符。</p><h3 id="分析-1"><a href="#分析-1" class="headerlink" title="分析"></a>分析</h3><p>题目限定使用<strong>标准输入</strong>获取<strong>字符</strong>，即需要使用<code>(char) System.in.read()</code>，判断字符类型只需判断区间即可，java会隐式地将char转为ASCII码（int）进行比较。</p><p>值得注意的是java必须对可能被抛出的异常进行捕获或声明，否则编译不予通过，这体现了语言的健壮性。</p><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Second</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">char</span> ch = (<span class="hljs-keyword">char</span>) System.in.read();<br>            <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;0&#x27;</span> &lt;= ch &amp;&amp; ch &lt;= <span class="hljs-string">&#x27;9&#x27;</span>)<br>                System.out.println(ch + <span class="hljs-string">&quot; is digit&quot;</span>);<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;a&#x27;</span> &lt;= ch &amp;&amp; ch &lt;= <span class="hljs-string">&#x27;z&#x27;</span> || <span class="hljs-string">&#x27;A&#x27;</span> &lt;= ch &amp;&amp; ch &lt;= <span class="hljs-string">&#x27;Z&#x27;</span>)<br>                System.out.println(ch + <span class="hljs-string">&quot; is letter&quot;</span>);<br>            <span class="hljs-keyword">else</span><br>                System.out.println(ch + <span class="hljs-string">&quot; is other&quot;</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>            <span class="hljs-comment">// System.out.println(&quot;Error reading from user&quot;);</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="运行截图-1"><a href="#运行截图-1" class="headerlink" title="运行截图"></a>运行截图</h3><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201021748490.png" alt=""></p><h2 id="第三题"><a href="#第三题" class="headerlink" title="第三题"></a>第三题</h2><h3 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h3><p>利用辗转相除法（欧几里得算法）求两个正整数的最大公约数</p><h3 id="分析-2"><a href="#分析-2" class="headerlink" title="分析"></a>分析</h3><p>欧几里得算法依赖于原理: $gcd(a,b) = gcd(b, a\ mod\ b)$ </p><p>$proof：$</p><p>​        不妨设$a&gt;b$且$r=a\ mod\ b$ ,$r$不为0</p><p>​        那么有$a=kb+r$</p><p>​        假设d是a,b的一个公约数，记作$d|a$, $d|b$</p><p>​        由$r = a - kb$得$\frac{r}{d}=\frac{a}{d}-k\frac{b}{d}$</p><p>​        因为$d|a$, $d|b$，所以$\frac{a}{d}-k\frac{b}{d}\in{Z}$</p><p>​        即$\frac{r}{d}\in{Z}$，$d|r$，$d|(a\ mod\ b)$</p><p>​        因为$d|a$,  $d|b$,  $d|(a\ mod\ b)$</p><p>​        所以$d<em>{max}|a$,  $d</em>{max}|b$,  $d_{max}|(a\ mod\ b)$</p><p>​        即 $gcd(a,b) = gcd(b, a\ mod\ b)$ </p><p>​        $Q.E.D.$</p><p>值得注意的是，我们看似只证明了$a&gt;b$时的辗转相除法，但算法实现时不需要考虑$a&lt;b$的情况，因为如果$a&lt;b$，那么$a\ mod\ b=a$，即 $gcd(a,b) = gcd(b, a\ mod\ b)=gcd(b,a)$ ，仍然是$gcd(较大数, 较小数)$的形式。</p><p>另外，Scanner对象使用后需要关闭。</p><h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Third</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Scanner reader = <span class="hljs-keyword">new</span> Scanner(System.in);<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">int</span> x = reader.nextInt();<br>            <span class="hljs-keyword">int</span> y = reader.nextInt();<br>            System.out.println(<span class="hljs-string">&quot;gcd(&quot;</span> + x + <span class="hljs-string">&quot;,&quot;</span> + y + <span class="hljs-string">&quot;)=&quot;</span> + gcd(x, y));<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            reader.close();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">gcd</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (a % b == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> b;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> gcd(b, a % b);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="运行截图-2"><a href="#运行截图-2" class="headerlink" title="运行截图"></a>运行截图</h3><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201021748691.png" alt=""></p><h2 id="第四题"><a href="#第四题" class="headerlink" title="第四题"></a>第四题</h2><h3 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h3><p>假设一个数在1000到1100之间，那除以3结果余2，除以5结果余3，除以7结果余2（中国剩余定理），求此数。</p><h3 id="分析-3"><a href="#分析-3" class="headerlink" title="分析"></a>分析</h3><p>题目限定了未知数的范围，应该是在暗示使用穷举法。</p><p>这道题用中国剩余定理（CRT）做的话最小答案应该是23，另外java没有引用传递，我目前还没办法编写CRT算法所需的拓展欧几里得除法。</p><h3 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Fourth</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span>&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> x=<span class="hljs-number">1000</span>;x&lt;=<span class="hljs-number">1100</span>;x++)&#123;<br>            <span class="hljs-keyword">if</span> (x % <span class="hljs-number">3</span> == <span class="hljs-number">2</span> &amp;&amp; x % <span class="hljs-number">5</span> == <span class="hljs-number">3</span> &amp;&amp; x % <span class="hljs-number">7</span> == <span class="hljs-number">2</span>)<br>                System.out.println(x);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="运行截图-3"><a href="#运行截图-3" class="headerlink" title="运行截图"></a>运行截图</h3><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201021748748.png" alt=""></p><h2 id="第五题"><a href="#第五题" class="headerlink" title="第五题"></a>第五题</h2><h3 id="题目-4"><a href="#题目-4" class="headerlink" title="题目"></a>题目</h3><p>小球从100米高度自由落下，每次触地后反弹到原来高度的一半，求第10次触地时经历的总路程以及第10次反弹高度。</p><h3 id="分析-4"><a href="#分析-4" class="headerlink" title="分析"></a>分析</h3><p>基本上是学习每种语言必写的一道题了，按照题意模拟即可。</p><p>要注意的是“第10次触地<strong>时</strong>经历的总路程”和与“第10次反弹高度”同义的“第10次触地<strong>后</strong>的反弹高度”</p><p>我们进行模拟的时候只能模拟一个来回，即触地前的下落过程和触地后的反弹过程，那么对于<strong>“触地时”</strong>这种发生在一个来回中间的事件，我们要么在十个来回结束后减去最后一次的半个来回（反弹过程） ，要么单独只模拟九个来回，最后一个来回单独算，要么在模拟来回的过程中加一个中断<code>if (i == 10) sumTen=sum</code>……总之方法很多，我选择了第一个。</p><h3 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Fifth</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">double</span> h = <span class="hljs-number">100</span>;<br>        <span class="hljs-keyword">double</span> sum = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) &#123;<br>            sum += h;<br>            h /= <span class="hljs-number">2</span>;<br>            sum += h;<br>        &#125;<br>        System.out.println(<span class="hljs-string">&quot;Total distance at 10th touchdown=&quot;</span> + (sum - h));<br>        System.out.println(<span class="hljs-string">&quot;Height of rise after 10th touchdown=&quot;</span> + h);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="运行截图-4"><a href="#运行截图-4" class="headerlink" title="运行截图"></a>运行截图</h3><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201021748158.png" alt=""></p><h1 id="作业二"><a href="#作业二" class="headerlink" title="作业二"></a>作业二</h1><h2 id="第一题-1"><a href="#第一题-1" class="headerlink" title="第一题"></a>第一题</h2><h3 id="题目-5"><a href="#题目-5" class="headerlink" title="题目"></a>题目</h3><p>读程序，写结果</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wanpengxu.homework2;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(D obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;A and D&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(A obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;A and A&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">A</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(B obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;B and B&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(A obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;B and A&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">B</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(C obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;C and C&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(B obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;C and B&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">D</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">B</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(D obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;D and D&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(B obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;D and B&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">mainTest</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        A a1 = <span class="hljs-keyword">new</span> A();<br>        A a2 = <span class="hljs-keyword">new</span> B();<br>        B b = <span class="hljs-keyword">new</span> B();<br>        C c = <span class="hljs-keyword">new</span> C();<br>        D d = <span class="hljs-keyword">new</span> D();<br>        System.out.println(a1.Show(b));<br>        System.out.println(a1.Show(c));<br>        System.out.println(a1.Show(d));<br>        System.out.println(a2.Show(b));<br>        System.out.println(a2.Show(c));<br>        System.out.println(a2.Show(d));<br>        System.out.println(b.Show(b));<br>        System.out.println(b.Show(c));<br>        System.out.println(b.Show(d));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="答案"><a href="#答案" class="headerlink" title="答案"></a>答案</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs armasm">A <span class="hljs-keyword">and</span> A<br>A <span class="hljs-keyword">and</span> A<br>A <span class="hljs-keyword">and</span> D<br><span class="hljs-keyword">B</span> <span class="hljs-keyword">and</span> A<br><span class="hljs-keyword">B</span> <span class="hljs-keyword">and</span> A<br>A <span class="hljs-keyword">and</span> D<br><span class="hljs-keyword">B</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">B</span><br><span class="hljs-keyword">B</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">B</span><br>A <span class="hljs-keyword">and</span> D<br></code></pre></td></tr></table></figure><h3 id="分析-5"><a href="#分析-5" class="headerlink" title="分析"></a>分析</h3><p>先来看一下类图</p><pre><code class=" mermaid">classDiagram     A &lt;|-- B     B &lt;|-- C     B &lt;|-- D     class A&#123;         +Show(D obj) String         +Show(A obj) String     &#125;     class B&#123;         +Show(B obj) String         +Show(A obj) String     &#125;     class C&#123;         +Show(C obj) String         +Show(B obj) String     &#125;     class D&#123;         +Show(D obj) String         +Show(B obj) String     &#125;</code></pre><p>继承链：从某个特定的类到其祖先的路径。</p><p>在类图中继承链便是从某个类沿向上箭头直到最初的祖先的路径。</p><p>动态绑定方法调用的优先问题 ，优先级由高到低依次为：一级调度this.show(O)、二级调度super.show(O)、三级调度this.show((super)O)、 四级调度super.show((super)O)</p><p>首先是a1对象的调用，由<code>A a1 = new A();</code>知a1的编译时类型是A，运行时类型是<strong>A</strong>，那么a1中的方法有：</p><ol><li><p>自己定义的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(D obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;A and D&quot;</span>);<br>    &#125;<br></code></pre></td></tr></table></figure></li><li><p>自己定义的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(A obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;A and A&quot;</span>);<br>    &#125;<br></code></pre></td></tr></table></figure></li></ol><p>a1.Show(b)：a1中不含有参数为B的方法，由继承链知B可向上转型至A，那么调用<code>2</code>，输出<code>A and A</code></p><p>a1.Show(c)：a1中不含有参数为C的方法，由继承链知C可向上转型至A，那么调用<code>2</code>，输出<code>A and A</code></p><p>a1.Show(d)：a1中含有参数为D的方法，那么调用<code>1</code>，输出<code>A and D</code></p><p>接着是a2对象的调用，由<code>A a2 = new B();</code>知a2的编译时类型是A，运行时类型是<strong>B</strong>，那么a2中的方法有：</p><ol><li><p>继承自A的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(D obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;A and D&quot;</span>);<br>    &#125;<br></code></pre></td></tr></table></figure></li><li><p>继承自A但被自己覆盖的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(A obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;B and A&quot;</span>);<br>    &#125;<br></code></pre></td></tr></table></figure></li><li><p>自己定义的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(B obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;B and B&quot;</span>);<br>    &#125;<br></code></pre></td></tr></table></figure></li></ol><p>这里可以使用反射机制进行验证，代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br>...<br>        System.out.println(a2.getClass());<br>        Class&lt;? extends A&gt; testa2 = a2.getClass();<br>        Method[] methods = testa2.getMethods();  <span class="hljs-comment">// getDeclaredMethods()</span><br>        <span class="hljs-keyword">for</span> (Method m : methods) &#123;<br>            System.out.println(m);<br>        &#125;<br></code></pre></td></tr></table></figure><p>其中:</p><ol><li><code>getClass()</code>用于获取变量运行时类型的类名;</li><li><code>getMethods()</code>用于获取Class变量中的所有方法（从父类继承的和自己声明的）</li><li><code>getDeclaredMethods()</code>用于获取Class变量自己声明的方法。</li></ol><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112030947346.png" alt=""></p><p>但是，由于a2的编译时类型是A，所以在代码中只能调用<code>1</code>和<code>2</code>，否则会报错，即使你的实例中真的有<code>3</code>这个方法。</p><p>a2.Show(b)：a2中含有参数为B的方法，但不能调用，由继承链知B可向上转型至A，那么调用<code>2</code>，输出<code>B and A</code></p><p>a2.Show(c)：a2中不含有参数为C的方法，由继承链知C可向上转型至A，那么调用<code>2</code>，输出<code>B and A</code></p><p>a2.Show(d)：a2中含有参数为D的方法，那么调用<code>1</code>，输出<code>A and D</code></p><p>最后是b对象的调用，由<code>B b = new B();</code>知b的编译时类型是B，运行时类型是<strong>B</strong>，那么b中的方法有：</p><ol><li><p>继承自A的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(D obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;A and D&quot;</span>);<br>    &#125;<br></code></pre></td></tr></table></figure></li><li><p>继承自A但被自己覆盖的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(A obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;B and A&quot;</span>);<br>    &#125;<br></code></pre></td></tr></table></figure></li><li><p>自己定义的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">Show</span><span class="hljs-params">(B obj)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;B and B&quot;</span>);<br>    &#125;<br></code></pre></td></tr></table></figure></li></ol><p>b.Show(b)：b中含有参数为B的方法，那么调用<code>3</code>，输出<code>B and B</code></p><p>b.Show(c)：b中不含有参数为C的方法，由继承链知C可向上转型至B，那么调用<code>3</code>，输出<code>B and B</code></p><p>b.Show(d)：b本类不中含有参数为D的方法，但其超类中含有参数为D的方法，那么调用<code>1</code>，输出<code>A and D</code></p><h2 id="第二题-1"><a href="#第二题-1" class="headerlink" title="第二题"></a>第二题</h2><h3 id="题目-6"><a href="#题目-6" class="headerlink" title="题目"></a>题目</h3><p>读程序，写结果</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wanpengxu.homework2;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Base</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name = <span class="hljs-string">&quot;base&quot;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Base</span><span class="hljs-params">()</span> </span>&#123;<br>        tellName();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tellName</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;Base tell name: &quot;</span> + name);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Derived</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Base</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name = <span class="hljs-string">&quot;derived&quot;</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Derived</span><span class="hljs-params">()</span> </span>&#123;<br>        tellName();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tellName</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;Derived tell name: &quot;</span> + name);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">new</span> Derived();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="答案-1"><a href="#答案-1" class="headerlink" title="答案"></a>答案</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs applescript">Derived <span class="hljs-keyword">tell</span> <span class="hljs-built_in">name</span>: null<br>Derived <span class="hljs-keyword">tell</span> <span class="hljs-built_in">name</span>: derived<br></code></pre></td></tr></table></figure><h3 id="分析-6"><a href="#分析-6" class="headerlink" title="分析"></a>分析</h3><p>流程如下：</p><ol><li><p>从<code>main</code>方法进入，执行<code>new Derived();</code>语句。</p></li><li><p>调用Derived的构造方法<code>Derived()</code>。</p></li><li><p>因<code>class Derived extends Base</code>，所以<code>Derived()</code>的第一句是由编译器添加的<code>Base()</code>，那么调用其父类的构造方法<code>Base()</code>。</p></li><li><p>Base类的构造方法初始化自己的属性，首先执行<code>private String name = &quot;base&quot;;</code>，使Base.name=”base”，随后调用<code>tellName()</code>方法，因为运行时类型是Derived，所以根据继承链，优先匹配Derived中的<code>tellName()</code>方法，但因为此时还没有到Derived初始化，所以this.name=null，打印出的结果为</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">Derived <span class="hljs-keyword">tell</span> <span class="hljs-built_in">name</span>: null<br></code></pre></td></tr></table></figure><p>随后<code>Base()</code>方法结束,继续执行<code>Derived()</code>。</p></li><li><p>此时<code>Derived()</code>初始化自己的属性，执行<code>private String name = &quot;derived&quot;;</code>，使this.name=”derived”，随后调用<code>tellName()</code>方法，同样的原因，匹配Derived中的<code>tellName()</code>方法，但此时this.name=”derived”，打印出的结果为</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">Derived <span class="hljs-keyword">tell</span> <span class="hljs-built_in">name</span>: derived<br></code></pre></td></tr></table></figure><p>随后<code>Derived()</code>方法结束，<code>new Derived();</code>语句完成，<code>main</code>方法结束，程序结束。</p></li></ol><h2 id="第三题-1"><a href="#第三题-1" class="headerlink" title="第三题"></a>第三题</h2><h3 id="题目-7"><a href="#题目-7" class="headerlink" title="题目"></a>题目</h3><p>生成动物，要求如下：</p><ol><li>循环通过标准输入端输入需要生成的动物，当遇到结束标志，则结束程序运行。</li><li>每次生成动物，通过标准输出端显示动物的信息。</li><li>动物的信息包括：目前所有动物的总数，当前这一类动物的总数。</li><li>整个程序结构用工厂模式设计，保证将来动物园有新的动物加入时，程序可扩展。</li></ol><h3 id="答案-2"><a href="#答案-2" class="headerlink" title="答案"></a>答案</h3><h4 id="项目结构树"><a href="#项目结构树" class="headerlink" title="项目结构树"></a>项目结构树</h4><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">D:.<br>│  <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">IdeaProjects</span>.</span></span>iml<br>│  <br>├─.idea<br>│<span class="hljs-operator">  ...    </span><br><span class="hljs-operator"></span>├─out<br>│<span class="hljs-operator">  ...</span><br><span class="hljs-operator"></span>└─src<br>    └─com<br>        └─wanpengxu<br>            └─homework2<br>                │  <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Derived</span>.</span></span>java<br>                │  mainTest.java<br>                │  <br>                └─third<br>                    │  <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Main</span>.</span></span>java<br>                    │  <br>                    ├─factory<br>                    │      <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AnimalFactory</span>.</span></span>java<br>                    │      <br>                    └─product<br>                            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Animal</span>.</span></span>java<br>                            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Cat</span>.</span></span>java<br>                            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Dog</span>.</span></span>java<br>                            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Panda</span>.</span></span>java<br></code></pre></td></tr></table></figure><h4 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h4><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112022112892.png" alt=""></p><h4 id="代码-5"><a href="#代码-5" class="headerlink" title="代码"></a>代码</h4><ol><li><p>Animal.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wanpengxu.homework2.third.product;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> num = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">public</span> String name;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Animal</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>        num += <span class="hljs-number">1</span>;<br>        System.out.println(<span class="hljs-string">&quot;现在共有&quot;</span> + num + <span class="hljs-string">&quot;只动物！&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getInformation</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;\&quot;&quot;</span> + name + <span class="hljs-string">&quot;\&quot;&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>Cat.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wanpengxu.homework2.third.product;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> _num = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Cat</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(name);<br>        Cat._num += <span class="hljs-number">1</span>;<br>        System.out.println(<span class="hljs-string">&quot;你获得了1只猫！现在已有&quot;</span> + getCatNumber() + <span class="hljs-string">&quot;只猫！&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getInformation</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;\&quot;&quot;</span> + name + <span class="hljs-string">&quot;\&quot;：一只猫&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getCatNumber</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> Cat._num;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>Dog.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wanpengxu.homework2.third.product;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> _num = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Dog</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(name);<br>        Dog._num += <span class="hljs-number">1</span>;<br>        System.out.println(<span class="hljs-string">&quot;你获得了1只狗！现在已有&quot;</span> + getDogNumber() + <span class="hljs-string">&quot;只狗！&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getInformation</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;\&quot;&quot;</span> + name + <span class="hljs-string">&quot;\&quot;：一只狗&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getDogNumber</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> Dog._num;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>Panda.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wanpengxu.homework2.third.product;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Panda</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> _num = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Panda</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(name);<br>        Panda._num += <span class="hljs-number">1</span>;<br>        System.out.println(<span class="hljs-string">&quot;你获得了1只熊猫！现在已有&quot;</span> + getPandaNumber() + <span class="hljs-string">&quot;只熊猫！&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getInformation</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;\&quot;&quot;</span> + name + <span class="hljs-string">&quot;\&quot;：一只熊猫&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getPandaNumber</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> Panda._num;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>AnimalFactory.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wanpengxu.homework2.third.factory;<br><br><span class="hljs-keyword">import</span> com.wanpengxu.homework2.third.product.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AnimalFactory</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Animal <span class="hljs-title">addAnimal</span><span class="hljs-params">(String type, String name)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">switch</span> (type.toLowerCase()) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;cat&quot;</span> -&gt; <span class="hljs-keyword">new</span> Cat(name);<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;dog&quot;</span> -&gt; <span class="hljs-keyword">new</span> Dog(name);<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;panda&quot;</span> -&gt; <span class="hljs-keyword">new</span> Panda(name);<br>            <span class="hljs-keyword">default</span> -&gt; <span class="hljs-keyword">null</span>;<br>        &#125;;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>Main.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wanpengxu.homework2.third;<br><br><span class="hljs-keyword">import</span> com.wanpengxu.homework2.third.factory.AnimalFactory;<br><span class="hljs-keyword">import</span> com.wanpengxu.homework2.third.product.Animal;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        ArrayList&lt;Animal&gt; animals = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        System.out.println(<span class="hljs-string">&quot;欢迎来到动物工厂！工厂现在可以生产以下动物：Cat, Dog, Panda！输入Quit退出！&quot;</span>);<br>        <span class="hljs-keyword">try</span> (Scanner sc = <span class="hljs-keyword">new</span> Scanner(System.in)) &#123;  <span class="hljs-comment">// try-with-resources 类似try-finally</span><br>            <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>                System.out.print(<span class="hljs-string">&quot;请输入想生产的动物类型：&quot;</span>);<br>                String type = sc.next();<br>                <span class="hljs-keyword">if</span> (type.equalsIgnoreCase(<span class="hljs-string">&quot;Quit&quot;</span>))<br>                    <span class="hljs-keyword">break</span>;<br>                System.out.print(<span class="hljs-string">&quot;请输入它的名字：&quot;</span>);<br>                String name = sc.next();<br>                Animal animal = AnimalFactory.addAnimal(type, name);<br>                <span class="hljs-keyword">if</span> (animal == <span class="hljs-keyword">null</span>)<br>                    System.out.println(<span class="hljs-string">&quot;请输入可生产的动物！&quot;</span>);<br>                <span class="hljs-keyword">else</span><br>                    animals.add(animal);<br>            &#125;<br>        &#125;<br>        System.out.println(<span class="hljs-string">&quot;生成完毕！现在你有：&quot;</span>);<br>        <span class="hljs-keyword">for</span> (Animal animal : animals)<br>            System.out.println(animal.getInformation());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ol><h4 id="运行截图-5"><a href="#运行截图-5" class="headerlink" title="运行截图"></a>运行截图</h4><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112022053155.png" alt=""></p><h3 id="分析-7"><a href="#分析-7" class="headerlink" title="分析"></a>分析</h3><p>题目要求使用工厂模式，那么按照工厂模式的实现，有：</p><ol><li><p>要有一个父类Animal，这里因为动物本身有一些公用的属性和方法，所以最好不要定义为abstract类；</p></li><li><p>要有一些继承自Animal的具体的类作为某种动物，如Cat, Dog, Panda；</p></li><li><p>需要一个工厂类AnimalFactory生成基于给定信息的实体类的对象，这里我是用增强型switch实现的，当然也可以用普通switch或if-else if-else实现；</p></li><li><p>需要一个使用该工厂的类（用户类）来操作工厂完成生产任务。我加入了一点功能：生成动物时为其命名，并在退出后显示已生成动物名和其类型。另外，使用了可以自动关闭资源的try-with-resources语法，它的功能类似于try-finally，但语法十分精简。</p></li></ol><p>因为采用了工厂模式，所以拓展动物种类的操作也很简单：</p><ol><li>复制一份动物类，将其类名重构为新增的动物，方法名同理；</li><li>更改一些字符串以与新增动物相对应；</li><li>在AnimalFactory类中新增一行case。</li></ol><h1 id="作业三"><a href="#作业三" class="headerlink" title="作业三"></a>作业三</h1><h2 id="第一题-2"><a href="#第一题-2" class="headerlink" title="第一题"></a>第一题</h2><h3 id="题目-8"><a href="#题目-8" class="headerlink" title="题目"></a>题目</h3><ul><li><p>用泛型List管理学生信息，学生对象信息为：姓名、学号、年龄、专业</p></li><li><p>对学生列表完成：添加、删除、查找、全部显示操作。</p></li></ul><h3 id="答案-3"><a href="#答案-3" class="headerlink" title="答案"></a>答案</h3><h4 id="项目结构树-1"><a href="#项目结构树-1" class="headerlink" title="项目结构树"></a>项目结构树</h4><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">D:.<br>│<span class="hljs-operator"> ...                             </span><br><span class="hljs-operator"></span>└─src<br>    └─edu<br>        └─wanpengxu      <br>            └─homework3<br>                └─first<br>                       <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Student</span>.</span></span>java<br>                       <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">StudentAdministrator</span>.</span></span>java<br>                       <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Test</span>.</span></span>java<br></code></pre></td></tr></table></figure><h4 id="代码-6"><a href="#代码-6" class="headerlink" title="代码"></a>代码</h4><p>Student.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.homework3.first;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> String studentID;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;<br>    <span class="hljs-keyword">private</span> String major;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Student</span><span class="hljs-params">(String name, String studentID, <span class="hljs-keyword">int</span> age, String major)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>        <span class="hljs-keyword">this</span>.studentID = studentID;<br>        <span class="hljs-keyword">this</span>.age = age;<br>        <span class="hljs-keyword">this</span>.major = major;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getStudentID</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> studentID;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getAge</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getMajor</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> major;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setStudentID</span><span class="hljs-params">(String studentID)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.studentID = studentID;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAge</span><span class="hljs-params">(<span class="hljs-keyword">int</span> age)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setMajor</span><span class="hljs-params">(String major)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.major = major;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;name:&quot;</span> + name);<br>        System.out.println(<span class="hljs-string">&quot;studentID:&quot;</span> + studentID);<br>        System.out.println(<span class="hljs-string">&quot;age:&quot;</span> + age);<br>        System.out.println(<span class="hljs-string">&quot;major:&quot;</span> + major);<br>        System.out.println();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>StudentAdministrator.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.homework3.first;<br><br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StudentAdministrator</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> List&lt;Student&gt; database = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();  <span class="hljs-comment">// database变量始终引用数组</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">add</span><span class="hljs-params">(Student student)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span>(student.getStudentID().length()!=<span class="hljs-number">8</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span>(Student studentI:database)&#123;<br>            <span class="hljs-keyword">if</span>(studentI.getStudentID().equals(student.getStudentID()))&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> database.add(student);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Student&gt; <span class="hljs-title">find</span><span class="hljs-params">(String name)</span> </span>&#123;<br>        List&lt;Student&gt; foundStudent = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (Student student : database) &#123;<br>            <span class="hljs-keyword">if</span> (student.getName().equals(name)) &#123;<br>                foundStudent.add(student);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> foundStudent;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">delete</span><span class="hljs-params">(String studentID)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> database.removeIf(student -&gt; student.getStudentID().equals(studentID));<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">showAll</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (Student student : database) &#123;<br>            student.display();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Test.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.homework3.first;<br><br><span class="hljs-keyword">import</span> java.io.Console;<br><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        HashMap&lt;String, String&gt; administrators = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<br>        StudentAdministrator studentAdministrator = <span class="hljs-keyword">null</span>;<br>        System.out.println(<span class="hljs-string">&quot;Welcome to undergraduate management system!&quot;</span>);<br>        <span class="hljs-keyword">try</span> (Scanner scanner = <span class="hljs-keyword">new</span> Scanner(System.in)) &#123;<br>            <span class="hljs-keyword">boolean</span> logged = <span class="hljs-keyword">false</span>;<br>            <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>                System.out.println(<span class="hljs-string">&quot;Please select: [C]Creat Administrator\t[L]Login\t[A]Add\t[D]Delete\t[F]Find\t[S]Show All\t[E]Exit&quot;</span>);<br>                String type = scanner.next();<br>                <span class="hljs-keyword">if</span> (type.equalsIgnoreCase(<span class="hljs-string">&quot;C&quot;</span>)) &#123;<br>                    System.out.println(<span class="hljs-string">&quot;Please input your username:&quot;</span>);<br>                    String username = scanner.next();<br>                    System.out.println(<span class="hljs-string">&quot;Please input your password:&quot;</span>);<br>                    String password = scanner.next();  <span class="hljs-comment">// 不隐藏输入</span><br><span class="hljs-comment">//                    Console con = System.console();</span><br><span class="hljs-comment">//                    String password = new String(con.readPassword());  // 隐藏输入，在IDE中不可行，因为控制台被重定向了</span><br>                    <span class="hljs-keyword">if</span> (administrators.get(username) == <span class="hljs-keyword">null</span>) &#123;<br>                        administrators.put(username, password);<br>                        System.out.println(<span class="hljs-string">&quot;Creat succeeded!&quot;</span>);<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        System.out.println(<span class="hljs-string">&quot;Creat failed!&quot;</span>);<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type.equalsIgnoreCase(<span class="hljs-string">&quot;L&quot;</span>)) &#123;<br>                    System.out.println(<span class="hljs-string">&quot;Please input your username:&quot;</span>);<br>                    String username = scanner.next();<br>                    System.out.println(<span class="hljs-string">&quot;Please input your password:&quot;</span>);<br>                    String password = scanner.next();<br><span class="hljs-comment">//                    Console con = System.console();</span><br><span class="hljs-comment">//                    String password = new String(con.readPassword());</span><br>                    <span class="hljs-keyword">if</span> (administrators.get(username) != <span class="hljs-keyword">null</span> &amp;&amp; administrators.get(username).equals(password)) &#123;<br>                        System.out.println(<span class="hljs-string">&quot;Login succeeded!&quot;</span>);<br>                        logged = <span class="hljs-keyword">true</span>;<br>                        studentAdministrator = <span class="hljs-keyword">new</span> StudentAdministrator();<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        System.out.println(<span class="hljs-string">&quot;Login failed!&quot;</span>);<br>                    &#125;<br>                &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type.equalsIgnoreCase(<span class="hljs-string">&quot;E&quot;</span>)) &#123;<br>                    System.out.println(<span class="hljs-string">&quot;Exit succeeded!&quot;</span>);<br>                    <span class="hljs-keyword">break</span>;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">if</span> (logged) &#123;<br>                        <span class="hljs-keyword">if</span> (type.equalsIgnoreCase(<span class="hljs-string">&quot;A&quot;</span>)) &#123;<br>                            System.out.println(<span class="hljs-string">&quot;Please input student&#x27;s name:&quot;</span>);<br>                            String name = scanner.next();<br>                            System.out.println(<span class="hljs-string">&quot;Please input 8-digit student&#x27;s studentID:&quot;</span>);<br>                            String studentID = scanner.next();<br>                            System.out.println(<span class="hljs-string">&quot;Please input student&#x27;s age:&quot;</span>);<br>                            <span class="hljs-keyword">int</span> age;<br>                            <span class="hljs-keyword">try</span> &#123;<br>                                age = scanner.nextInt();<br>                            &#125; <span class="hljs-keyword">catch</span> (InputMismatchException ex) &#123;<br>                                System.out.println(<span class="hljs-string">&quot;Invalid input!&quot;</span>);<br>                                scanner.next();  <span class="hljs-comment">// 读入并丢弃异常的输入</span><br>                                <span class="hljs-keyword">continue</span>;<br>                            &#125;<br>                            System.out.println(<span class="hljs-string">&quot;Please input student&#x27;s major:&quot;</span>);<br>                            String major = scanner.next();<br>                            <span class="hljs-keyword">if</span> (studentAdministrator.add(<span class="hljs-keyword">new</span> Student(name, studentID, age, major))) &#123;<br>                                System.out.println(<span class="hljs-string">&quot;Added successfully!&quot;</span>);<br>                            &#125; <span class="hljs-keyword">else</span> &#123;<br>                                System.out.println(<span class="hljs-string">&quot;Added failed!&quot;</span>);<br>                            &#125;<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type.equalsIgnoreCase(<span class="hljs-string">&quot;D&quot;</span>)) &#123;<br>                            System.out.println(<span class="hljs-string">&quot;Please input 8-digit student&#x27;s studentID:&quot;</span>);<br>                            String studentID = scanner.next();<br>                            <span class="hljs-keyword">if</span> (studentAdministrator.delete(studentID)) &#123;<br>                                System.out.println(<span class="hljs-string">&quot;Delete successfully!&quot;</span>);<br>                            &#125; <span class="hljs-keyword">else</span> &#123;<br>                                System.out.println(<span class="hljs-string">&quot;Delete failed!&quot;</span>);<br>                            &#125;<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type.equalsIgnoreCase(<span class="hljs-string">&quot;F&quot;</span>)) &#123;<br>                            System.out.println(<span class="hljs-string">&quot;Please input student&#x27;s name:&quot;</span>);<br>                            String name = scanner.next();<br>                            List&lt;Student&gt; found = studentAdministrator.find(name);<br>                            System.out.println(<span class="hljs-string">&quot;Find &quot;</span> + found.size() + <span class="hljs-string">&quot; students!&quot;</span>);<br>                            <span class="hljs-keyword">for</span> (Student student : found) &#123;<br>                                student.display();<br>                            &#125;<br>                        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type.equalsIgnoreCase(<span class="hljs-string">&quot;S&quot;</span>)) &#123;<br>                            studentAdministrator.showAll();<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        System.out.println(<span class="hljs-string">&quot;Please login first!&quot;</span>);<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="运行截图-6"><a href="#运行截图-6" class="headerlink" title="运行截图"></a>运行截图</h4><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112222108247.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112222109679.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112222114282.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112222109641.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112222110090.png" alt=""></p><h3 id="分析-8"><a href="#分析-8" class="headerlink" title="分析"></a>分析</h3><p>一道比较简单的模拟题，大二时我们在程序设计综合实践课上做过更加复杂的例子。</p><p>首先我认为需要有学生类Student</p><p>还需要一个学生管理员类StudentAdministrator用于管理学生</p><p>最后在主类里调用学生管理员对象去管理学生对象</p><p>要注意的是这里涉及到了数据库的知识，学生表（在这里是<code>List&lt;Student&gt;</code>）的主键是<strong>学号</strong>，所以添加、删除这些操作都需要使用学号完成，同时考虑到非主键会有重复，所以查找操作使用了姓名，当然这种写法只适用于小型系统，如学院、学校的数据库系统，如果同名人数多的系统，如某省的户籍系统，还需要加入其他限定条件。</p><p>在基本要求外做了一个比较简单的访问控制，并没有保存它使其持久化。</p><p>注意到控制台程序的每个选项间距都不同，因为制表符<code>\t</code>用空格补全其左边字符串，使其长度到8的整数倍（正好是8的倍数也补，不然体现不出按制表键）。</p><h2 id="第二题-2"><a href="#第二题-2" class="headerlink" title="第二题"></a>第二题</h2><h3 id="题目-9"><a href="#题目-9" class="headerlink" title="题目"></a>题目</h3><p>一元二次方程类：</p><ol><li><p>输入一元二次方程的三个系数，确定这个方程式。</p><p>标明一个一元二次方程的属性。</p><ul><li><p>三个系数</p><p>$a$, $b$ ,$c$ </p></li><li><p>两个根(最多)(而且可能是虚根所以用统一的形式表示)<br>$x_1$,$y_1$, $x_2$,$y_2$ </p></li><li><p>决定根的特征的<br>$\delta=b^2-4ac$</p></li></ul><p>如果是一个一元二次方程需要的操作（注意方法的权限）:</p><ul><li><p>获取三个系数,确立一元二次方程.</p></li><li><p>求$\delta=b^2-4ac$</p></li><li><p>求根(可能是实根,也可能是虚根)</p></li></ul></li><li><p>如果二次系数$a$为0 ，主动抛出异常，因为这不满足一元二次方程的条件。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AWrongException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Exception</span></span><br></code></pre></td></tr></table></figure></li><li><p>把生成的一元二次方程对象（包含根的值）序列化并保存在文件<code>file1.data</code>中。</p><ul><li>根求出之后，再把对象序列化到文件file1.data中。</li></ul></li></ol><p>要求：</p><ol><li>实现一元二次方程类</li><li>在主类中调用这个一元二次方程类。(编程用命令行或者可视化方法获取系数 $a$,$b$,$c$)</li></ol><h3 id="答案-4"><a href="#答案-4" class="headerlink" title="答案"></a>答案</h3><h4 id="项目结构树-2"><a href="#项目结构树-2" class="headerlink" title="项目结构树"></a>项目结构树</h4><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">D:.                     <br>└─src<br>    └─edu<br>        └─wanpengxu    <br>            └─homework3<br>                └─second<br>                        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AWrongException</span>.</span></span>java<br>                        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Equation</span>.</span></span>java<br>                        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Test</span>.</span></span>java<br></code></pre></td></tr></table></figure><h4 id="代码-7"><a href="#代码-7" class="headerlink" title="代码"></a>代码</h4><h5 id="核心代码"><a href="#核心代码" class="headerlink" title="核心代码"></a>核心代码</h5><p>Equation.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.Serializable;<br><span class="hljs-keyword">import</span> java.lang.Math;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Equation</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">double</span> a, b, c;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">double</span> x1, x2;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">double</span> r, v;  <span class="hljs-comment">// r:实部 v:虚部</span><br>    <span class="hljs-keyword">int</span> type;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Equation</span><span class="hljs-params">(<span class="hljs-keyword">double</span> a, <span class="hljs-keyword">double</span> b, <span class="hljs-keyword">double</span> c)</span> <span class="hljs-keyword">throws</span> AWrongException </span>&#123;<br>        <span class="hljs-keyword">if</span> (a == <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AWrongException(<span class="hljs-string">&quot;二次项系数不能为0！&quot;</span>);<br>        <span class="hljs-keyword">this</span>.a = a;<br>        <span class="hljs-keyword">this</span>.b = b;<br>        <span class="hljs-keyword">this</span>.c = c;<br>        System.out.println(<span class="hljs-string">&quot;成功创建一元二次方程组：&quot;</span>);<br>        System.out.print((a == <span class="hljs-number">1</span> ? <span class="hljs-string">&quot;&quot;</span> : a) + <span class="hljs-string">&quot;x^2&quot;</span>);  <span class="hljs-comment">// 系数为1时省略</span><br>        <span class="hljs-keyword">if</span> (b != <span class="hljs-number">0</span>) System.out.print(<span class="hljs-string">&quot;+&quot;</span> + (b == <span class="hljs-number">1</span> ? <span class="hljs-string">&quot;&quot;</span> : b) + <span class="hljs-string">&quot;x&quot;</span>);<br>        <span class="hljs-keyword">if</span> (c != <span class="hljs-number">0</span>) System.out.print(<span class="hljs-string">&quot;+&quot;</span> + c);<br>        System.out.println(<span class="hljs-string">&quot;=0&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">double</span> <span class="hljs-title">calculateDelta</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> Math.pow(b, <span class="hljs-number">2</span>) - <span class="hljs-number">4</span> * a * c;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">solve</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">double</span> delta = calculateDelta();<br>        <span class="hljs-keyword">if</span> (Math.abs(delta) &lt; <span class="hljs-number">1e-5</span>) &#123;<br>            type = <span class="hljs-number">0</span>;<br>            x1 = x2 = -b / (<span class="hljs-number">2</span> * a);<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (delta &gt; <span class="hljs-number">0</span>) &#123;<br>            type = <span class="hljs-number">1</span>;<br>            x1 = (-b - Math.sqrt(delta)) / (<span class="hljs-number">2</span> * a);<br>            x2 = (-b + Math.sqrt(delta)) / (<span class="hljs-number">2</span> * a);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            type = <span class="hljs-number">2</span>;<br>            r = -b / (<span class="hljs-number">2</span> * a);<br>            v = Math.sqrt(-delta) / (<span class="hljs-number">2</span> * a);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">switch</span> (type) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">0</span> -&gt; System.out.println(<span class="hljs-string">&quot;该一元二次方程有两个相等的实数根：\nx1=x2=&quot;</span> + x1);<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span> -&gt; System.out.println(<span class="hljs-string">&quot;该一元二次方程有两个不同的实数根：\nx1=&quot;</span> + x1 + <span class="hljs-string">&#x27;\n&#x27;</span> + <span class="hljs-string">&quot;x2=&quot;</span> + x2);<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span> -&gt; System.out.printf(<span class="hljs-string">&quot;该一元二次方程有两个不同的复数根：\nx1=%1$s+%2$si\nx2=%1$s-%2$si\n&quot;</span>, r, v);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getSolution</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">switch</span> (type) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">0</span> -&gt; String.format(<span class="hljs-string">&quot;该一元二次方程有两个相等的实数根：\nx1=x2=%s&quot;</span>, x1);<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span> -&gt; String.format(<span class="hljs-string">&quot;该一元二次方程有两个不同的实数根：\nx1=%s\nx2=%s&quot;</span>, x1, x2);<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span> -&gt; String.format(<span class="hljs-string">&quot;该一元二次方程有两个不同的复数根：\nx1=%1$s+%2$si\nx2=%1$s-%2$si\n&quot;</span>, r, v);<br>            <span class="hljs-keyword">default</span> -&gt; <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalStateException(<span class="hljs-string">&quot;Unexpected value: &quot;</span> + type);<br>        &#125;;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>AWrongException.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.homework3.second;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AWrongException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Exception</span></span>&#123;  <span class="hljs-comment">// 系数a错误异常</span><br>    AWrongException(String s)&#123;<br>        <span class="hljs-keyword">super</span>(s);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="控制台程序"><a href="#控制台程序" class="headerlink" title="控制台程序"></a>控制台程序</h5><p>Test.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.homework3.second;<br><br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> (Scanner sc = <span class="hljs-keyword">new</span> Scanner(System.in)) &#123;<br>            System.out.println(<span class="hljs-string">&quot;请输入一元二次方程的系数：&quot;</span>);<br>            <span class="hljs-keyword">double</span> a = sc.nextDouble();<br>            <span class="hljs-keyword">double</span> b = sc.nextDouble();<br>            <span class="hljs-keyword">double</span> c = sc.nextDouble();<br>            <span class="hljs-keyword">try</span> &#123;<br>                Equation equation = <span class="hljs-keyword">new</span> Equation(a, b, c);<br>                equation.solve();<br>                equation.display();<br>                <span class="hljs-keyword">try</span> (FileOutputStream fileOutputStream = <span class="hljs-keyword">new</span> FileOutputStream(<span class="hljs-string">&quot;file1.data&quot;</span>);<br>                     ObjectOutputStream objectOutputStream = <span class="hljs-keyword">new</span> ObjectOutputStream(fileOutputStream)) &#123;<br>                    objectOutputStream.writeObject(equation);<br>                    System.out.println(<span class="hljs-string">&quot;已将一元二次方程对象序列化为byte数组保存至文件\&quot;file1.data\&quot;中&quot;</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>                    System.out.println(e.getMessage());<br>                &#125;<br>            &#125; <span class="hljs-keyword">catch</span> (AWrongException e) &#123;<br>                System.out.println(e.getMessage());<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">try</span> (FileInputStream fileInputStream = <span class="hljs-keyword">new</span> FileInputStream(<span class="hljs-string">&quot;file1.data&quot;</span>);<br>             ObjectInputStream objectInputStream = <span class="hljs-keyword">new</span> ObjectInputStream(fileInputStream)) &#123;<br>            Equation equation = (Equation) objectInputStream.readObject();<br>            System.out.println(<span class="hljs-string">&quot;已将文件\&quot;file1.data\&quot;中的byte数组反序列化为一元二次方程对象&quot;</span>);<br>            equation.display();<br>        &#125; <span class="hljs-keyword">catch</span> (IOException | ClassNotFoundException e) &#123;<br>            System.out.println(e.getMessage());<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="GUI程序"><a href="#GUI程序" class="headerlink" title="GUI程序"></a>GUI程序</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.formdev.flatlaf.FlatLightLaf;<br><br><span class="hljs-keyword">import</span> javax.swing.*;<br><span class="hljs-keyword">import</span> java.awt.*;<br><span class="hljs-keyword">import</span> java.awt.event.*;<br><span class="hljs-keyword">import</span> java.io.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UnivariateQuadraticEquation</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> JPanel mainPanel;<br>    <span class="hljs-keyword">private</span> JTextField textFieldA;<br>    <span class="hljs-keyword">private</span> JTextField textFieldB;<br>    <span class="hljs-keyword">private</span> JTextField textFieldC;<br>    <span class="hljs-keyword">private</span> JButton 求解Button;<br>    <span class="hljs-keyword">private</span> JButton 序列化至文件Button;<br>    <span class="hljs-keyword">private</span> JButton 清空Button;<br>    <span class="hljs-keyword">private</span> JButton 退出Button;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            UIManager.setLookAndFeel(<span class="hljs-keyword">new</span> FlatLightLaf());<br>        &#125; <span class="hljs-keyword">catch</span> (Exception ex) &#123;<br>            System.err.println(<span class="hljs-string">&quot;Failed to initialize LaF&quot;</span>);<br>        &#125;<br><br>        JFrame frame = <span class="hljs-keyword">new</span> JFrame(<span class="hljs-string">&quot;一元二次方程综合工具&quot;</span>);<br><br>        <span class="hljs-keyword">final</span> Toolkit toolkit = Toolkit.getDefaultToolkit();<br>        toolkit.addAWTEventListener(e -&gt; &#123;<br>            <span class="hljs-keyword">if</span> (e.getID() == KeyEvent.KEY_PRESSED) &#123;<br>                KeyEvent evt = (KeyEvent) e;<br>                <span class="hljs-keyword">if</span> (evt.getKeyCode() == KeyEvent.VK_ESCAPE) &#123;<br>                    frame.dispose();  <span class="hljs-comment">// 销毁当前JFrame</span><br>                    System.exit(<span class="hljs-number">0</span>);  <span class="hljs-comment">// 终止当前程序的JVM</span><br>                &#125;<br>            &#125;<br>        &#125;, AWTEvent.KEY_EVENT_MASK);<br><br>        Image icon = toolkit.getImage(<span class="hljs-string">&quot;img/CUMTlogo5.png&quot;</span>);<br>        frame.setIconImage(icon);<br>        frame.setContentPane(<span class="hljs-keyword">new</span> UnivariateQuadraticEquation().mainPanel);<br>        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);<br><span class="hljs-comment">//        frame.setSize(400, 130);</span><br>        frame.pack();<br>        frame.setLocationRelativeTo(<span class="hljs-keyword">null</span>);  <span class="hljs-comment">// 这句话要放在形状设置后，否则是将size(0,0)的窗口居中，造成窗口左上角在中间的情况</span><br>        frame.setResizable(<span class="hljs-keyword">false</span>);<br><span class="hljs-comment">//        frame.getContentPane().setBackground(Color.white);</span><br>        frame.setVisible(<span class="hljs-keyword">true</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">UnivariateQuadraticEquation</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// lambda表达式</span><br>        求解Button.addActionListener(e -&gt; &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">double</span> a = Double.parseDouble(textFieldA.getText());<br>                <span class="hljs-keyword">double</span> b = Double.parseDouble(textFieldB.getText());<br>                <span class="hljs-keyword">double</span> c = Double.parseDouble(textFieldC.getText());<br>                Equation equation = <span class="hljs-keyword">new</span> Equation(a, b, c);<br>                equation.solve();<br>                equation.display();<br>                JOptionPane.showMessageDialog(<span class="hljs-keyword">null</span>, equation.getSolution(), <span class="hljs-string">&quot;成功&quot;</span>, JOptionPane.INFORMATION_MESSAGE);<br>            &#125; <span class="hljs-keyword">catch</span> (NumberFormatException e1) &#123;<br>                JOptionPane.showMessageDialog(<span class="hljs-keyword">null</span>, <span class="hljs-string">&quot;请输入合法的系数！&quot;</span>, <span class="hljs-string">&quot;异常&quot;</span>, JOptionPane.WARNING_MESSAGE);<br>            &#125; <span class="hljs-keyword">catch</span> (AWrongException e2) &#123;<br>                JOptionPane.showMessageDialog(<span class="hljs-keyword">null</span>, e2.getMessage(), <span class="hljs-string">&quot;异常&quot;</span>, JOptionPane.WARNING_MESSAGE);<br><span class="hljs-comment">//                e2.printStackTrace();</span><br>            &#125;<br>        &#125;);<br>        <span class="hljs-comment">// 匿名内部类</span><br>        序列化至文件Button.addActionListener(<span class="hljs-keyword">new</span> ActionListener() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">actionPerformed</span><span class="hljs-params">(ActionEvent e)</span> </span>&#123;<br>                <span class="hljs-keyword">try</span> (FileOutputStream fileOutputStream = <span class="hljs-keyword">new</span> FileOutputStream(<span class="hljs-string">&quot;file1.data&quot;</span>); ObjectOutputStream objectOutputStream = <span class="hljs-keyword">new</span> ObjectOutputStream(fileOutputStream)) &#123;<br>                    <span class="hljs-keyword">double</span> a = Double.parseDouble(textFieldA.getText());<br>                    <span class="hljs-keyword">double</span> b = Double.parseDouble(textFieldB.getText());<br>                    <span class="hljs-keyword">double</span> c = Double.parseDouble(textFieldC.getText());<br>                    Equation equation = <span class="hljs-keyword">new</span> Equation(a, b, c);<br>                    objectOutputStream.writeObject(equation);<br>                    JOptionPane.showMessageDialog(<span class="hljs-keyword">null</span>, <span class="hljs-string">&quot;已将一元二次方程对象序列化为byte数组保存至文件\&quot;file1.data\&quot;中&quot;</span>, <span class="hljs-string">&quot;消息提示&quot;</span>, JOptionPane.INFORMATION_MESSAGE);<br>                &#125; <span class="hljs-keyword">catch</span> (NumberFormatException e1) &#123;<br>                    JOptionPane.showMessageDialog(<span class="hljs-keyword">null</span>, <span class="hljs-string">&quot;请输入合法的系数！&quot;</span>, <span class="hljs-string">&quot;异常&quot;</span>, JOptionPane.WARNING_MESSAGE);<br>                &#125; <span class="hljs-keyword">catch</span> (IOException | AWrongException e2) &#123;<br>                    <span class="hljs-comment">// 这里用word打开可以测试占用</span><br>                    JOptionPane.showMessageDialog(<span class="hljs-keyword">null</span>, e2.getMessage(), <span class="hljs-string">&quot;异常&quot;</span>, JOptionPane.WARNING_MESSAGE);<br>                    e2.printStackTrace();<br>                &#125;<br>            &#125;<br>        &#125;);<br>        清空Button.addActionListener(e -&gt; &#123;<br>            textFieldA.setText(<span class="hljs-string">&quot;&quot;</span>);<br>            textFieldB.setText(<span class="hljs-string">&quot;&quot;</span>);<br>            textFieldC.setText(<span class="hljs-string">&quot;&quot;</span>);<br>        &#125;);<br>        退出Button.addActionListener(e -&gt; System.exit(<span class="hljs-number">0</span>));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="运行截图-7"><a href="#运行截图-7" class="headerlink" title="运行截图"></a>运行截图</h4><h5 id="控制台程序-1"><a href="#控制台程序-1" class="headerlink" title="控制台程序"></a>控制台程序</h5><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112230028159.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112230031849.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112230035155.png" alt=""></p><h5 id="GUI程序-1"><a href="#GUI程序-1" class="headerlink" title="GUI程序"></a>GUI程序</h5><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112230035711.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112230055042.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112230035766.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112230034556.png" alt=""></p><h3 id="分析-9"><a href="#分析-9" class="headerlink" title="分析"></a>分析</h3><p>模拟题，用一些基本的数学知识可以写出核心代码，这里我认为解的形式都应该是<code>double</code>，如果将复数解作为一个整体，那么要么用<code>String</code>表示，要么自己写一个复数类，前者不那么专业，后者使程序复杂，所以我认为将实部（real part）和虚部（imaginary part）拆开都用基本数据类型<code>double</code>表示更优。</p><p>再用一些课上的知识可以写出控制台程序</p><p>GUI程序需要自己学习，不过在周三的课上已经讲了很大一部分，包括监听器的三种回调方式，所以我在课内基本目标外实现的主要有：</p><ol><li>按ESC键退出，知识是任意componet监听，详见GUI程序中的<code>toolkit.addAWTEventListener(...)</code>。</li><li>程序自定义图标，调<code>JFrame.setIconImage(Image)</code>即可，但将其打包到JAR中有难度。</li><li>界面美化，swing支持第三方主题包，我使用的是<code>Intelli IDEA</code>同款主题<code>FlatLaf</code>，使用方法是在项目中导入JAR，之后使用初始化语句<code>UIManager.setLookAndFeel(new FlatLightLaf());</code>即可。另外，可将LookAndFeel译为“观感”。</li></ol><h1 id="作业四"><a href="#作业四" class="headerlink" title="作业四"></a>作业四</h1><h2 id="第一题-3"><a href="#第一题-3" class="headerlink" title="第一题"></a>第一题</h2><h3 id="题目-10"><a href="#题目-10" class="headerlink" title="题目"></a>题目</h3><p>输入三个字符串，分别：</p><ol><li><p>必须满足密码复杂性要求（认证需求）</p></li><li><p>满足身份证号码规范（15位/18位）</p></li><li><p>满足电子邮件规范</p></li></ol><h3 id="答案-5"><a href="#答案-5" class="headerlink" title="答案"></a>答案</h3><h4 id="代码-8"><a href="#代码-8" class="headerlink" title="代码"></a>代码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.homework4.first;<br><br><span class="hljs-keyword">import</span> java.io.Console;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><span class="hljs-keyword">import</span> java.util.regex.Pattern;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isIdCard</span><span class="hljs-params">(String idCard)</span> </span>&#123;<br>        String idCardCheck = <span class="hljs-string">&quot;(^[1-8]\\d((0[1-9])|([1-6][0-9])|70|90)(0[1-9]|1[0-8]|2[1-9]|[3-9][0-9])(19|20)\\d&#123;2&#125;((0[1-9])|(1[0-2]))(([0-2][1-9])|[1-3]0|31)\\d&#123;3&#125;[0-9Xx]$)|&quot;</span> + <span class="hljs-string">&quot;(^[1-8]\\d((0[1-9])|([1-6][0-9])|70|90)(0[1-9]|1[0-8]|2[1-9]|[3-9][0-9])\\d&#123;2&#125;((0[1-9])|(1[0-2]))(([0-2][1-9])|[1-3]0|31)\\d&#123;3&#125;$)&quot;</span>;<br>        <span class="hljs-comment">// 检测空指针和空串</span><br>        <span class="hljs-keyword">if</span> (idCard == <span class="hljs-keyword">null</span> || <span class="hljs-string">&quot;&quot;</span>.equals(idCard)) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        <span class="hljs-comment">// 正则检查格式正确性</span><br>        <span class="hljs-keyword">if</span> (!Pattern.compile(idCardCheck).matcher(idCard).matches()) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        <span class="hljs-comment">// 若为18位则对校验位进行校验</span><br>        <span class="hljs-keyword">if</span> (idCard.length() == <span class="hljs-number">18</span>) &#123;<br>            <span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> index = <span class="hljs-number">0</span>; index &lt; <span class="hljs-number">17</span>; index++)<br>                sum += (Math.pow(<span class="hljs-number">2</span>, <span class="hljs-number">17</span> - index) % <span class="hljs-number">11</span>) * (idCard.charAt(index) - <span class="hljs-string">&#x27;0&#x27;</span>);<br>            <span class="hljs-keyword">char</span> checkBit = (<span class="hljs-keyword">char</span>) (<span class="hljs-string">&#x27;0&#x27;</span> + ((<span class="hljs-number">12</span> - sum % <span class="hljs-number">11</span>) % <span class="hljs-number">11</span>));<br>            checkBit = checkBit == (<span class="hljs-string">&#x27;0&#x27;</span> + <span class="hljs-number">10</span>) ? <span class="hljs-string">&#x27;X&#x27;</span> : checkBit;  <span class="hljs-comment">// 最后一位若为阿拉伯数字10则用罗马数字X表示</span><br>            <span class="hljs-keyword">return</span> Character.toString(checkBit).equalsIgnoreCase(String.valueOf(idCard.charAt(<span class="hljs-number">17</span>)));<br>        &#125;<br>        <span class="hljs-comment">// 若为15位,不需校验</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;欢迎来到邮箱注册程序！&quot;</span>);<br>        <span class="hljs-keyword">try</span> (Scanner scanner = <span class="hljs-keyword">new</span> Scanner(System.in)) &#123;<br>            <span class="hljs-comment">// ^[\\w!#$%&amp;’*+/=?`&#123;|&#125;~^-]+(?:\\.[\\w!#$%&amp;’*+/=?`&#123;|&#125;~^-]+)*@(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]&#123;2,6&#125;$</span><br>            String emailCheck = <span class="hljs-string">&quot;^(?!.*\\.&#123;2&#125;)[A-Za-z][0-9A-Za-z.]&#123;4,13&#125;[0-9A-Za-z](?!(@\\.|@-|.*\\.-|.*\\.&#123;2&#125;)|.*-\\.|.*\\-&#123;2&#125;)@[0-9A-Za-z-]&#123;1,63&#125;(\\.[0-9A-Za-z-]&#123;1,63&#125;)+$&quot;</span>;<br>            String email;<br>            <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>                System.out.println(<span class="hljs-string">&quot;请输入邮箱账号（6~18个字符，可使用字母、数字、下划线，需要以字母开头）&quot;</span>);<br>                email = scanner.nextLine();<br>                <span class="hljs-keyword">if</span> (Pattern.compile(emailCheck).matcher(email).matches()) <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">else</span> System.out.println(<span class="hljs-string">&quot;请检查输入格式！&quot;</span>);<br>            &#125;<br>            <br>            String passwordCheck = <span class="hljs-string">&quot;^(?![A-Za-z0-9]+$)(?![a-z0-9\\W]+$)(?![A-Za-z\\W]+$)(?![A-Z0-9\\W]+$)[a-zA-Z0-9\\W]&#123;8,16&#125;$&quot;</span>;<br>            String password;<br>            <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>                System.out.println(<span class="hljs-string">&quot;请输入密码（8~16个字符，需包含“大小写字母、数字、标点符号”中3种或以上的组合）&quot;</span>);<br><span class="hljs-comment">//                password = scanner.nextLine();</span><br>                Console con = System.console();<br>                password = <span class="hljs-keyword">new</span> String(con.readPassword());  <span class="hljs-comment">// 隐藏输入，在IDE中不可行，因为控制台被重定向了</span><br>                <span class="hljs-keyword">if</span> (Pattern.compile(passwordCheck).matcher(password).matches()) <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">else</span> System.out.println(<span class="hljs-string">&quot;请检查输入格式！&quot;</span>);<br>            &#125;<br><br>            String idCard;<br>            <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>                System.out.println(<span class="hljs-string">&quot;请输入您的真实身份证号码&quot;</span>);<br>                idCard = scanner.nextLine();<br>                <span class="hljs-keyword">if</span> (isIdCard(idCard)) <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">else</span> System.out.println(<span class="hljs-string">&quot;请检查输入格式！&quot;</span>);<br>            &#125;<br>            System.out.println(<span class="hljs-string">&quot;注册成功！&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="运行截图-8"><a href="#运行截图-8" class="headerlink" title="运行截图"></a>运行截图</h4><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201021205793.png" alt=""></p><h3 id="分析-10"><a href="#分析-10" class="headerlink" title="分析"></a>分析</h3><p>构建正则表达式就和写程序一样，要由编译器运行起来才能直观地看到结果，这里可以使用<a href="https://c.runoob.com/front-end/854/">正则表达式在线测试| 菜鸟工具</a></p><h4 id="电子邮件匹配"><a href="#电子邮件匹配" class="headerlink" title="电子邮件匹配"></a>电子邮件匹配</h4><p>首先，要对电子邮件进行匹配，就需要了解电子邮件规范RFC 5322</p><h5 id="RFC-5322"><a href="#RFC-5322" class="headerlink" title="RFC 5322"></a>RFC 5322</h5><p>电子邮件地址的域内部分可以使用以下任何<a href="https://zh.wikipedia.org/wiki/ASCII">ASCII</a>字符：</p><ul><li>大小写拉丁字母<code>A</code>到<code>Z</code>和<code>a</code>到<code>z</code>；</li><li>数字<code>0</code>到<code>9</code>；</li><li>除了字母与数字之外的可打印字符，<code>!#$%&amp;&#39;*+-/=?^_`&#123;|&#125;~</code>；</li><li>点<code>.</code>，但不能作为首尾字符，也不能连续出现，若放在引号中则不受这些限制（例如<code>John..Doe@example.com</code>是不允许的，而<code>&quot;John..Doe&quot;@example.com</code>是允许的）。</li><li>空格和特殊字符<code>&quot;(),:;&lt;&gt;@[\]</code>被允许有限制地使用（域内部分字符串必须放在引号中，后面的段落将会描述，并且，反斜杠或双引号之前，必须加一个反斜杠来转义）；</li><li>允许将注释放在小括号内，并放在域内部分的开头或结尾，例如<code>john.smith(comment)@example.com</code>和<code>(comment)john.smith@example.com</code>都等同于<code>john.smith@example.com</code>。</li></ul><p>电子邮件地址的域名部分必须符合严格的规则：它必须满足对主机名的要求，一个以点分隔的DNS标签序列，每个标签被限定为长度不超过63个字符，且只能由下列字符组成：</p><ul><li>大小写拉丁字母<code>A</code>到<code>Z</code>和<code>a</code>到<code>z</code>；</li><li>数字<code>0</code>到<code>9</code>，但顶级域名不能是纯数字；</li><li>连字符<code>-</code>，但不能作为首尾字符。</li></ul><p>可以看出，RFC 5322电子邮件规范包含范围广泛的特殊字符，虽然在技术上可行，但在实践中往往并不能接受所有这些字符。</p><p>所以我们需要调研知名邮箱的电子邮件规范，我在这里选择了国内最流行的163邮箱和国际最流行的gmail邮箱，他们在格式错误时都会回显原因。</p><h5 id="域内部分"><a href="#域内部分" class="headerlink" title="域内部分"></a>域内部分</h5><p><strong>网易 163邮箱</strong></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201020123477.png" alt=""></p><p>163给出的邮箱规范很具体，我们可以自行测试它的细则。</p><ol><li>邮箱地址需以字母或数字结尾</li></ol><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201020940484.png" alt=""></p><p> <strong>Google gmail邮箱</strong></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201020125971.png" alt=""></p><p>gmail给出的邮箱规范很简洁，我们也可以自行测试它的细则。</p><ol><li>用户名的字符数须介于6到30之间。</li></ol><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201020133746.png" alt=""></p><ol><li>用户名的8个或以上字符中应至少包括一个字母（a-z）</li></ol><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201020943254.png" alt=""></p><ol><li>只能使用字母（a-z）、数字（0-9）和数点（.）</li></ol><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201021030651.png" alt=""></p><ol><li>用户名的最后一个字符必须为ASCII字母（a-z）或数字（0-9）</li></ol><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201020943237.png" alt=""></p><ol><li>用户名中不能包含连续的数点（.）</li></ol><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201021015819.png" alt=""></p><p>我还对Microsoft outlook邮箱的电子邮件规范进行了调研，个人认为outlook邮箱的格式太过宽泛（比如单个字母可以作为用户名，且用户名最长可达65位），实现出来并不利于使用。</p><p>对以上规范进行总结，得到实践中的电子邮件规范：</p><ol><li>用户名的字符数介于一定范围</li><li>可用字符为大小写字母（<code>a-z</code>和<code>A-Z</code>）、数字（<code>0-9</code>）、一些特殊符号（<code>-_.</code>）</li><li>用户名至少包含一个字母（有些邮箱要求其在开头，有些邮箱在小于一定长度时不要求）</li><li>用户名的结束字符为字母或数字（有些邮箱允许<code>_-</code>）</li></ol><p>那么我们可以制定一个属于自己的、简易的邮箱规范：</p><ol><li><strong>用户名的字符数须介于6到15之间；</strong></li><li><strong>用户名可使用字母（<code>a-z</code>和<code>A-Z</code>）、数字（<code>0-9</code>）、数点（<code>.</code>）；</strong></li><li><strong>用户名需要以字母（<code>a-z</code>和<code>A-Z</code>）开头；</strong></li><li><strong>用户名中不能包含连续的数点（<code>.</code>）；</strong></li><li><strong>用户名需要以字母或数字（<code>a-z</code>和<code>A-Z</code>和<code>0-9</code>）结尾。</strong></li></ol><p>开始构建表达式吧！</p><ul><li><code>^</code>正则表达式开始符</li><li><code>(?!.*\.&#123;2&#125;)</code>不允许两个以上的句点（环视技术，详见1.3.2）</li><li><code>[A-Za-z]</code>开头部分的拉丁字母</li><li><code>[0-9A-Za-z.]&#123;4,13&#125;</code>中间部分的允许字符</li><li><code>[0-9A-Za-z]</code>结尾部分的拉丁字母或数字</li><li><code>$</code>正则表达式结束符</li></ul><p>最后可得</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;^(?!.*\.&#123;2&#125;)[A-Za-z][0-9A-Za-z.]&#123;4,13&#125;[0-9A-Za-z]$&quot;</span><br></code></pre></td></tr></table></figure><p>当然我也搜索学习了RFC 5322电子邮件规范的正则匹配表达式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;^[\w!#$%&amp;’*+/=?`&#123;|&#125;~^-]+(?:\.[\\w!#$%&amp;’*+/=?`&#123;|&#125;~^-]+)*$&quot;</span><br></code></pre></td></tr></table></figure><h5 id="域名部分"><a href="#域名部分" class="headerlink" title="域名部分"></a>域名部分</h5><p>RFC 5322制定的电子邮件规范在这里需求较少，直接构建正则表达式即可。</p><ul><li><code>^</code>正则表达式开始符</li><li><code>(?!(@\.|@-|.*\.-|.*\.&#123;2&#125;)|.*-\.|.*\-&#123;2&#125;)</code> <code>@</code>后不能接<code>.</code>，<code>@</code>后不能接<code>-</code> ，<code>.</code>后不能接<code>-</code>，<code>.</code>后不能接<code>.</code>，<code>-</code>后不能接<code>.</code>，<code>-</code>后不能接·<code>-</code></li><li><code>@[0-9A-Za-z-]&#123;1,63&#125;</code>第一段DNS标签（@开头），出现一次</li><li><code>(\.[0-9A-Za-z-]&#123;1,63&#125;)+</code>第二段DNS标签及其之后的DNS标签（.开头），出现至少一次（用<code>+</code>匹配）</li><li><code>$</code>正则表达式结束符</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;^(?!(@\.|@-|.*\.-|.*\.&#123;2&#125;)|.*-\.|.*\-&#123;2&#125;)@[0-9A-Za-z-]&#123;1,63&#125;(\.[0-9A-Za-z-]&#123;1,63&#125;)+$&quot;</span><br></code></pre></td></tr></table></figure><p>综上，得到最终电子邮件匹配正则表达式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;^(?!.*\.&#123;2&#125;)[A-Za-z][0-9A-Za-z.]&#123;4,13&#125;[0-9A-Za-z](?!(@\.|@-|.*\.-|.*\.&#123;2&#125;)|.*-\.|.*\-&#123;2&#125;)@[0-9A-Za-z-]&#123;1,63&#125;(\.[0-9A-Za-z-]&#123;1,63&#125;)+$&quot;</span><br></code></pre></td></tr></table></figure><p>经测试，可以实现上述的所有功能，放一张成功匹配的截图。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201021158510.png" alt=""></p><h4 id="密码匹配"><a href="#密码匹配" class="headerlink" title="密码匹配"></a>密码匹配</h4><p>同样地，首先我们需要制定一个密码复杂性要求。</p><p>对于密码，或者说口令，并没有严格的规范，我们先看一下163邮箱的密码复杂性要求。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201021457100.png" alt=""></p><p>我们可以在此基础上制定一个更严格的复杂性要求：</p><ol><li><strong>8~16个字符</strong></li><li><strong>需包含“大写字母、小写字母、数字、标点符号”中4种或以上的组合</strong></li></ol><p>因为只对字符集进行了规定，所以很好构建正则表达式。</p><p>我们先来了解一下<strong>环视</strong></p><p>环视（Lookaround）：匹配一个位置而不是字符，因此匹配的结果也可称为零宽字符。具体包括</p><ol><li><p>Lookahead</p></li><li><p>Lookbehind</p></li></ol><p>Lookahead，中文译作<strong>“正向预查”</strong>，其实字面意思就是<strong>向前看</strong>，也就是向字符串的右边看。</p><p>Lookbehind，中文译作<strong>“负向预查”</strong>，其实字面意思就是<strong>向后看</strong>，也就是向字符串的左边看。</p><p>接下来介绍一下环视所使用的符号</p><div class="table-container"><table><thead><tr><th>符号</th><th>意义</th></tr></thead><tbody><tr><td>(</td><td>环视起始符</td></tr><tr><td>?</td><td>零宽字符，也就是位置，后续的操作就是选出合适的位置</td></tr><tr><td>&lt;</td><td>Lookbehind，向零宽字符的左边看</td></tr><tr><td>（啥也不加，缺省）</td><td>Lookahead，向零宽字符的右边看</td></tr><tr><td>=</td><td>肯定形式，选出满足（有）其后pattern的零宽字符</td></tr><tr><td>!</td><td>否定形式，选出不满足（没有）其后pattern的零宽字符</td></tr><tr><td>$</td><td>字符串结尾</td></tr><tr><td>)</td><td>环视结束符</td></tr></tbody></table></div><p>在这里直接对我的正则表达式进行说明即可理解环视。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;^(?![A-Za-z0-9]+$)(?![a-z0-9\\W]+$)(?![A-Za-z\\W]+$)(?![A-Z0-9\\W]+$)[a-zA-Z0-9\\W]&#123;8,16&#125;$&quot;</span><br></code></pre></td></tr></table></figure><p>首先我们知道四种字符，其共有$\sum\limits<em>{i=1}^{4} C</em>{4}^{i}=4+6+4+1=15$种情况，接下来要对除了$C_{4}^{4}$这种全选情况外的情况进行排除。</p><ul><li><code>^</code>正则表达式开始符</li><li><code>(?![0-9A-Za-z]+$)</code>对整个字符串选出零宽字符后没有数字、大写字母、小写字母三者组合（$\sum\limits<em>{i=1}^{3} C</em>{3}^{i}$）的零宽字符</li><li><code>(?![0-9a-z\\W]+$)</code>对整个字符串选出零宽字符后没有数字、小写字母、标点符号三者组合（$\sum\limits<em>{i=1}^{3} C</em>{3}^{i}$）的零宽字符</li><li><code>(?![A-Za-z\\W]+$)</code>对整个字符串选出零宽字符后没有大写字母、小写字母、标点符号三者组合（$\sum\limits<em>{i=1}^{3} C</em>{3}^{i}$）的零宽字符</li><li><code>(?![0-9A-Z\\W]+$)</code>对整个字符串选出零宽字符后没有数字、大写字母、标点符号三者组合（$\sum\limits<em>{i=1}^{3} C</em>{3}^{i}$）的零宽字符</li><li><code>[0-9A-Za-z\\W]&#123;8,16&#125;</code>从选出的零宽字符起，选中含有8~16个数字、大写字母、小写字母、标点符号的字符串。进行到这步时，因为前面几种环视已经排除掉了$\sum\limits<em>{i=1}^{3} C</em>{4}^{i}=14$种情况，所以选中的字符串必是四种符号的全选情况。</li><li><code>$</code>正则表达式结束符</li></ul><p>这其中<code>\W</code>代表匹配任何非单词字符，当然也可以自己指定允许的标点符号集合（注意这个转义字符包含<code>_</code>）。</p><p>下两张图可区分选中零宽字符和选中字符串。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201021540551.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201021545898.png" alt=""></p><h4 id="身份证号码匹配"><a href="#身份证号码匹配" class="headerlink" title="身份证号码匹配"></a>身份证号码匹配</h4><h5 id="格式匹配"><a href="#格式匹配" class="headerlink" title="格式匹配"></a>格式匹配</h5><p>对百位数以下的数字匹配时可以想象出一个每行10个数的表格（个位数0-9），中括号匹配时相当于用矩形选中，每次可能框最多的元素</p><p>十八位身份证正则表达式说明：</p><ul><li><code>^</code>                                                                                  正则表达式开头</li><li><code>[1-8]</code>                                                                          大区制代码，全国共分1-8八个大区</li><li><code>\\d</code>                                                                              省市编码</li><li><code>( (0[1-9]) | ([1-6][0-9]) | 70 | 90 )</code>       地级行政区：01-70一般 90直辖</li><li><code>( 0[1-9] | 1[0-8] | 2[1-9] |[3-9][0-9] )</code> 县级行政区：01-18、21-99</li><li><code>( 19|20 )</code>                                                                  生日期码，年份前两位</li><li><code>\\d&#123;2&#125;</code>                                                                        生日期码，年份后两位</li><li><code>( (0[1-9]) | (1[0-2]) )</code>                                    生日期码，月份</li><li><code>( ([0-2][1-9]) | [1-3]0 |31 )</code>                        生日期码，日期</li><li><code>\\d&#123;3&#125;</code>                                                                        顺序码</li><li><code>[0-9Xx]</code>                                                                      校验码,这里只判断格式而不校验</li><li><code>$</code>                                                                                   正则表达式结尾<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;^[1-8]\\d((0[1-9])|([1-6][0-9])|70|90)(0[1-9]|1[0-8]|2[1-9]|[3-9][0-9])(19|20)\\d&#123;2&#125;((0[1-9])|(1[0-2]))(([0-2][1-9])|[1-3]0|31)\\d&#123;3&#125;[0-9Xx]$&quot;</span><br></code></pre></td></tr></table></figure>十五位身份证正则表达式说明：<br>只是在十八位身份证的基础上去掉了 <strong>生日期码，年份前两位</strong> 和 <strong>校验码</strong>。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-string">&quot;^[1-8]\\d((0[1-9])|([1-6][0-9])|70|90)(0[1-9]|1[0-8]|2[1-9]|[3-9][0-9])       \\d&#123;2&#125;((0[1-9])|(1[0-2]))(([0-2][1-9])|[1-3]0|31)\\d&#123;3&#125;       $&quot;</span><br></code></pre></td></tr></table></figure><h5 id="校验码检查"><a href="#校验码检查" class="headerlink" title="校验码检查"></a>校验码检查</h5><p>首先了解一下校验码生成算法</p><ol><li><p>将身份证号码从左至右标记为 <script type="math/tex">{\displaystyle a_{1},a_{2},\cdots ,a_{18}}</script>；$a_{18}$即为校验码；</p></li><li><p>计算权重系数${\displaystyle W_{i}=2^{18-i}\ {\bmod {\ }}{11}}$；其中${\displaystyle \ {\bmod {\ }}}$表示求余数。</p></li></ol><p>所以：</p><div class="table-container"><table><thead><tr><th style="text-align:center"><em>i</em></th><th style="text-align:center">1</th><th style="text-align:center">2</th><th style="text-align:center">3</th><th style="text-align:center">4</th><th style="text-align:center">5</th><th style="text-align:center">6</th><th style="text-align:center">7</th><th style="text-align:center">8</th><th style="text-align:center">9</th><th style="text-align:center">10</th><th style="text-align:center">11</th><th style="text-align:center">12</th><th style="text-align:center">13</th><th style="text-align:center">14</th><th style="text-align:center">15</th><th style="text-align:center">16</th><th style="text-align:center">17</th><th style="text-align:center">18</th></tr></thead><tbody><tr><td style="text-align:center"><em>Wi</em></td><td style="text-align:center">7</td><td style="text-align:center">9</td><td style="text-align:center">10</td><td style="text-align:center">5</td><td style="text-align:center">8</td><td style="text-align:center">4</td><td style="text-align:center">2</td><td style="text-align:center">1</td><td style="text-align:center">6</td><td style="text-align:center">3</td><td style="text-align:center">7</td><td style="text-align:center">9</td><td style="text-align:center">10</td><td style="text-align:center">5</td><td style="text-align:center">8</td><td style="text-align:center">4</td><td style="text-align:center">2</td><td style="text-align:center">1</td></tr></tbody></table></div><ol><li><p>计算${\displaystyle S=\sum <em>{i=1}^{17}a</em>{i}\cdot W_{i}}$</p></li><li><p>${\displaystyle a_{18}=(12-(S\ {\bmod {1}}1)){\bmod {1}}1}$</p></li></ol><p>那么根据算法，很容易写出程序。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">int</span> sum = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> index = <span class="hljs-number">0</span>; index &lt; <span class="hljs-number">17</span>; index++)<br>sum += (Math.pow(<span class="hljs-number">2</span>, <span class="hljs-number">17</span> - index) % <span class="hljs-number">11</span>) * (idCard.charAt(index) - <span class="hljs-string">&#x27;0&#x27;</span>);<br><span class="hljs-keyword">char</span> checkBit = (<span class="hljs-keyword">char</span>) (<span class="hljs-string">&#x27;0&#x27;</span> + ((<span class="hljs-number">12</span> - sum % <span class="hljs-number">11</span>) % <span class="hljs-number">11</span>));<br>checkBit = checkBit == (<span class="hljs-string">&#x27;0&#x27;</span> + <span class="hljs-number">10</span>) ? <span class="hljs-string">&#x27;X&#x27;</span> : checkBit;  <span class="hljs-comment">// 最后一位若为阿拉伯数字10则用罗马数字X表示</span><br></code></pre></td></tr></table></figure><h2 id="第二题-3"><a href="#第二题-3" class="headerlink" title="第二题"></a>第二题</h2><h3 id="题目-11"><a href="#题目-11" class="headerlink" title="题目"></a>题目</h3><p>利用鼠标事件启动3个线程分别在三个窗口中同时绘制动态图形（图形自选）。</p><h3 id="答案-6"><a href="#答案-6" class="headerlink" title="答案"></a>答案</h3><h4 id="代码-9"><a href="#代码-9" class="headerlink" title="代码"></a>代码</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.homework4.second;<br><br><br><span class="hljs-keyword">import</span> com.formdev.flatlaf.FlatLightLaf;<br><br><span class="hljs-keyword">import</span> javax.swing.*;<br><span class="hljs-keyword">import</span> java.awt.*;<br><span class="hljs-keyword">import</span> java.awt.event.MouseAdapter;<br><span class="hljs-keyword">import</span> java.awt.event.MouseEvent;<br><span class="hljs-keyword">import</span> java.net.URL;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestFrame</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">JFrame</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Runnable</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TestFrame</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);<br>        <span class="hljs-keyword">this</span>.addMouseListener(<span class="hljs-keyword">new</span> MouseAdapter() &#123;<br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">mouseClicked</span><span class="hljs-params">(MouseEvent e)</span> </span>&#123;<br>                startThread();<br>            &#125;<br>        &#125;);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">startThread</span><span class="hljs-params">()</span> </span>&#123;<br>        Thread t1 = <span class="hljs-keyword">new</span> Thread(<span class="hljs-keyword">this</span>);<br>        t1.start();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">1</span>; ; i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">10</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                repaint();<br>                Thread.sleep(<span class="hljs-number">500</span>);<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                JOptionPane.showMessageDialog(<span class="hljs-keyword">null</span>, e.getMessage(), <span class="hljs-string">&quot;Exceptions&quot;</span>, JOptionPane.WARNING_MESSAGE);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">paint</span><span class="hljs-params">(Graphics g)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>.paint(g);<br>        <span class="hljs-keyword">int</span>[] x = &#123;<span class="hljs-number">80</span> + i * <span class="hljs-number">10</span>, <span class="hljs-number">100</span> + i * <span class="hljs-number">10</span>, <span class="hljs-number">50</span> + i * <span class="hljs-number">10</span>&#125;;<br>        <span class="hljs-keyword">int</span>[] y = &#123;<span class="hljs-number">50</span> + i * <span class="hljs-number">10</span>, <span class="hljs-number">100</span> + i * <span class="hljs-number">10</span>, <span class="hljs-number">80</span> + i * <span class="hljs-number">10</span>&#125;;<br>        <span class="hljs-keyword">if</span> (i != <span class="hljs-number">0</span>) &#123;<br>            g.drawPolygon(x, y, <span class="hljs-number">3</span>);<br><span class="hljs-comment">//            g.fillOval(50 + i * 10, 50 + i * 10, 100, 100);</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            UIManager.setLookAndFeel(<span class="hljs-keyword">new</span> FlatLightLaf());<br>        &#125; <span class="hljs-keyword">catch</span> (Exception ex) &#123;<br>            System.err.println(<span class="hljs-string">&quot;Failed to initialize LaF&quot;</span>);<br>        &#125;<br>        URL imgURL = TestFrame.class.getResource(<span class="hljs-string">&quot;CUMTlogo.png&quot;</span>);<br>        ImageIcon imageIcon = <span class="hljs-keyword">new</span> ImageIcon(imgURL);<br>        Image image = imageIcon.getImage();<br><br>        TestFrame testFrame1 = <span class="hljs-keyword">new</span> TestFrame();<br>        testFrame1.setBounds(<span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">300</span>, <span class="hljs-number">300</span>);<br>        testFrame1.setIconImage(image);<br>        testFrame1.setTitle(<span class="hljs-string">&quot;Thread1&quot;</span>);<br>        testFrame1.setVisible(<span class="hljs-keyword">true</span>);<br><br>        TestFrame testFrame2 = <span class="hljs-keyword">new</span> TestFrame();<br>        testFrame2.setBounds(<span class="hljs-number">400</span>, <span class="hljs-number">200</span>, <span class="hljs-number">300</span>, <span class="hljs-number">300</span>);<br>        testFrame2.setIconImage(image);<br>        testFrame2.setTitle(<span class="hljs-string">&quot;Thread2&quot;</span>);<br>        testFrame2.setVisible(<span class="hljs-keyword">true</span>);<br><br>        TestFrame testFrame3 = <span class="hljs-keyword">new</span> TestFrame();<br>        testFrame3.setBounds(<span class="hljs-number">700</span>, <span class="hljs-number">200</span>, <span class="hljs-number">300</span>, <span class="hljs-number">300</span>);<br>        testFrame3.setIconImage(image);<br>        testFrame3.setTitle(<span class="hljs-string">&quot;Thread3&quot;</span>);<br>        testFrame3.setVisible(<span class="hljs-keyword">true</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="运行截图-9"><a href="#运行截图-9" class="headerlink" title="运行截图"></a>运行截图</h4><p>三个Frame启动三个Thread，图形绘制时刻由鼠标点击时刻决定。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201021721091.png" alt=""></p><h3 id="分析-11"><a href="#分析-11" class="headerlink" title="分析"></a>分析</h3><p>与课上例题没什么区别，例题创建了一个Frame，每个Frame点击后可启动Thread。那完成基本的要求只需要在主函数里再声明两个Frame即可。</p><p>为增强可读性，我将图形绘制改为了循环绘制，另外将例题中原程序的实心圆改为了指向右下方的三角形，更改了主题、自定义了图标、增加了异常弹窗等，都是上次GUI作业中使用过的方法。</p>]]></content>
    
    
    <categories>
      
      <category>编程语言</category>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>散乱的知识之塔</title>
    <link href="/2021/12/11/%E6%95%A3%E4%B9%B1%E7%9A%84%E7%9F%A5%E8%AF%86%E4%B9%8B%E5%A1%94/"/>
    <url>/2021/12/11/%E6%95%A3%E4%B9%B1%E7%9A%84%E7%9F%A5%E8%AF%86%E4%B9%8B%E5%A1%94/</url>
    
    <content type="html"><![CDATA[<h1 id="latex中的各种mod"><a href="#latex中的各种mod" class="headerlink" title="latex中的各种mod"></a>latex中的各种mod</h1><p>\bmod - 最细间距，无括号，不分行间行内<br>\pmod - 有括号，行间间距大，行内间距稍小<br>\mod - 无括号，其余同 \pmod<br>\pod - 无 mod ，其余同 \pmod</p><p>源代码：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs latex">a \equiv b \bmod p<br>a \equiv b \pmod p<br>a \equiv b \mod p<br>a \equiv b \pod p<br></code></pre></td></tr></table></figure></p><p>行间效果：</p><script type="math/tex; mode=display">a \equiv b \bmod p</script><script type="math/tex; mode=display">a \equiv b \pmod p</script><script type="math/tex; mode=display">a \equiv b \mod p</script><script type="math/tex; mode=display">a \equiv b \pod p</script><p>行内效果：</p><p>$ a \equiv b \bmod p $<br>$ a \equiv b \pmod p $<br>$ a \equiv b \mod p $<br>$ a \equiv b \pod p $</p><p>我觉得 $(2)$ 好看</p><h1 id="命令行算MD5"><a href="#命令行算MD5" class="headerlink" title="命令行算MD5"></a>命令行算MD5</h1><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202202171023825.png" alt=""></p><h1 id="一个思考：为什么bool类型不用1bit而用1byte表示？"><a href="#一个思考：为什么bool类型不用1bit而用1byte表示？" class="headerlink" title="一个思考：为什么bool类型不用1bit而用1byte表示？"></a>一个思考：为什么bool类型不用1bit而用1byte表示？</h1><p>答：bit无法直接寻址，byte可以。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202202151915698.png" alt=""></p><h1 id="一个ERROR"><a href="#一个ERROR" class="headerlink" title="一个ERROR"></a>一个ERROR</h1><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202202100211493.png" alt=""></p><p>内存开太大导致地址值超过了int上界。</p><h1 id="关于…"><a href="#关于…" class="headerlink" title="关于…"></a>关于…</h1><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201232201014.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201232203797.png" alt=""></p><p>可见<code>...</code>是一个<code>ellipsis</code>对象。</p><p>如果某个函数体中只有<code>...</code>，意思也就是创造了一个<code>ellipsis</code>对象但没有使用，那自然跟函数体中只有<code>pass</code>差不多，代表这个函数目前还没有实现。</p><p>在numpy中的使用方法</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201232205676.png" alt=""></p><p>这个实际上是numpy中的array多维切片</p><p>首先，多维切片的形式是</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">array[<span class="hljs-built_in">slice</span>, <span class="hljs-built_in">slice</span>, etc]<br></code></pre></td></tr></table></figure><p>其中，每个slice对象的形式为<code>start:stop:step</code></p><p>与python内置list的切片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">list</span>[<span class="hljs-built_in">slice</span>][<span class="hljs-built_in">slice</span>]etc<br></code></pre></td></tr></table></figure><p>差不多一个意思</p><p>第0个slice代表对dim-0切片</p><p>第1个slice代表对dim-1切片</p><p>那么上述语句的意思即为</p><p><code>d[1,...]</code>：取d的<code>dim-0</code>中下标为1的元素</p><p><code>d[...,1]</code>：取d的<code>dim-(-1)</code>（最后一个维度）中所有下标为1的元素</p><p><code>d[1,...,1]</code>：取d的<code>dim-0</code>中下标1的元素，再取其<code>dim-(-1)</code>中所有下标为1的元素</p><p>numpy官方文档中对…的说明及复现</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201232217120.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201232216717.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201232218765.png" alt=""></p><h1 id="快速发博客"><a href="#快速发博客" class="headerlink" title="快速发博客"></a>快速发博客</h1><p>灵光一闪写了个批处理，所以我为什么手敲了一个学期这三段东西啊！！</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201231145944.png" alt=""></p><h1 id="python拆包"><a href="#python拆包" class="headerlink" title="python拆包"></a>python拆包</h1><p>做线性回归的时候碰到了一个少见的用法</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201231127376.png" alt=""></p><p>查了一下这个语法叫拆包，其实在函数定义时就学过，可变参数就是这个原理。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201231126045.png" alt=""></p><p>在<code>PEP 448</code>中找到了提出者的一个奇妙用法：</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201231133325.png" alt=""></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">new_list=my_list+<span class="hljs-built_in">list</span>(my_tuple)+<span class="hljs-built_in">list</span>(my_range)<br><span class="hljs-comment"># 等价于</span><br>new_list=[*my_list,*my_tuple,*my_range]<br></code></pre></td></tr></table></figure><p>简直是太太太太pythonnic了！</p><h1 id="ipynb文件的优雅打开方式"><a href="#ipynb文件的优雅打开方式" class="headerlink" title="ipynb文件的优雅打开方式"></a>ipynb文件的优雅打开方式</h1><p>其一 将某个终端加入右键菜单</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201211215563.png" alt=""></p><p>其二 单行powershell</p><p>资源管理器的地址栏可以视作一个单行powershell，你可以在这里输入命令。</p><p>eg. <code>cmd</code> <code>jupyter notebook</code> <code>jupyter lab</code></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201211217950.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201211224748.png" alt="发博客三连"></p><p>其三 设置默认程序</p><p><code>jupyter notebook</code>其实是一个python程序</p><p>使用<code>where</code>命令查找它的位置</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201211219144.png" alt=""></p><p>复制前面的路径设置默认程序即可</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201211219369.png" alt=""></p><p>成功后</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202201211221902.png" alt=""></p><h1 id="python-jit"><a href="#python-jit" class="headerlink" title="python @jit"></a>python @jit</h1><p>python可以使用<code>@jit</code>装饰器达到媲美C++的运行速度。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> numba <span class="hljs-keyword">import</span> jit<br><span class="hljs-keyword">import</span> time<br><br>SIZE=<span class="hljs-number">10000</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">normal_test</span>():</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(SIZE):<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(SIZE):<br>            <span class="hljs-keyword">pass</span><br><br><span class="hljs-meta">@jit</span><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">jit_test</span>():</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(SIZE):<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(SIZE):<br>            <span class="hljs-keyword">pass</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span><br>    start=time.time()<br>    normal_test()<br>    end=time.time()<br>    <span class="hljs-built_in">print</span>(end-start)<br>    <br>    start=time.time()<br>    jit_test()<br>    end=time.time()<br>    <span class="hljs-built_in">print</span>(end-start)<br><br>    start=time.time()<br>    jit_test()<br>    end=time.time()<br>    <span class="hljs-built_in">print</span>(end-start)<br><br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>.<span class="hljs-number">5333094596862793</span><br><span class="hljs-attribute">0</span>.<span class="hljs-number">2395479679107666</span><br><span class="hljs-attribute">0</span>.<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>JIT使用懒编译（Lazy Compilation）技术，在执行到<code>@jit</code>代码块时才将其编译，而纯编译型语言C会在程序运行前整个编译好。</p><p>因为被<code>@jit</code>修饰的代码块已经编译过了，$总时间 = 编译时间 + 运行时间$，所以第二次运行时$编译时间=0$，又因为循环体内为pass，所以<script type="math/tex">运行时间=0</script>，故<script type="math/tex">总时间=0</script></p><p>另外，原生python慢的原因还有一点在于解释器需要推断变量类型，<code>@jit</code>可以使用<code>Eager Compilation</code>技术，指定变量类型，这样可以提高编译速度。</p><h1 id="C初始化列表"><a href="#C初始化列表" class="headerlink" title="C初始化列表"></a>C初始化列表</h1><p>翻看C98、C99标准时偶然发现了从没见过的初始化方式。可以在初始化块中忽略对象直接指定初始化成员。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112111411363.png" alt=""></p><p>另外，C++官方提供了在线编译环境，支持到C++14。</p><p><a href="http://cpp.sh/">C++ shell</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>《Java语言及网络编程》课后小结</title>
    <link href="/2021/11/29/%E3%80%8AJava%E8%AF%AD%E8%A8%80%E5%8F%8A%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E3%80%8B%E8%AF%BE%E5%90%8E%E5%B0%8F%E7%BB%93/"/>
    <url>/2021/11/29/%E3%80%8AJava%E8%AF%AD%E8%A8%80%E5%8F%8A%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E3%80%8B%E8%AF%BE%E5%90%8E%E5%B0%8F%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h1 id="《Java语言及网络编程》课后小结"><a href="#《Java语言及网络编程》课后小结" class="headerlink" title="《Java语言及网络编程》课后小结"></a>《Java语言及网络编程》课后小结</h1><h1 id="What’s-Java"><a href="#What’s-Java" class="headerlink" title="What’s Java?"></a>What’s Java?</h1><h2 id="Java的设计哲学"><a href="#Java的设计哲学" class="headerlink" title="Java的设计哲学"></a>Java的设计哲学</h2><p>每一种语言都有它的设计哲学，如python的准则——著名的“python之禅”。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112192119542.png" alt=""></p><p>那么我们所熟知的C++呢？C++之父在《C++语言的设计和演化》一书中写出了C++的目标与一般性规则（Chap4 C++语言设计规则）。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112192132245.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112192133693.png" alt="image-20211219213320557"></p><p>可以看到，这似乎与python是相反的设计理念——python希望开发者“用一种方法，最好是只有一种方法来做一件事”，“Beautiful is better than ugly.”，而C++希望“总提供一条转变的通路”、“为每种应该支持的风格提供全面支持”。</p><p>私以为C++的设计理念导致了它如今的些许落寞——很多人认为C++是他们痛苦记忆的根源，连《Java核心技术》中都写道</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112192148407.png" alt=""></p><p>但不可否认，现代C++是难入门的、复杂的、效率高的、熟悉后很实用的一门语言。</p><p>那么Java呢？它的设计理念是什么？</p><p>Java的设计者编写了一本颇有影响力的“<a href="https://www.oracle.com/java/technologies/language-environment.html">白皮书</a>”用于解释设计的初衷及完成的情况。</p><p>它的摘要中写道</p><p><strong>1.2.1 简单、面向对象、熟悉</strong></p><p><strong>1.2.2 健壮和安全</strong></p><p><strong>1.2.3 架构中立且可移植</strong></p><p><strong>1.2.4 高性能</strong></p><p><strong>1.2.5 解释型、线程型和动态型</strong></p><p>拆开来就是</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112192204165.png" alt=""></p><p>另外，这本白皮书每章前面都有一些名言，我很喜欢。eg.</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112192215828.png" alt=""></p><p>这是一些具体的设计原则，更加抽象的如下</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112192209889.png" alt=""></p><p>因为课程还没有上完，所以我对它的理解是：类似C++的、全面向对象的、支持网络编程的、比C++简单且安全的一门语言。</p><h2 id="Java的各种专业名词"><a href="#Java的各种专业名词" class="headerlink" title="Java的各种专业名词"></a>Java的各种专业名词</h2><p>老师上课总说的Java SE 5是什么？JDK1.5又是什么？为什么配套的东西会有两个版本号？</p><p>详见《Java核心编程》Chap2</p><div class="table-container"><table><thead><tr><th>Java SE版本</th><th>JDK版本</th><th>发布时间</th><th>开发代号</th></tr></thead><tbody><tr><td>Oak</td><td></td><td>1995-05-23</td><td>Oak(橡树)</td></tr><tr><td>Java 1.0</td><td>JDK1.0</td><td>1996-01-23</td><td></td></tr><tr><td>Java 1.1</td><td>JDK1.1</td><td>1997-02-18</td><td></td></tr><tr><td>J2SE 1.2</td><td>JDK1.2</td><td>1998-12-04</td><td>Playground（运动场）</td></tr><tr><td>J2SE 1.3</td><td>JDK1.3</td><td>2000-05-08</td><td>Kestrel（美洲红隼）</td></tr><tr><td>J2SE 1.4</td><td>JDK1.4</td><td>2002-02-13</td><td>Merlin（灰背隼）</td></tr><tr><td>Java SE 5.0</td><td>JDK1.5</td><td>2004-09-29</td><td>Tiger（老虎）</td></tr><tr><td>Java SE 6</td><td>JDK1.6</td><td>2006-12-11</td><td>Mustang（野马）</td></tr><tr><td>Java SE 7</td><td>JDK1.7</td><td>2011-07-28</td><td>Dolphin（海豚）</td></tr><tr><td>Java SE 8</td><td>JDK1.8</td><td>2014-03-18</td><td>Spider（蜘蛛）</td></tr><tr><td>Java SE 9</td><td>JDK1.9</td><td>2017-09-21</td><td></td></tr><tr><td>Java SE 10</td><td>JDK10</td><td>2018-03-21</td><td></td></tr><tr><td>Java SE 11</td><td>JDK11</td><td>2018-09-25</td><td></td></tr><tr><td>Java SE 12</td><td>JDK12</td><td>2019-3-20</td></tr></tbody></table></div><p>另外，相比于“懒惰”的C++，“勤奋”的Java的更新频率要高得多。（C++语言近几次更新的标准是C++20、C++17、C++14、C++11、C++03、C++98，要么很久不更新，要么一更新就带来一大堆全新特性，近几年因感受到了威胁，C++委员会提高了更新频率）。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112192217638.png" alt=""></p><h1 id="11-29-基本语法"><a href="#11-29-基本语法" class="headerlink" title="11.29 基本语法"></a>11.29 基本语法</h1><ol><li><p>发现java17中的<code>java &lt;file&gt;.java</code>似乎只能编译单个类</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111291010551.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111291011178.png" alt=""></p><p>另外，想要从指令路径中运行class，需要使用<code>java -classpath &lt;dir&gt; &lt;file&gt;</code>命令</p><p>所以vscode中java对应的task.json可以这样配置</p> <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>    <span class="hljs-comment">// See https://go.microsoft.com/fwlink/?LinkId=733558</span><br>    <span class="hljs-comment">// for the documentation about the tasks.json format</span><br>    <span class="hljs-attr">&quot;version&quot;</span>: <span class="hljs-string">&quot;2.0.0&quot;</span>,<br>    <span class="hljs-attr">&quot;tasks&quot;</span>: [<br>     &#123;<br>      <span class="hljs-attr">&quot;label&quot;</span>: <span class="hljs-string">&quot;javac&quot;</span>,<br>      <span class="hljs-attr">&quot;command&quot;</span>: <span class="hljs-string">&quot;javac $&#123;file&#125; -d $&#123;fileDirname&#125;\\bin&quot;</span>,<br>      <span class="hljs-comment">// &quot;command&quot;: &quot;javac $&#123;file&#125;&quot;,</span><br>      <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;shell&quot;</span>,<br>      <span class="hljs-attr">&quot;group&quot;</span>: &#123;<br>          <span class="hljs-attr">&quot;kind&quot;</span>: <span class="hljs-string">&quot;build&quot;</span>,<br>          <span class="hljs-attr">&quot;isDefault&quot;</span>: <span class="hljs-literal">true</span><br>      &#125;,<br>      <span class="hljs-attr">&quot;presentation&quot;</span>: &#123;<br>          <span class="hljs-attr">&quot;reveal&quot;</span>: <span class="hljs-string">&quot;always&quot;</span>,<br>          <span class="hljs-attr">&quot;panel&quot;</span>: <span class="hljs-string">&quot;new&quot;</span>,<br>          <span class="hljs-attr">&quot;focus&quot;</span>: <span class="hljs-literal">true</span><br>      &#125;<br>     &#125;,<br>     &#123;<br>      <span class="hljs-attr">&quot;label&quot;</span>: <span class="hljs-string">&quot;run&quot;</span>,<br>      <span class="hljs-attr">&quot;command&quot;</span>: <span class="hljs-string">&quot;java -classpath $&#123;fileDirname&#125;\\bin $&#123;fileBasenameNoExtension&#125;&quot;</span>,<br>      <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;shell&quot;</span>,<br>      <span class="hljs-attr">&quot;dependsOn&quot;</span>: <span class="hljs-string">&quot;javac&quot;</span>,<span class="hljs-comment">// 加入这个依赖就会先javac生成class文件</span><br>      <span class="hljs-attr">&quot;group&quot;</span>: &#123;<br>          <span class="hljs-attr">&quot;kind&quot;</span>: <span class="hljs-string">&quot;test&quot;</span>,<br>          <span class="hljs-attr">&quot;isDefault&quot;</span>: <span class="hljs-literal">true</span><br>      &#125;,<br>      <span class="hljs-attr">&quot;presentation&quot;</span>: &#123;<br>          <span class="hljs-attr">&quot;reveal&quot;</span>: <span class="hljs-string">&quot;always&quot;</span>,<br>          <span class="hljs-attr">&quot;panel&quot;</span>: <span class="hljs-string">&quot;new&quot;</span>,<br>          <span class="hljs-attr">&quot;focus&quot;</span>: <span class="hljs-literal">true</span><br>      &#125;<br>     &#125;<br>    ]<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>java先把所有的类加载到正文段，同时静态初始化（static执行的时机），类似于预编译</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111291017517.png" alt=""></p></li><li><p>Math库中都是静态方法，都不需要生成对象(eg. random)，静态方法可以通过import引入</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111291015737.png" alt=""></p></li><li><p>单例设计模式：创建型模式，提供了一种创建对象的最佳方式。这种模式涉及到一个单一的类，该类负责创建自己的对象，同时确保只有单个对象被创建。</p><ul><li>单例类只能有一个实例。</li><li>单例类必须自己创建自己的唯一实例。</li><li>单例类必须给所有其他对象提供这一实例。</li></ul><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111291020289.png" alt=""></p><p>单例模式事实上有6种，课上介绍的这种叫做“线程安全的懒汉式”</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// 线程安全的懒汉式</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">T</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> T obj;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> T <span class="hljs-title">getInstance</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (obj == <span class="hljs-keyword">null</span>)<br>            obj = <span class="hljs-keyword">new</span> T();<br>        <span class="hljs-keyword">return</span> obj;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">signle</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        T t1 = T.getInstance();<br>        T t2 = T.getInstance();<br>        System.out.println(t1 == t2);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111291023640.png" alt=""></p><p>这体现出两次获取的都是同一对象</p></li><li><p>关于==和equals</p><p>== 对于基本类型来是值比较，对于引用类型是引用比较；</p><p>equals默认情况下是引用比较，很多类重写了 equals 方法把它变成了值比较，如 String、Integer。</p><p>所以一般情况下 equals 比较的是值是否相等。</p></li><li><p>父类引用不能被强制转换为子类引用，子类引用可以隐式转换/强制转换成父类引用（指针）</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111291027333.png" alt=""></p><p>子类引用按需隐式转换到父类引用</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111291028360.png" alt=""></p></li><li><p>switch可以接收字符串（包括空串””），不能接收null，因为java的switch实现基于hashCode，null的hashCode值为0</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">switchTest</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        String s=<span class="hljs-keyword">null</span>; <span class="hljs-comment">// NullPointerException</span><br>        <span class="hljs-comment">// String s = &quot;&quot;;</span><br><br>        <span class="hljs-comment">// if (s != null)  // 若禁止传递空指针时的一种解决方法</span><br>        <span class="hljs-comment">// switch (s) &#123;</span><br>        <span class="hljs-keyword">switch</span> (s == <span class="hljs-keyword">null</span> ? <span class="hljs-string">&quot;null&quot;</span> : s) &#123;  <span class="hljs-comment">// 若必须检测空指针时的一种解决方法</span><br>            <span class="hljs-comment">// //null in switch cases 是预览功能，默认情况下禁用</span><br>            <span class="hljs-comment">// case null :</span><br>            <span class="hljs-comment">//     System.out.println(&quot;This is a nullptr?&quot;);</span><br>            <span class="hljs-comment">//     break;</span><br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;null&quot;</span>:<br>                System.out.println(<span class="hljs-string">&quot;This is a \&quot;null\&quot;!&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;&quot;</span>:<br>                System.out.println(<span class="hljs-string">&quot;This is a blank string!&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">default</span>:<br>                System.out.println(<span class="hljs-string">&quot;This is a other string!&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>instanceof，二元操作符，使用方式类似于==</p><p>作用是测试它左边的对象是否是它右边的类的实例，返回 boolean 的数据类型。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111291030193.png" alt=""></p></li><li><p>实例和引用是两回事！一个实例如果不是被本类的引用所调用，可能无法调用实例的方法</p><p>例如父类引用调用子类实例便无法使用子类的方法</p><p>使用instanceof将实例和其本类的引用配套</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111291032952.png" alt=""></p></li><li><p>java11后的instanceof可以在判断为true后直接赋给本类引用，引用名为最后的参数</p><p>这可能是个语法糖，因为它不是三元运算符</p></li></ol><h1 id="12-1-继承、多态"><a href="#12-1-继承、多态" class="headerlink" title="12.1 继承、多态"></a>12.1 继承、多态</h1><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112011108665.png" alt=""></p><ol><li><p>编译时类型和运行时类型</p><p>Java中的许多对象（一般都是具有父子类关系的父类对象）在运行时都会出现两种类型：编译时类型和运行时类型。</p><p>例如：<code>Person person = new Student();</code>这行代码将会生成一个person变量，该变量的编译时类型是Person，运行时类型是Student。</p><p>编译时类型由声明该变量时使用的类型（引用的类型）决定，运行时类型由实际赋给该变量的对象的类型（实例的类型）决定。</p><p>变量在编译阶段只能调用其编译时类型所具有的方法，在运行阶段执行它运行时类型所具有的方法。即变量只能引用所在的类里的方法。</p><p>另外通过引用来访问对象包含的实例属性时，系统总是试图访问它编译时类所定义的属性，而不是它运行时所定义的属性。</p><p><strong>因为有编译时类型的限制，所以变量所调用的方法只能来自编译时类型的方法</strong></p><p>举两个例子：访问方法和访问属性</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Father</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Show</span><span class="hljs-params">(Father obj)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;in Father class, receive Father obj.&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Son</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Father</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Show</span><span class="hljs-params">(Father obj)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;in Son class, receive Father obj.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Show</span><span class="hljs-params">(Son obj)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;in Son class, receive Son obj.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Show</span><span class="hljs-params">(GrandSon obj)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;in Son class, receive GrandSon obj.&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GrandSon</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Son</span> </span>&#123;<br><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Inheritance1</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Father father = <span class="hljs-keyword">new</span> Son();<br>        GrandSon grandSon = <span class="hljs-keyword">new</span> GrandSon();<br>        father.Show(grandSon);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112011131246.png" alt=""></p><p>继承链(inheritance chain)：</p></li></ol><p>网上找的一份第二次作业第一题的答案，不小心粘在这了</p><p>①②③比较好理解，一般不会出错。④⑤就有点糊涂了，为什么输出的不是”B and B”呢？！！先来回顾一下多态性。         </p><p>运行时多态性是面向对象程序设计代码重用的一个最强大机制，动态性的概念也可以被说成“一个接口，多个方法”。Java实现运行时多态性的基础是动态方法调度，它是一种在运行时而不是在编译期调用重载方法的机制。         方法的重写Overriding和重载Overloading是Java多态性的不同表现。重写Overriding是父类与子类之间多态性的一种表现，重载Overloading是一个类中多态性的一种表现。如果在子类中定义某方法与其父类有相同的名称和参数，我们说该方法被重写(Overriding)。子类的对象使用这个方法时，将调用子类中的定义，对它而言，父类中的定义如同被“屏蔽”了。如果在一个类中定义了多个同名的方法，它们或有不同的参数个数或有不同的参数类型，则称为方法的重载(Overloading)。Overloaded的方法是可以改变返回值的类型。         </p><p>当超类对象引用变量引用子类对象时，被引用对象的类型而不是引用变量的类型决定了调用谁的成员方法，但是这个被调用的方法必须是在超类中定义过的，也就是说被子类覆盖的方法。 （但是如果强制把超类转换成子类的话，就可以调用子类中新添加而超类没有的方法了。）         </p><p>好了，先温习到这里，言归正传！实际上这里涉及方法调用的优先问题 ，优先级由高到低依次为：this.show(O)、super.show(O)、this.show((super)O)、super.show((super)O)。让我们来看看它是怎么工作的。         </p><p>比如④，a2.show(b)，a2是一个引用变量，类型为A，则this为a2，b是B的一个实例，于是它到类A里面找show(B obj)方法，没有找到，于是到A的super(超类)找，而A没有超类，因此转到第三优先级this.show((super)O)，this仍然是a2，这里O为B，(super)O即(super)B即A，因此它到类A里面找show(A obj)的方法，类A有这个方法，但是由于a2引用的是类B的一个对象，B覆盖了A的show(A obj)方法，因此最终锁定到类B的show(A obj)，输出为”B and A”。         再比如⑧，b.show(c)，b是一个引用变量，类型为B，则this为b，c是C的一个实例，于是它到类B找show(C obj)方法，没有找到，转而到B的超类A里面找，A里面也没有，因此也转到第三优先级this.show((super)O)，this为b，O为C，(super)O即(super)C即B，因此它到B里面找show(B obj)方法，找到了，由于b引用的是类B的一个对象，因此直接锁定到类B的show(B obj)，输出为”B and B”。         按照上面的方法，可以正确得到其他的结果。</p><h1 id="12-8-接口、lambda表达式、内部类"><a href="#12-8-接口、lambda表达式、内部类" class="headerlink" title="12.8 接口、lambda表达式、内部类"></a>12.8 接口、lambda表达式、内部类</h1><h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2><p>接口是对希望符合这个接口的类的一组<strong>需求</strong>。</p><p>接口没有实例。</p><p>接口中的所有方法都是<code>public</code>，所有字段都是<code>public static final</code></p><blockquote><p>注：Java语言规范建议不要提供多余的关键字</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112091930957.png" alt=""></p><p>实现接口的类若非抽象类，则必须实现接口中的所有方法</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112091933259.png" alt=""></p><p>实现接口时必须将方法声明为<code>public</code>，因为缺省访问权限为包内权限，编译器会报错，认为你试图提供更严格的（更弱的）访问权限</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112091937376.png" alt=""></p><p>测试用到的代码</p><p>类图:</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112092021983.png" alt=""></p><p>代码：</p><ol><li>Person.java</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.course.interfacetest;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>&#123;<br>    String name;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Person</span><span class="hljs-params">(String n)</span> </span>&#123;  <span class="hljs-comment">// Java不支持默认值参数</span><br>        name = n;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Person</span><span class="hljs-params">()</span> </span>&#123;  <span class="hljs-comment">// 但可以使用重载实现类似的功能</span><br>        <span class="hljs-keyword">this</span>(<span class="hljs-string">&quot;路人甲&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">eat</span><span class="hljs-params">()</span> </span>&#123;  <span class="hljs-comment">// getMethods()只能获取父类中public权限的方法！如果不加public会出现虽然能调用但是反射获取不到的情况。</span><br>        System.out.println(<span class="hljs-string">&quot;The person is eating.&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li><p>CanFight.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.course.interfacetest;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CanFight</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> numberOfWins = <span class="hljs-number">10</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">fight</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>CanSwim.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.course.interfacetest;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CanSwim</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">swim</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>Hero.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.course.interfacetest;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hero</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Person</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CanFight</span>, <span class="hljs-title">CanSwim</span> </span>&#123;<br>    String title;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Hero</span><span class="hljs-params">(String n, String t)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(n);<br>        title = t;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Hero</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>();<br>        title = <span class="hljs-string">&quot;无证骑士&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">fight</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;The hero is fighting.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">swim</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;The hero is swimming.&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>Test.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.course.interfacetest;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Person h1 = <span class="hljs-keyword">new</span> Hero();<br>        Hero h2 = <span class="hljs-keyword">new</span> Hero(<span class="hljs-string">&quot;琦玉&quot;</span>, <span class="hljs-string">&quot;秃头披风侠&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;Hero is a subtype of Person? &quot;</span> + (h2 <span class="hljs-keyword">instanceof</span> Person));<br>        System.out.println(<span class="hljs-string">&quot;Hero is a subtype of CanSwim? &quot;</span> + (h2 <span class="hljs-keyword">instanceof</span> CanSwim));<br>        System.out.println(<span class="hljs-string">&quot;Hero is a subtype of CanFight? &quot;</span> + (h2 <span class="hljs-keyword">instanceof</span> CanFight));<br><br>        System.out.println();<br>        Class&lt;? extends Person&gt; h1RuntimeClass = h1.getClass();<br>        System.out.println(h1RuntimeClass);<br>        Method[] methods = h1RuntimeClass.getMethods();<br>        <span class="hljs-keyword">for</span> (Method method : methods)<br>            System.out.println(method);<br><br>        System.out.println();<br>        Class&lt;? extends Person&gt; h2RuntimeClass = h2.getClass();<br>        System.out.println(h2RuntimeClass);<br>        Method[] methods2 = h2RuntimeClass.getMethods();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> method : methods2)<br>            System.out.println(method);<br><br>        System.out.println();<br>        System.out.println(h1.name);<br><span class="hljs-comment">//        System.out.println(h1.title);  // ERROR</span><br>        h1.eat();<br><span class="hljs-comment">//        h1.fight();  // ERROR</span><br><span class="hljs-comment">//        h1.swim();  // ERROR</span><br><br>        System.out.println();<br>        System.out.println(h2.name);<br>        System.out.println(h2.title);<br>        h2.eat();<br>        h2.fight();<br>        h2.swim();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>output.out</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs processing">Hero is a subtype of Person? <span class="hljs-keyword">true</span><br>Hero is a subtype of CanSwim? <span class="hljs-keyword">true</span><br>Hero is a subtype of CanFight? <span class="hljs-keyword">true</span><br><br>class edu.wanpengxu.course.Hero<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> edu.wanpengxu.course.Hero.fight()<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> edu.wanpengxu.course.Hero.swim()<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> edu.wanpengxu.course.Person.eat()<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> java.lang.<span class="hljs-keyword">Object</span>.wait(<span class="hljs-keyword">long</span>,<span class="hljs-built_in">int</span>) <span class="hljs-keyword">throws</span> java.lang.InterruptedException<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> java.lang.<span class="hljs-keyword">Object</span>.wait() <span class="hljs-keyword">throws</span> java.lang.InterruptedException<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> java.lang.<span class="hljs-keyword">Object</span>.wait(<span class="hljs-keyword">long</span>) <span class="hljs-keyword">throws</span> java.lang.InterruptedException<br><span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> java.lang.<span class="hljs-keyword">Object</span>.equals(java.lang.<span class="hljs-keyword">Object</span>)<br><span class="hljs-keyword">public</span> java.lang.<span class="hljs-keyword">String</span> java.lang.<span class="hljs-keyword">Object</span>.toString()<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-built_in">int</span> java.lang.<span class="hljs-keyword">Object</span>.hashCode()<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> java.lang.Class java.lang.<span class="hljs-keyword">Object</span>.getClass()<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> java.lang.<span class="hljs-keyword">Object</span>.notify()<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> java.lang.<span class="hljs-keyword">Object</span>.notifyAll()<br><br>class edu.wanpengxu.course.Hero<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> edu.wanpengxu.course.Hero.fight()<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> edu.wanpengxu.course.Hero.swim()<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> edu.wanpengxu.course.Person.eat()<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> java.lang.<span class="hljs-keyword">Object</span>.wait(<span class="hljs-keyword">long</span>,<span class="hljs-built_in">int</span>) <span class="hljs-keyword">throws</span> java.lang.InterruptedException<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> java.lang.<span class="hljs-keyword">Object</span>.wait() <span class="hljs-keyword">throws</span> java.lang.InterruptedException<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> java.lang.<span class="hljs-keyword">Object</span>.wait(<span class="hljs-keyword">long</span>) <span class="hljs-keyword">throws</span> java.lang.InterruptedException<br><span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> java.lang.<span class="hljs-keyword">Object</span>.equals(java.lang.<span class="hljs-keyword">Object</span>)<br><span class="hljs-keyword">public</span> java.lang.<span class="hljs-keyword">String</span> java.lang.<span class="hljs-keyword">Object</span>.toString()<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-built_in">int</span> java.lang.<span class="hljs-keyword">Object</span>.hashCode()<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> java.lang.Class java.lang.<span class="hljs-keyword">Object</span>.getClass()<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> java.lang.<span class="hljs-keyword">Object</span>.notify()<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> java.lang.<span class="hljs-keyword">Object</span>.notifyAll()<br><br>路人甲<br>The person is eating.<br><br>琦玉<br>秃头披风侠<br>The person is eating.<br>The hero is fighting.<br>The hero is swimming.<br></code></pre></td></tr></table></figure></li></ol><p><strong>反射只能获取public方法</strong></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112092018603.png" alt=""></p><h3 id="接口的属性"><a href="#接口的属性" class="headerlink" title="接口的属性"></a>接口的属性</h3><p>可以使用接口引用变量，变量必须是实现了接口的类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Comparable x;<br>x = <span class="hljs-keyword">new</span> Employee(...);<br></code></pre></td></tr></table></figure><p>可以使用<code>instanceof</code>检查一个对象是否实现了某个特定的接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (anObject <span class="hljs-keyword">instanceof</span> Comparable) &#123;<br>    ...<br>&#125;<br></code></pre></td></tr></table></figure><p>允许有多条接口链，从通用性较高的接口扩展到专用性较高的接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Moveable</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">move</span> <span class="hljs-params">(<span class="hljs-keyword">double</span> x, <span class="hljs-keyword">double</span> y)</span></span>;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Powered</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Moveable</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">double</span> <span class="hljs-title">milesPerGallon</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>一个类可以实现多个接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Employee</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Cloneable</span>, <span class="hljs-title">Comparable</span></span><br></code></pre></td></tr></table></figure><h3 id="接口与抽象类"><a href="#接口与抽象类" class="headerlink" title="接口与抽象类"></a>接口与抽象类</h3><p>为什么Java中会有接口？</p><p>因为，有些程序设计语言（尤其是C++）允许一个类有多个超类，这个特性称为多重继承（multiple inheritance），Java的设计者选择了不支持多重继承，其主要原因是多重继承会让语言变得非常复杂（如同C++），或者效率会降低（如同Eiffel）。</p><p>接口可以提供多重继承的大多数好处，同时还能避免多重继承的复杂性和低效性。</p><p>所以Java只能扩展一个类却可以实现多个接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Employee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Person</span>, <span class="hljs-title">Comparable</span>  // <span class="hljs-title">ERROR</span></span><br><span class="hljs-class"><span class="hljs-title">class</span> <span class="hljs-title">Employee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Person</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Comparable</span>  // <span class="hljs-title">OK</span></span><br></code></pre></td></tr></table></figure><h3 id="默认方法"><a href="#默认方法" class="headerlink" title="默认方法"></a>默认方法</h3><p>可以使用<code>default</code>修饰符为接口方法提供一个默认实现，这个默认方法主要用于“接口演化”，例如很久以前有这样一个类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bag</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Collention</span></span><br></code></pre></td></tr></table></figure><p>后来Java要在Collention中增加一个stream方法，如果这个方法不是默认方法，由于Bag此前并没有实现stream方法，程序将不能编译，即不能保证<strong>“源代码兼容”</strong>。</p><p><strong>“二进制兼容”</strong>：在升级库文件的时候，不必<strong>重新编译</strong>使用此库的可执行文件或其他库文件，并且程序的功能不被破坏。</p><p><strong>“源代码兼容”</strong>：在升级库文件的时候，不必<strong>修改</strong>使用此库的可执行文件或其他库文件的<strong>源代码</strong>，只需重新编译应用程序，即可使程序的功能不被破坏。</p><p>增加非默认方法stream后，若不对Bag类重新编译（即使用之前编译好的JAR文件），当程序在Bag实例上调用steam方法时会出现<code>AbstractMethodError</code></p><p>若增加的是默认方法，那么上述情况会调用<code>Collection.stream</code>方法</p><h3 id="解决默认方法冲突"><a href="#解决默认方法冲突" class="headerlink" title="解决默认方法冲突"></a>解决默认方法冲突</h3><ol><li><p>超类优先</p><p>若一个类继承了超类，实现了接口，且超类和接口中有相同签名的方法，使用超类中的方法</p></li><li><p>接口冲突（让程序员解决）</p><p>使用下面的例子</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Person</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">default</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span> ;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Named</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">default</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> getClass().getName() + <span class="hljs-string">&quot;_&quot;</span> + hashCode();<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Person</span>, <span class="hljs-title">Named</span></span>&#123;  <span class="hljs-comment">// ERROR</span><br>    ...<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112100931666.png" alt=""></p><p>Java编译器会报错，让程序员来解决这个问题，解决方法是选择冲突方法中的一个</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Person</span>, <span class="hljs-title">Named</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> Person.<span class="hljs-keyword">super</span>.getName();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>使用<code>&#123;接口名&#125;.super.&#123;方法名&#125;</code>的原因：在类继承中，我们使用<code>super.&#123;方法名&#125;</code>便可以调用超类的方法，但接口允许多继承，所以必须在super前指定是哪个接口。</p><blockquote><p>只要被实现的接口中的方法有一个提供了默认实现，编译器就会报错，若方法都没有默认实现则不存在冲突，因为必须在实现这些接口的类中实现方法。</p></blockquote></li></ol><h2 id="lambda表达式"><a href="#lambda表达式" class="headerlink" title="lambda表达式"></a>lambda表达式</h2><p>lambda表达式：匿名函数，是代码块以及必须传入代码块的变量规范。</p><blockquote><p>为什么是λ？</p><p>这是逻辑学家Alonzo Church受《数学原理》（<em>Principia Mathematica</em>）中用重音符^表示自由变量启发，采用大写lambda（Λ）表示参数，后来又改为了小写lambda（λ）。从此带参数变量的表达式就被称为lambda表达式。</p></blockquote><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><p>语法格式为</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">(parameters) -&gt; expression<br></code></pre></td></tr></table></figure><p>或<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">(parameters) -&gt; &#123;<br>    statements;<br>&#125;<br></code></pre></td></tr></table></figure></p><p>如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">(String first, String second) -&gt; &#123;<br>    first.length()-second.length();<br>&#125;<br></code></pre></td></tr></table></figure><p>特征：</p><ol><li>可选参数类型：由编译器识别参数类型，可以忽略参数类型</li><li>可选的圆括号：若只有一个参数，可以忽略圆括号</li><li>可选的大括号及return：若只有一条语句，可以忽略大括号、分号及<code>return</code></li></ol><p>若一个lambda表达式只在某些分支有返回值而其他分支无返回值，编译器会报错，如</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">(<span class="hljs-keyword">int</span> x) -&gt; &#123;<br>    <span class="hljs-keyword">if</span> (x &gt;= <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;  <span class="hljs-comment">// ERROR</span><br></code></pre></td></tr></table></figure><p>lambda 表达式的局部变量必须是<strong>事实最终变量</strong>（effectively final）（具有final特性），即lambda表达式使用的变量不可在之后被修改。</p><p>lambda表达式实际上是创建了一个对象以向方法传入。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112110019007.png" alt=""></p><p>另外，</p><p>当lambda表达式里没有使用上下文中的其他变量时，则每次执行lambda表达式都使用同一个对象。</p><p>当lambda表达式里使用了上下文中的其他变量时，则每次执行lambda表达式都会新建一个对象。</p><h3 id="函数式接口"><a href="#函数式接口" class="headerlink" title="函数式接口"></a>函数式接口</h3><p>函数式接口：只有一个抽象方法的接口（可以有静态方法、默认方法和重写Object的公共方法）。</p><blockquote><p>An informative annotation type used to indicate that an interface type declaration is intended to be a functional interface as defined by the Java Language Specification. Conceptually, <strong>a functional interface has exactly one abstract method.</strong> Since <strong><em>default methods</em></strong> have an implementation, they <strong>are not abstract.</strong> <strong>If an interface declares an abstract method overriding one of the public methods of <em>java.lang.Object</em>, that also does not count toward the interface’s abstract method count</strong> since any implementation of the interface will have an implementation from java.lang.Object or elsewhere.<br>Note that instances of functional interfaces can be created with lambda expressions, method references, or constructor references.<br>If a type is annotated with this annotation type, compilers are required to generate an error message unless:<br>The type is an interface type and not an annotation type, enum, or class.<br>The annotated type satisfies the requirements of a functional interface.<br>However, the compiler will treat any interface meeting the definition of a functional interface as a functional interface regardless of whether or not a FunctionalInterface annotation is present on the interface declaration.<br>自:<br>1.8</p></blockquote><p>eg. 函数式接口<code>Comparator</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FunctionalInterface</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Comparator</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">compare</span><span class="hljs-params">(T o1, T o2)</span></span>;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">boolean</span> <span class="hljs-title">equals</span><span class="hljs-params">(Object obj)</span></span>;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">default</span> Comparator&lt;T&gt; <span class="hljs-title">reversed</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> Collections.reverseOrder(<span class="hljs-keyword">this</span>);<br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">default</span> Comparator&lt;T&gt; <span class="hljs-title">thenComparing</span><span class="hljs-params">(Comparator&lt;? <span class="hljs-keyword">super</span> T&gt; other)</span> </span>&#123;<br>        Objects.requireNonNull(other);<br>        <span class="hljs-keyword">return</span> (Comparator&lt;T&gt; &amp; Serializable) (c1, c2) -&gt; &#123;<br>            <span class="hljs-keyword">int</span> res = compare(c1, c2);<br>            <span class="hljs-keyword">return</span> (res != <span class="hljs-number">0</span>) ? res : other.compare(c1, c2);<br>        &#125;;<br>    &#125;<br>    <br>    <span class="hljs-keyword">default</span> &lt;U&gt; <span class="hljs-function">Comparator&lt;T&gt; <span class="hljs-title">thenComparing</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">            Function&lt;? <span class="hljs-keyword">super</span> T, ? extends U&gt; keyExtractor,</span></span><br><span class="hljs-params"><span class="hljs-function">            Comparator&lt;? <span class="hljs-keyword">super</span> U&gt; keyComparator)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> thenComparing(comparing(keyExtractor, keyComparator));<br>    &#125;<br>    <br>    <span class="hljs-keyword">default</span> &lt;U extends Comparable&lt;? <span class="hljs-keyword">super</span> U&gt;&gt; <span class="hljs-function">Comparator&lt;T&gt; <span class="hljs-title">thenComparing</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">            Function&lt;? <span class="hljs-keyword">super</span> T, ? extends U&gt; keyExtractor)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> thenComparing(comparing(keyExtractor));<br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">default</span> Comparator&lt;T&gt; <span class="hljs-title">thenComparingInt</span><span class="hljs-params">(ToIntFunction&lt;? <span class="hljs-keyword">super</span> T&gt; keyExtractor)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> thenComparing(comparingInt(keyExtractor));<br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">default</span> Comparator&lt;T&gt; <span class="hljs-title">thenComparingLong</span><span class="hljs-params">(ToLongFunction&lt;? <span class="hljs-keyword">super</span> T&gt; keyExtractor)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> thenComparing(comparingLong(keyExtractor));<br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">default</span> Comparator&lt;T&gt; <span class="hljs-title">thenComparingDouble</span><span class="hljs-params">(ToDoubleFunction&lt;? <span class="hljs-keyword">super</span> T&gt; keyExtractor)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> thenComparing(comparingDouble(keyExtractor));<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T extends Comparable&lt;? <span class="hljs-keyword">super</span> T&gt;&gt; <span class="hljs-function">Comparator&lt;T&gt; <span class="hljs-title">reverseOrder</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> Collections.reverseOrder();<br>    &#125;<br>    <br>    <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T extends Comparable&lt;? <span class="hljs-keyword">super</span> T&gt;&gt; <span class="hljs-function">Comparator&lt;T&gt; <span class="hljs-title">naturalOrder</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (Comparator&lt;T&gt;) Comparators.NaturalOrderComparator.INSTANCE;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Comparator&lt;T&gt; <span class="hljs-title">nullsFirst</span><span class="hljs-params">(Comparator&lt;? <span class="hljs-keyword">super</span> T&gt; comparator)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Comparators.NullComparator&lt;&gt;(<span class="hljs-keyword">true</span>, comparator);<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Comparator&lt;T&gt; <span class="hljs-title">nullsLast</span><span class="hljs-params">(Comparator&lt;? <span class="hljs-keyword">super</span> T&gt; comparator)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Comparators.NullComparator&lt;&gt;(<span class="hljs-keyword">false</span>, comparator);<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T, U&gt; <span class="hljs-function">Comparator&lt;T&gt; <span class="hljs-title">comparing</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">            Function&lt;? <span class="hljs-keyword">super</span> T, ? extends U&gt; keyExtractor,</span></span><br><span class="hljs-params"><span class="hljs-function">            Comparator&lt;? <span class="hljs-keyword">super</span> U&gt; keyComparator)</span></span><br><span class="hljs-function">    </span>&#123;<br>        Objects.requireNonNull(keyExtractor);<br>        Objects.requireNonNull(keyComparator);<br>        <span class="hljs-keyword">return</span> (Comparator&lt;T&gt; &amp; Serializable)<br>            (c1, c2) -&gt; keyComparator.compare(keyExtractor.apply(c1),<br>                                              keyExtractor.apply(c2));<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T, U extends Comparable&lt;? <span class="hljs-keyword">super</span> U&gt;&gt; <span class="hljs-function">Comparator&lt;T&gt; <span class="hljs-title">comparing</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">            Function&lt;? <span class="hljs-keyword">super</span> T, ? extends U&gt; keyExtractor)</span></span><br><span class="hljs-function">    </span>&#123;<br>        Objects.requireNonNull(keyExtractor);<br>        <span class="hljs-keyword">return</span> (Comparator&lt;T&gt; &amp; Serializable)<br>            (c1, c2) -&gt; keyExtractor.apply(c1).compareTo(keyExtractor.apply(c2));<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Comparator&lt;T&gt; <span class="hljs-title">comparingInt</span><span class="hljs-params">(ToIntFunction&lt;? <span class="hljs-keyword">super</span> T&gt; keyExtractor)</span> </span>&#123;<br>        Objects.requireNonNull(keyExtractor);<br>        <span class="hljs-keyword">return</span> (Comparator&lt;T&gt; &amp; Serializable)<br>            (c1, c2) -&gt; Integer.compare(keyExtractor.applyAsInt(c1), keyExtractor.applyAsInt(c2));<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function">Comparator&lt;T&gt; <span class="hljs-title">comparingLong</span><span class="hljs-params">(ToLongFunction&lt;? <span class="hljs-keyword">super</span> T&gt; keyExtractor)</span> </span>&#123;<br>        Objects.requireNonNull(keyExtractor);<br>        <span class="hljs-keyword">return</span> (Comparator&lt;T&gt; &amp; Serializable)<br>            (c1, c2) -&gt; Long.compare(keyExtractor.applyAsLong(c1), keyExtractor.applyAsLong(c2));<br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span>&lt;T&gt; Comparator&lt;T&gt; <span class="hljs-title">comparingDouble</span><span class="hljs-params">(ToDoubleFunction&lt;? <span class="hljs-keyword">super</span> T&gt; keyExtractor)</span> </span>&#123;<br>        Objects.requireNonNull(keyExtractor);<br>        <span class="hljs-keyword">return</span> (Comparator&lt;T&gt; &amp; Serializable)<br>            (c1, c2) -&gt; Double.compare(keyExtractor.applyAsDouble(c1), keyExtractor.applyAsDouble(c2));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>如静态方法<code>Arrays.sort</code>的第二个参数需要一个<code>Comparator</code>实例，而<code>Comparator</code>就是一个函数式接口，所以可以提供一个lambda表达式。</p><p>下面是<code>Arrays.sort</code>和<code>Comparator</code>的方法原型</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Contract(mutates = &quot;param1&quot;)</span> <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sort</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">    <span class="hljs-meta">@NotNull</span> T[] a,</span></span><br><span class="hljs-params"><span class="hljs-function">    <span class="hljs-meta">@Nullable</span> Comparator&lt;? <span class="hljs-keyword">super</span> T&gt; c)</span> </span>&#123;<br>    ...<br>&#125;<br>    <br><span class="hljs-meta">@FunctionalInterface</span> <br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Comparator</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">compare</span><span class="hljs-params">(T o1, T o2)</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>那么我们可以这样使用<code>Arrays.sort</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Array.sort(words,<br>          (first, second) -&gt; first.length() - second.length());<br></code></pre></td></tr></table></figure><p>这其实就相当于C++11中的</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">sort</span>(words.<span class="hljs-built_in">begin</span>(), <br>     words.<span class="hljs-built_in">end</span>(),<br>     [](string first, string second) -&gt; <span class="hljs-keyword">bool</span> &#123; <span class="hljs-keyword">return</span> first.<span class="hljs-built_in">length</span>() &gt; second.<span class="hljs-built_in">length</span>(); &#125;);<br></code></pre></td></tr></table></figure><p>或者C++11前（没有lambda表达式，只能传实名函数）的</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">comp</span><span class="hljs-params">(string first, string second)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> first.<span class="hljs-built_in">length</span>() &gt; second.<span class="hljs-built_in">length</span>();<br>&#125; <br><span class="hljs-built_in">sort</span>(words.<span class="hljs-built_in">begin</span>(),<br>     words.<span class="hljs-built_in">end</span>(),<br>     comp);<br></code></pre></td></tr></table></figure><p>lambda表达式可以转换为函数式接口，如</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">var</span> timer = <span class="hljs-keyword">new</span> Timer (<span class="hljs-number">1000</span>, <br>                      event -&gt; &#123;<br>                          System.out.println(<span class="hljs-string">&quot;At the tone, the time is &quot;</span> + <br>                                            Instant.ofEpochMilli(event.getWhen()));<br>                          Toolkit.getDefaultToolKit().beep();<br>                      &#125;);<br></code></pre></td></tr></table></figure><h3 id="方法引用"><a href="#方法引用" class="headerlink" title="方法引用"></a>方法引用</h3><p>方法引用：指示编译器生成一个函数式接口的实例，覆盖这个接口的抽象方法来调用给定的方法。</p><p>可以理解为把方法抽取出来作为“函数”</p><p>使用方法主要有3：</p><ol><li><p>object::instanceMethod</p><p>eg. </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">System.out::println<br><span class="hljs-comment">// 等价于</span><br>x -&gt; System.out.println(x);<br><span class="hljs-comment">// 实例方法，提供了实例，把传入的都用来做参数</span><br></code></pre></td></tr></table></figure></li><li><p>Class::instanceMethod</p><p>eg.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">String::compareToIgnoreCase<br><span class="hljs-comment">// 等价于</span><br>(x, y) -&gt; x.compareToIgnoreCase(y)<br><span class="hljs-comment">// 实例方法，未提供实例，把传入参数的第一个当实例</span><br><span class="hljs-comment">// 因为实例方法的第一个参数总是self</span><br></code></pre></td></tr></table></figure></li><li><p>Class::staticMethod</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">Math::pow<br><span class="hljs-comment">// 等价于</span><br>(x, y) -&gt; Math.pow(x, y)<br><span class="hljs-comment">// 静态方法不需要实例，把传入的都用来做参数</span><br></code></pre></td></tr></table></figure></li></ol><p>也可以在方法中使用<code>this</code>, <code>super</code>关键字</p><p>举个例子</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.course.lambdatest;<br><br><span class="hljs-keyword">import</span> java.util.Arrays;<br><span class="hljs-keyword">import</span> java.util.Comparator;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        String[] words = &#123;<span class="hljs-string">&quot;object&quot;</span>, <span class="hljs-string">&quot;class&quot;</span>, <span class="hljs-string">&quot;lambda&quot;</span>, <span class="hljs-string">&quot;interface&quot;</span>, <span class="hljs-string">&quot;abstract&quot;</span>&#125;;<br><span class="hljs-comment">//        Arrays.sort(words,</span><br><span class="hljs-comment">//                (first, second) -&gt; first.length() - second.length());</span><br>        Arrays.sort(words,<br>                Test::comp);<br><span class="hljs-comment">//        Arrays.sort(words,</span><br><span class="hljs-comment">//                String::compareTo);</span><br><span class="hljs-comment">//        Arrays.sort(words,</span><br><span class="hljs-comment">//                Comparator.comparingInt(String::length));  // Comparator.comparingInt(x -&gt; x.length())</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> word : words)<br>            System.out.println(word);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">comp</span><span class="hljs-params">(String first, String second)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> first.length() - second.length();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>对于第一种<code>Arrays.sort</code>，就是直接传入lambda表达式</p><p>对于第二种<code>Arrays.sort</code>，是使用了自定义的方法引用</p><p>对于第三、四种<code>Arrays.sort</code>，是使用了<code>Java API</code>的方法引用</p><p>output.out</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">class</span><br><span class="hljs-symbol">object</span><br><span class="hljs-symbol">lambda</span><br><span class="hljs-symbol">abstract</span><br><span class="hljs-symbol">interface</span><br></code></pre></td></tr></table></figure><p>从结果可以看出程序按照我们传入的算法进行了稳定的排序。</p><p>那么为什么可以呢？</p><p>我们首先看一下 <code>Arrays.sort</code>方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sort</span><span class="hljs-params">(T[] a, Comparator&lt;? <span class="hljs-keyword">super</span> T&gt; c)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (c == <span class="hljs-keyword">null</span>) &#123;<br>            sort(a);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">if</span> (LegacyMergeSort.userRequested)<br>                legacyMergeSort(a, c);<br>            <span class="hljs-keyword">else</span><br>                TimSort.sort(a, <span class="hljs-number">0</span>, a.length, c, <span class="hljs-keyword">null</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>可以看到接收的第二个参数是<code>Comparator</code>类的一个实例<code>c</code>，如果c不为null，那么将<code>c</code>传入<code>legacyMergeSort</code>(历史归并排序)。</p><p>跟踪进入<code>legacyMergeSort</code>方法看看</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">legacyMergeSort</span><span class="hljs-params">(T[] a, Comparator&lt;? <span class="hljs-keyword">super</span> T&gt; c)</span> </span>&#123;<br>        T[] aux = a.clone();<br>        <span class="hljs-keyword">if</span> (c==<span class="hljs-keyword">null</span>)<br>            mergeSort(aux, a, <span class="hljs-number">0</span>, a.length, <span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">else</span><br>            mergeSort(aux, a, <span class="hljs-number">0</span>, a.length, <span class="hljs-number">0</span>, c);<br>    &#125;<br></code></pre></td></tr></table></figure><p>可以看到接收的第二个参数是也<code>Comparator</code>类的一个实例<code>c</code>，如果c不为null，那么将<code>c</code>传入<code>mergeSort</code>(归并排序/合并排序)。</p><p>跟踪进入<code>mergeSort</code>方法看看</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">mergeSort</span><span class="hljs-params">(Object[] src,</span></span><br><span class="hljs-params"><span class="hljs-function">                                  Object[] dest,</span></span><br><span class="hljs-params"><span class="hljs-function">                                  <span class="hljs-keyword">int</span> low, <span class="hljs-keyword">int</span> high, <span class="hljs-keyword">int</span> off,</span></span><br><span class="hljs-params"><span class="hljs-function">                                  Comparator c)</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> length = high - low;<br><br>        <span class="hljs-comment">// Insertion sort on smallest arrays</span><br>        <span class="hljs-keyword">if</span> (length &lt; INSERTIONSORT_THRESHOLD) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=low; i&lt;high; i++)<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j=i; j&gt;low &amp;&amp; c.compare(dest[j-<span class="hljs-number">1</span>], dest[j])&gt;<span class="hljs-number">0</span>; j--)<br>                    swap(dest, j, j-<span class="hljs-number">1</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        <span class="hljs-comment">// Recursively sort halves of dest into src</span><br>        <span class="hljs-keyword">int</span> destLow  = low;<br>        <span class="hljs-keyword">int</span> destHigh = high;<br>        low  += off;<br>        high += off;<br>        <span class="hljs-keyword">int</span> mid = (low + high) &gt;&gt;&gt; <span class="hljs-number">1</span>;<br>        mergeSort(dest, src, low, mid, -off, c);<br>        mergeSort(dest, src, mid, high, -off, c);<br><br>        <span class="hljs-comment">// If list is already sorted, just copy from src to dest.  This is an</span><br>        <span class="hljs-comment">// optimization that results in faster sorts for nearly ordered lists.</span><br>        <span class="hljs-keyword">if</span> (c.compare(src[mid-<span class="hljs-number">1</span>], src[mid]) &lt;= <span class="hljs-number">0</span>) &#123;<br>           System.arraycopy(src, low, dest, destLow, length);<br>           <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        <span class="hljs-comment">// Merge sorted halves (now in src) into dest</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = destLow, p = low, q = mid; i &lt; destHigh; i++) &#123;<br>            <span class="hljs-keyword">if</span> (q &gt;= high || p &lt; mid &amp;&amp; c.compare(src[p], src[q]) &lt;= <span class="hljs-number">0</span>)<br>                dest[i] = src[p++];<br>            <span class="hljs-keyword">else</span><br>                dest[i] = src[q++];<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>在这里看到了<code>c.compare(dest[j-1], dest[j])</code></p><p>跟踪进入<code>Comparator</code>类里面看看<code>compare</code>方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@FunctionalInterface</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Comparator</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">compare</span><span class="hljs-params">(T o1, T o2)</span></span>;<br>    ...<br>&#125;<br></code></pre></td></tr></table></figure><p>可以看到，我们自定义的方法与方法签名完全一致（除了方法名外，方法参数一致，返回类型相同），所以可以传入。</p><p>同理，可以看一下<code>String</code>类里的<code>compareTo</code>方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">compareTo</span><span class="hljs-params">(String anotherString)</span> </span>&#123;<br>        <span class="hljs-keyword">byte</span> v1[] = value;<br>        <span class="hljs-keyword">byte</span> v2[] = anotherString.value;<br>        <span class="hljs-keyword">byte</span> coder = coder();<br>        <span class="hljs-keyword">if</span> (coder == anotherString.coder()) &#123;<br>            <span class="hljs-keyword">return</span> coder == LATIN1 ? StringLatin1.compareTo(v1, v2)<br>                                   : StringUTF16.compareTo(v1, v2);<br>        &#125;<br>        <span class="hljs-keyword">return</span> coder == LATIN1 ? StringLatin1.compareToUTF16(v1, v2)<br>                               : StringUTF16.compareToLatin1(v1, v2);<br>     &#125;<br></code></pre></td></tr></table></figure><p>函数签名看起来不太一样，但因为实例方法有一个隐含的<code>this</code>参数，<code>String</code>类的<code>compareTo</code>方法在实际调用的时候，第一个隐含参数总是传入<code>this</code>，相当于静态方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">compareTo</span><span class="hljs-params">(<span class="hljs-keyword">this</span>, String o)</span></span>;<br></code></pre></td></tr></table></figure><p>所以它也可以作为方法引用传入。</p><h3 id="构造器引用"><a href="#构造器引用" class="headerlink" title="构造器引用"></a>构造器引用</h3><p>可以认为是方法名为new的方法引用，二者都是对lambda表达式的简化。</p><p>eg. </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">Student::<span class="hljs-keyword">new</span><br><span class="hljs-comment">// 等价于</span><br>age -&gt; <span class="hljs-keyword">new</span> Student(age)<br></code></pre></td></tr></table></figure><p>此后可以使用<code>apply</code>方法向其传入参数。</p><h2 id="内部类"><a href="#内部类" class="headerlink" title="内部类"></a>内部类</h2><p>内部类（inner class）：定义在另一个类中的类。</p><p>使用内部类的原因：</p><ol><li>内部类可以对同一个包中的其他类隐藏</li><li>内部类方法可以访问外围类的作用域中所有的数据，包括原本私有的数据</li><li>便于<strong>回调</strong>（以后补）</li></ol><p>语法格式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OuterClass</span> </span>&#123;   <span class="hljs-comment">// 外部类</span><br>    <span class="hljs-comment">// ...</span><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InnerClass</span> </span>&#123; <span class="hljs-comment">// 嵌套类，或称为内部类</span><br>        <span class="hljs-comment">// ...</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>内部类与外围类的字段、方法处于相同地位（都是外围类的成员）</p><p>内部类可以直接访问外围类成员</p><h3 id="非静态内部类"><a href="#非静态内部类" class="headerlink" title="非静态内部类"></a>非静态内部类</h3><p>外围类不能直接使用非静态内部类的成员，但可以创建一个内部类的实例，通过这个实例访问内部类的成员，有两种实现方法。</p><ol><li><p>在外围类内的方法中创建，与创建一般对象相同</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;内部类类名&#125; &#123;内部类变量&#125; = <span class="hljs-keyword">new</span> &#123;内部类构造方法名&#125;(&#123;参数列表&#125;);<br></code></pre></td></tr></table></figure></li><li><p>在外围类外创建，需要使用如下格式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">&#123;外部类实例&#125;.&#123;内部类类名&#125; &#123;内部类变量&#125; = &#123;外部类实例&#125;.new &#123;内部类构造方法名&#125;(&#123;参数列表&#125;);<br></code></pre></td></tr></table></figure><p>即在两侧左边同时加了<code>&#123;外部类实例&#125;.</code>以做限定</p></li></ol><p>若使用 <code>private</code> 或 <code>protected</code> 来修饰内部类，那么方法2将失效。</p><p>eg. PPT魔改例子</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.course.innerclasstest;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OuterClass</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> i1;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InnerClass</span> </span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String label;<br><br>        InnerClass(String whereTo) &#123;<br>            label = whereTo;<br>        &#125;<br><br>        <span class="hljs-function">String <span class="hljs-title">readLabel</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> label + (i1++);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ship</span><span class="hljs-params">(String dest)</span> </span>&#123;<br>        InnerClass i = <span class="hljs-keyword">new</span> InnerClass(dest);<br>        System.out.println(i.readLabel());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.course.innerclasstest;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        OuterClass outerClass = <span class="hljs-keyword">new</span> OuterClass();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">4</span>; i++)<br>            outerClass.ship(<span class="hljs-string">&quot;1Test&quot;</span>);<br>        OuterClass.InnerClass innerClass = outerClass.<span class="hljs-function">new <span class="hljs-title">InnerClass</span><span class="hljs-params">(<span class="hljs-string">&quot;2Test&quot;</span>)</span></span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">5</span>; i &lt;= <span class="hljs-number">9</span>; i++)<br>            System.out.println(innerClass.readLabel());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs">1Test0<br>1Test1<br>1Test2<br>1Test3<br>1Test4<br>2Test5<br>2Test6<br>2Test7<br>2Test8<br>2Test9<br></code></pre></td></tr></table></figure><h3 id="静态内部类"><a href="#静态内部类" class="headerlink" title="静态内部类"></a>静态内部类</h3><p>可以在外部类外直接创建静态内部类</p><p>静态内部类无法直接访问外部类的非static成员，但可以通过创建外部类实例访问，如eg2。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112102354155.png" alt=""></p><p>eg. PPT魔改例</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.course.innerclasstest2;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OuterClass</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> a = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> b = <span class="hljs-number">2</span>;<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InnerClass</span> </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> c = <span class="hljs-number">3</span>;<br><br>        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-comment">//            System.out.println(&quot;OuterClass&#x27;s a: &quot; + a);  // ERROR</span><br>            System.out.println(<span class="hljs-string">&quot;OuterClass&#x27;s b: &quot;</span> + b);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        OuterClass.InnerClass.show();<br>        OuterClass.InnerClass innerClass = <span class="hljs-keyword">new</span> OuterClass.InnerClass();<br>        System.out.println(innerClass.c);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>eg2.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.course.innerclasstest3;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OuterClass</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String s1 = <span class="hljs-string">&quot;I am in OuterClass&quot;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String s2 = <span class="hljs-string">&quot;static in OuterClass&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InnerClass</span> </span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String s1 = <span class="hljs-string">&quot;I am in InnerClass&quot;</span>;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String s3 = <span class="hljs-keyword">new</span> OuterClass().s1;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span><span class="hljs-params">()</span> </span>&#123;<br>            System.out.println(s1);<br>            System.out.println(<span class="hljs-keyword">this</span>.s1);<br>            System.out.println(s3);<br>            System.out.println(s2);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        OuterClass.InnerClass innerClass = <span class="hljs-keyword">new</span> OuterClass.InnerClass();<br><span class="hljs-comment">//        System.out.println(innerClass instanceof OuterClass);  // ERROR 内部类不是外围类的子类</span><br>        innerClass.display();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">I</span> am in InnerClass<br><span class="hljs-selector-tag">I</span> am in InnerClass<br><span class="hljs-selector-tag">I</span> am in OuterClass<br>static<br></code></pre></td></tr></table></figure><h3 id="匿名内部类"><a href="#匿名内部类" class="headerlink" title="匿名内部类"></a>匿名内部类</h3><p>匿名内部类（anonymous inner class）</p><p>这种方法最好使用lambda表达式替代，如lambda表达式那一节的截图一般。</p><p>假设有一个超类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Class1</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;I am Class1&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>一般的类创建实例的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Class2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Class1</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;I am Class2&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Class1 commonClassObject = <span class="hljs-keyword">new</span> Class2();<br>        commonClassObject.display();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>匿名内部类创建实例的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Class1 anonymousInnerClassObject = <span class="hljs-keyword">new</span> Class1() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span><span class="hljs-params">()</span> </span>&#123;<br>                System.out.println(<span class="hljs-string">&quot;I am Class3&quot;</span>);<br>            &#125;<br>        &#125;;<br>        anonymousInnerClassObject.display();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>可以看到减少了不少代码量</p><p>完整测试代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> edu.wanpengxu.course.anonymousinnerclasstest;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Class1</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;I am Class1&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Class2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Class1</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;I am Class2&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Class1 commonClassObject = <span class="hljs-keyword">new</span> Class2();<br>        commonClassObject.display();<br><br>        Class1 anonymousInnerClassObject = <span class="hljs-keyword">new</span> Class1() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">display</span><span class="hljs-params">()</span> </span>&#123;<br>                System.out.println(<span class="hljs-string">&quot;I am Class3&quot;</span>);<br>            &#125;<br>        &#125;;<br>        anonymousInnerClassObject.display();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">I</span> am Class<span class="hljs-number">2</span><br><span class="hljs-attribute">I</span> am Class<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>事实上除了创建类的实例，还可以创建接口的实例。</p><h1 id="12-9-异常"><a href="#12-9-异常" class="headerlink" title="12.9 异常"></a>12.9 异常</h1><h2 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h2><h1 id="12-27-并发"><a href="#12-27-并发" class="headerlink" title="12.27 并发"></a>12.27 并发</h1>]]></content>
    
    
    <categories>
      
      <category>编程语言</category>
      
      <category>Java</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>备考2021年12月CSP学习笔记</title>
    <link href="/2021/11/28/%E5%A4%87%E8%80%832021%E5%B9%B412%E6%9C%88CSP%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <url>/2021/11/28/%E5%A4%87%E8%80%832021%E5%B9%B412%E6%9C%88CSP%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<blockquote><p>结语：第24次CSP认证尘埃落定，210分，并不很理想，甚至没有我大一时考的高，但并不能认为自己退步了，因为近年的T2都有30%的卡常数据。T4、T5我也都写出了暴力解法，保守能过25+12分的点，但本次比赛最后一个小时一直waiting，心态崩掉了，也不知道该改哪里。学如逆水行舟，不进则退。退的不多又何尝不是一种进步呢？</p></blockquote><h1 id="202109"><a href="#202109" class="headerlink" title="202109"></a>202109</h1><h2 id="第1题"><a href="#第1题" class="headerlink" title="第1题"></a>第1题</h2><h3 id="题目链接"><a href="#题目链接" class="headerlink" title="题目链接"></a>题目链接</h3><p><a href="http://118.190.20.162/view.page?gpid=T129">202109-1 数组推导</a></p><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p>$A_1, A_2, \cdots, A_n$ 是一个由 $n$ 个<strong>自然数</strong>（即非负整数）组成的数组。在此基础上，我们用数组 $B_1 \cdots B_n$ 表示 $A$ 的前缀最大值。</p><script type="math/tex; mode=display">B_i = \max \left\{ A_1, A_2,  \cdots, A_i \right\}</script><p>如上所示，$B_i$ 定义为数组 $A$ 中前 $i$ 个数的最大值。<br>根据该定义易知 $A_1 = B_1$，且随着 $i$ 的增大，$B_i$ 单调不降。<br>此外，我们用 $sum = A_1 + A_2 + \cdots + A_n$ 表示数组 $A$ 中 $n$ 个数的总和。</p><p>现已知数组 $B$，我们想要根据 $B$ 的值来反推数组 $A$。<br>显然，对于给定的 $B$，$A$ 的取值可能并不唯一。<br>试计算，在数组 $A$ 所有可能的取值情况中，$sum$ 的最大值和最小值分别是多少？</p><h3 id="输入格式"><a href="#输入格式" class="headerlink" title="输入格式"></a>输入格式</h3><p>从标准输入读入数据。</p><p>输入的第一行包含一个正整数 $n$。</p><p>输入的第二行包含 $n$ 个用空格分隔的自然数 $B_1, B_2, \cdots, B_n$。</p><h3 id="输出格式"><a href="#输出格式" class="headerlink" title="输出格式"></a>输出格式</h3><p>输出到标准输出。</p><p>输出共两行。</p><p>第一行输出一个整数，表示 $sum$ 的最大值。</p><p>第二行输出一个整数，表示 $sum$ 的最小值。</p><h3 id="样例1输入"><a href="#样例1输入" class="headerlink" title="样例1输入"></a>样例1输入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs data">6<br>0 0 5 5 10 10<br></code></pre></td></tr></table></figure><h3 id="样例1输出"><a href="#样例1输出" class="headerlink" title="样例1输出"></a>样例1输出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs data">30<br>15<br></code></pre></td></tr></table></figure><h3 id="样例1解释"><a href="#样例1解释" class="headerlink" title="样例1解释"></a>样例1解释</h3><p>数组 $A$ 的可能取值包括但不限于以下三种情况。</p><p>情况一：$A = [0, 0, 5, 5, 10, 10]$</p><p>情况二：$A = [0, 0, 5, 3, 10, 4]$</p><p>情况三：$A = [0, 0, 5, 0, 10, 0]$</p><p>其中第一种情况 $sum = 30$ 为最大值，第三种情况 $sum = 15$ 为最小值。</p><h3 id="样例2输入"><a href="#样例2输入" class="headerlink" title="样例2输入"></a>样例2输入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs data">7<br>10 20 30 40 50 60 75<br></code></pre></td></tr></table></figure><h3 id="样例2输出"><a href="#样例2输出" class="headerlink" title="样例2输出"></a>样例2输出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs data">285<br>285<br></code></pre></td></tr></table></figure><h3 id="样例2解释"><a href="#样例2解释" class="headerlink" title="样例2解释"></a>样例2解释</h3><p>$A = [10, 20, 30, 40, 50, 60, 75]$ 是唯一可能的取值，所以 $sum$ 的最大、最小值均为 $285$。</p><h3 id="子任务"><a href="#子任务" class="headerlink" title="子任务"></a>子任务</h3><p>$50%$ 的测试数据满足数组 $B$ 单调递增，即 $0 &lt; B_1 &lt; B_2 &lt; \cdots &lt; B_n &lt; 10^{5}$；</p><p>全部的测试数据满足 $n \le 100$ 且数组 $B$ 单调不降，即 $0 \le B_1 \le B_2 \le \cdots \le B_n \le 10^{5}$。</p><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>由题意，显然有$0\le A_i\le B_i$，当想要得到最大值时，只需令$A_i=B_i$，此时的数组$A_1, A_2, \cdots, A_n=B_1 \cdots B_n$，当想要得到最小值时，只需令</p><script type="math/tex; mode=display">A_i=\left\{\begin{aligned}0 & , & B_{i-1} = B_i \\B_i & , & B_{i-1}< B_i \end{aligned}\right.</script><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">n=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br>b=[<span class="hljs-built_in">int</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">input</span>().split()]<br>max_sum=<span class="hljs-built_in">sum</span>(b)<br>min_sum=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n-<span class="hljs-number">1</span>,<span class="hljs-number">1</span>-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">if</span> b[i-<span class="hljs-number">1</span>]&gt;=b[i]:<br>        min_sum+=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">else</span>:<br>        min_sum+=b[i]<br>min_sum+=b[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(max_sum)<br><span class="hljs-built_in">print</span>(min_sum)<br></code></pre></td></tr></table></figure><h1 id="202104"><a href="#202104" class="headerlink" title="202104"></a>202104</h1><h2 id="第1题-1"><a href="#第1题-1" class="headerlink" title="第1题"></a>第1题</h2><h3 id="题目链接-1"><a href="#题目链接-1" class="headerlink" title="题目链接"></a>题目链接</h3><p><a href="http://118.190.20.162/view.page?gpid=T128">202104-1 灰度直方图</a></p><h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><p>一幅长宽分别为 $n$ 个像素和 $m$ 个像素的灰度图像可以表示为一个 $n×m$ 大小的矩阵 $A$。<br>其中每个元素 $Aij$（$0≤i&lt;n$、$0≤j&lt;m$）是一个 $[0,L)$ 范围内的整数，表示对应位置像素的灰度值。<br>具体来说，一个 $8$ 比特的灰度图像中每个像素的灰度范围是 $[0,128)$。</p><p>一副灰度图像的灰度统计直方图（以下简称“直方图”）可以表示为一个长度为 $L$ 的数组 $h$，其中 $h[x]$（$0≤x&lt;L$）表示该图像中灰度值为 $x$ 的像素个数。显然，$h[0]$ 到 $h[L−1]$ 的总和应等于图像中的像素总数 $n⋅m$。</p><p>已知一副图像的灰度矩阵 $A$，试计算其灰度直方图 $h[0],h[1],⋯,h[L−1]$。</p><h3 id="输入格式-1"><a href="#输入格式-1" class="headerlink" title="输入格式"></a>输入格式</h3><p>输入共 $n+1$ 行。</p><p>输入的第一行包含三个用空格分隔的正整数 $n$、$m$ 和 $L$，含义如前文所述。</p><p>第 $2$ 到第 $n+1$ 行输入矩阵 $A$。<br>第 $i+2$（$0≤i&lt;n$）行包含用空格分隔的 $m$ 个整数，依次为 $A<em>{i0},A</em>{i1},⋯,A_{i(m−1)}$。</p><h3 id="输出格式-1"><a href="#输出格式-1" class="headerlink" title="输出格式"></a>输出格式</h3><p>输出仅一行，包含用空格分隔的 $L$ 个整数 $h[0],h[1],⋯,h[L−1]$，表示输入图像的灰度直方图。</p><h3 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs data">4 4 16<br>0 1 2 3<br>4 5 6 7<br>8 9 10 11<br>12 13 14 15<br></code></pre></td></tr></table></figure><h3 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs data">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1<br></code></pre></td></tr></table></figure><h3 id="样例输入-1"><a href="#样例输入-1" class="headerlink" title="样例输入"></a>样例输入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs data">7 11 8<br>0 7 0 0 0 7 0 0 7 7 0<br>7 0 7 0 7 0 7 0 7 0 7<br>7 0 0 0 7 0 0 0 7 0 7<br>7 0 0 0 0 7 0 0 7 7 0<br>7 0 0 0 0 0 7 0 7 0 0<br>7 0 7 0 7 0 7 0 7 0 0<br>0 7 0 0 0 7 0 0 7 0 0<br></code></pre></td></tr></table></figure><h3 id="样例输出-1"><a href="#样例输出-1" class="headerlink" title="样例输出"></a>样例输出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs data">48 0 0 0 0 0 0 29<br></code></pre></td></tr></table></figure><h3 id="评测用例规模与约定"><a href="#评测用例规模与约定" class="headerlink" title="评测用例规模与约定"></a>评测用例规模与约定</h3><p>全部的测试数据满足 $0&lt;n,m≤500$ 且 $4≤L≤256$。</p><h3 id="分析-1"><a href="#分析-1" class="headerlink" title="分析"></a>分析</h3><p>模拟题</p><p>根据题意构建各变量然后统计即可。</p><h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">n,m,L=<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">input</span>().split())<br>A=[]<br>h=[<span class="hljs-number">0</span>]*L<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    A+=[<span class="hljs-built_in">int</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">input</span>().split()]<br><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> A:<br>    h[a]+=<span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27; &#x27;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>,h)))<br></code></pre></td></tr></table></figure><h2 id="第2题"><a href="#第2题" class="headerlink" title="第2题"></a>第2题</h2><h3 id="题目链接-2"><a href="#题目链接-2" class="headerlink" title="题目链接"></a>题目链接</h3><p><a href="http://118.190.20.162/view.page?gpid=T127">202104-2 邻域均值</a></p><h3 id="试题背景"><a href="#试题背景" class="headerlink" title="试题背景"></a>试题背景</h3><p>顿顿在学习了数字图像处理后，想要对手上的一副灰度图像进行降噪处理。不过该图像仅在较暗区域有很多噪点，如果贸然对全图进行降噪，会在抹去噪点的同时也模糊了原有图像。因此顿顿打算先使用<strong>邻域均值</strong>来判断一个像素是否处于<strong>较暗区域</strong>，然后仅对处于<strong>较暗区域</strong>的像素进行降噪处理。</p><h3 id="问题描述-1"><a href="#问题描述-1" class="headerlink" title="问题描述"></a>问题描述</h3><p>待处理的灰度图像长宽皆为 $n$ 个像素，可以表示为一个 $n×n$ 大小的矩阵 $A$，其中每个元素是一个 $[0,L)$ 范围内的整数，表示对应位置像素的灰度值。<br>对于矩阵中任意一个元素 $Aij(0≤i,j&lt;n)$，其<strong>邻域</strong>定义为附近若干元素的集合：</p><script type="math/tex; mode=display">Neighbor(i, j, r) = \left\{ A_{xy} | 0 \le x, y < n \mathrm{~and~} |x-i| \le r \mathrm{~and~} |y-j| \le r \right\}</script><p>这里使用了一个额外的参数 $r$ 来指明 $Aij$ 附近元素的具体范围。根据定义，易知 $Neighbor(i,j,r)$ 最多有 $(2r+1)^2$ 个元素。</p><p>如果元素 $Aij$ <strong>邻域</strong>中所有元素的<strong>平均值</strong>小于或等于一个给定的阈值 $t$，我们就认为该元素对应位置的像素处于<strong>较暗区域</strong>。<br>下图给出了两个例子，左侧图像的较暗区域在右侧图像中展示为黑色，其余区域展示为白色。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111281731890.jpg" alt=""></p><p>现给定邻域参数 $r$ 和阈值 $t$，试统计输入灰度图像中有多少像素处于<strong>较暗区域</strong>。</p><h3 id="输入格式-2"><a href="#输入格式-2" class="headerlink" title="输入格式"></a>输入格式</h3><p>输入共 $n+1$ 行。</p><p>输入的第一行包含四个用空格分隔的正整数 $n、L、r $ 和 $t$，含义如前文所述。</p><p>第二到第 $n+1$ 行输入矩阵 $A$。<br>第 $i+2(0≤i&lt;n)$ 行包含用空格分隔的$n$个整数，依次为 $Ai0,Ai1,⋯,Ai(n−1)$。</p><h3 id="输出格式-2"><a href="#输出格式-2" class="headerlink" title="输出格式"></a>输出格式</h3><p>输出一个整数，表示输入灰度图像中处于较暗区域的像素总数。</p><h3 id="样例输入-2"><a href="#样例输入-2" class="headerlink" title="样例输入"></a>样例输入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs data">4 16 1 6<br>0 1 2 3<br>4 5 6 7<br>8 9 10 11<br>12 13 14 15<br></code></pre></td></tr></table></figure><h3 id="样例输出-2"><a href="#样例输出-2" class="headerlink" title="样例输出"></a>样例输出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs data">7<br></code></pre></td></tr></table></figure><h3 id="样例输入-3"><a href="#样例输入-3" class="headerlink" title="样例输入"></a>样例输入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs data">11 8 2 2<br>0 0 0 0 0 0 0 0 0 0 0<br>0 0 0 0 0 0 0 0 0 0 0<br>0 7 0 0 0 7 0 0 7 7 0<br>7 0 7 0 7 0 7 0 7 0 7<br>7 0 0 0 7 0 0 0 7 0 7<br>7 0 0 0 0 7 0 0 7 7 0<br>7 0 0 0 0 0 7 0 7 0 0<br>7 0 7 0 7 0 7 0 7 0 0<br>0 7 0 0 0 7 0 0 7 0 0<br>0 0 0 0 0 0 0 0 0 0 0<br>0 0 0 0 0 0 0 0 0 0 0<br></code></pre></td></tr></table></figure><h3 id="样例输出-3"><a href="#样例输出-3" class="headerlink" title="样例输出"></a>样例输出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs data">83<br></code></pre></td></tr></table></figure><h3 id="评测用例规模与约定-1"><a href="#评测用例规模与约定-1" class="headerlink" title="评测用例规模与约定"></a>评测用例规模与约定</h3><p>70% 的测试数据满足 $n≤100$、$r≤10$。</p><p>全部的测试数据满足 $0&lt;n≤600$、$0&lt;r≤100$ 且 $2≤t&lt;L≤256$。</p><h3 id="分析-2"><a href="#分析-2" class="headerlink" title="分析"></a>分析</h3><p>题目要求计算领域均值，那么首先要计算的是<script type="math/tex">\sum{Neighbor(i, j, r)}</script>，其次是$|Neighbor(i,j,r)|$，对于<script type="math/tex">\sum{Neighbor(i, j, r)}</script>，不难发现，如果对每一个元素进行暴力求解，将会计算大量重复区域，这样的话我们可以使用<strong>二维前缀和</strong>方法，即对于一个矩阵 $a$，我们定义一个矩阵 $psum$，使得 <script type="math/tex">psum_{x,y}=\sum\limits_{i=1}^{x}\sum\limits_{j=1}^{y}a_{i,j}</script>，那么，要求解某一个特定的子矩阵的和，只需使用容斥原理即可。</p><h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">n,L,r,t=<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">input</span>().split())<br>A=[[<span class="hljs-number">0</span>]*(n+<span class="hljs-number">1</span>)]<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    A.append([<span class="hljs-number">0</span>]+[<span class="hljs-built_in">int</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">input</span>().split()])<br>psum=[[<span class="hljs-number">0</span>]*(n+<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>        psum[i][j]=psum[i-<span class="hljs-number">1</span>][j]+psum[i][j-<span class="hljs-number">1</span>]-psum[i-<span class="hljs-number">1</span>][j-<span class="hljs-number">1</span>]+A[i][j]<br>num=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,n+<span class="hljs-number">1</span>):<br>        w=<span class="hljs-built_in">max</span>(j-r,<span class="hljs-number">1</span>)<br>        s=<span class="hljs-built_in">min</span>(j+r,n)<br>        a=<span class="hljs-built_in">max</span>(i-r,<span class="hljs-number">1</span>)<br>        d=<span class="hljs-built_in">min</span>(i+r,n)<br>        st=(psum[d][s]-psum[d][w-<span class="hljs-number">1</span>]-psum[a-<span class="hljs-number">1</span>][s]+psum[a-<span class="hljs-number">1</span>][w-<span class="hljs-number">1</span>])<br>        <span class="hljs-keyword">if</span> st&lt;=t*((s-w+<span class="hljs-number">1</span>)*(d-a+<span class="hljs-number">1</span>)):<br>            num+=<span class="hljs-number">1</span><br><span class="hljs-built_in">print</span>(num)<br></code></pre></td></tr></table></figure><h2 id="第3题"><a href="#第3题" class="headerlink" title="第3题"></a>第3题</h2><h3 id="题目链接-3"><a href="#题目链接-3" class="headerlink" title="题目链接"></a>题目链接</h3><p><a href="http://118.190.20.162/view.page?gpid=T126"> 202104-3 DHCP服务器</a></p><h3 id="试题背景-1"><a href="#试题背景-1" class="headerlink" title="试题背景"></a>试题背景</h3><p><strong>动态主机配置协议</strong>（Dynamic Host Configuration Protocol, DHCP）是一种自动为网络客户端分配 IP 地址的网络协议。当支持该协议的计算机刚刚接入网络时，它可以启动一个 DHCP 客户端程序。后者可以通过一定的网络报文交互，从 DHCP 服务器上获得 IP 地址等网络配置参数，从而能够在用户不干预的情况下，自动完成对计算机的网络设置，方便用户连接网络。DHCP 协议的工作过程如下：</p><ol><li>当 DHCP 协议启动的时候，DHCP 客户端向网络中广播发送 Discover 报文，请求 IP 地址配置；</li><li>当 DHCP 服务器收到 Discover 报文时，DHCP 服务器根据报文中的参数选择一个尚未分配的 IP 地址，分配给该客户端。DHCP 服务器用 Offer 报文将这个信息传达给客户端；</li><li>客户端收集收到的 Offer 报文。由于网络中可能存在多于一个 DHCP 服务器，因此客户端可能收集到多个 Offer 报文。客户端从这些报文中选择一个，并向网络中广播 Request 报文，表示选择这个 DHCP 服务器发送的配置；</li><li>DHCP 服务器收到 Request 报文后，首先判断该客户端是否选择本服务器分配的地址：如果不是，则在本服务器上解除对那个 IP 地址的占用；否则则再次确认分配的地址有效，并向客户端发送 Ack 报文，表示确认配置有效，Ack 报文中包括配置的有效时间。如果 DHCP 发现分配的地址无效，则返回 Nak 报文；</li><li>客户端收到 Ack 报文后，确认服务器分配的地址有效，即确认服务器分配的地址未被其它客户端占用，则完成网络配置，同时记录配置的有效时间，出于简化的目的，我们不考虑被占用的情况。若客户端收到 Nak 报文，则从步骤 1 重新开始；</li><li>客户端在到达配置的有效时间前，再次向 DHCP 服务器发送 Request 报文，表示希望延长 IP 地址的有效期。DHCP 服务器按照步骤 4 确定是否延长，客户端按照步骤 5 处理后续的配置；</li></ol><p>在本题目中，你需要理解 DHCP 协议的工作过程，并按照题目的要求实现一个简单的 DHCP 服务器。</p><h3 id="问题描述-2"><a href="#问题描述-2" class="headerlink" title="问题描述"></a>问题描述</h3><h4 id="报文格式"><a href="#报文格式" class="headerlink" title="报文格式"></a>报文格式</h4><p>为了便于实现，我们简化地规定 DHCP 数据报文的格式如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs none">&lt;发送主机&gt; &lt;接收主机&gt; &lt;报文类型&gt; &lt;IP 地址&gt; &lt;过期时刻&gt;<br></code></pre></td></tr></table></figure><p>DHCP 数据报文的各个部分由空格分隔，其各个部分的定义如下：</p><ul><li>发送主机：是发送报文的主机名，<strong>主机名</strong>是由小写字母、数字组成的字符串，唯一地表示了一个主机；</li><li>接收主机：当有特定的接收主机时，是接收报文的主机名；当没有特定的接收主机时，为一个星号（<code>*</code>）；</li><li>报文类型：是三个大写字母，取值如下：<ul><li><code>DIS</code>：表示 Discover 报文；</li><li><code>OFR</code>：表示 Offer 报文；</li><li><code>REQ</code>：表示 Request 报文；</li><li><code>ACK</code>：表示 Ack 报文；</li><li><code>NAK</code>：表示 Nak 报文；</li></ul></li><li>IP 地址，是一个非负整数：<ul><li>对于 Discover 报文，该部分在发送的时候为 0，在接收的时候忽略；</li><li>对于其它报文，为正整数，表示一个 IP 地址；</li></ul></li><li>过期时刻，是一个非负整数：<ul><li>对于 Offer、Ack 报文，是一个正整数，表示服务器授予客户端的 IP 地址的过期时刻；</li><li>对于 Discover、Request 报文，若为正整数，表示客户端期望服务器授予的过期时刻；</li><li>对于其它报文，该部分在发送的时候为 0，在接收的时候忽略。</li></ul></li></ul><p>例如下列都是合法的 DHCP 数据报文：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs none">a * DIS 0 0<br>d a ACK 50 1000<br></code></pre></td></tr></table></figure><h4 id="服务器配置"><a href="#服务器配置" class="headerlink" title="服务器配置"></a>服务器配置</h4><p>为了 DHCP 服务器能够正确分配 IP 地址，DHCP 需要接受如下配置：</p><ul><li>地址池大小 N：表示能够分配给客户端的 IP 地址的数目，且能分配的 IP 地址是 1,2,…,N；</li><li>默认过期时间 Tdef：表示分配给客户端的 IP 地址的默认的过期时间长度；</li><li>过期时间的上限和下限 Tmax、Tmin：表示分配给客户端的 IP 地址的最长过期时间长度和最短过期时间长度，客户端不能请求比这个更长或更短的过期时间；</li><li>本机名称 H：表示运行 DHCP 服务器的主机名。</li></ul><h4 id="分配策略"><a href="#分配策略" class="headerlink" title="分配策略"></a>分配策略</h4><p>当客户端请求 IP 地址时，首先检查此前是否给该客户端分配过 IP 地址，且该 IP 地址在此后没有被分配给其它客户端。如果是这样的情况，则直接将 IP 地址分配给它，否则，<br>总是分配给它最小的尚未占用过的那个 IP 地址。如果这样的地址不存在，则分配给它最小的此时未被占用的那个 IP 地址。如果这样的地址也不存在，说明地址池已经分配完毕，因此拒绝分配地址。</p><h4 id="实现细节"><a href="#实现细节" class="headerlink" title="实现细节"></a>实现细节</h4><p>在 DHCP 启动时，首先初始化 IP 地址池，将所有地址设置状态为未分配，占用者为空，并清零过期时刻。<br>其中地址的状态有未分配、待分配、占用、过期四种。<br>处于未分配状态的 IP 地址没有占用者，而其余三种状态的 IP 地址均有一名占用者。<br>处于待分配和占用状态的 IP 地址拥有一个大于零的过期时刻。在到达该过期时刻时，若该地址的状态是待分配，则该地址的状态会自动变为未分配，且占用者清空，过期时刻清零；否则该地址的状态会由占用自动变为过期，且过期时刻清零。处于未分配和过期状态的 IP 地址过期时刻为零，即没有过期时刻。</p><p>对于收到的报文，设其收到的时刻为 t。处理细节如下：</p><ol><li>判断接收主机是否为本机，或者为 <code>*</code>，若不是，则判断类型是否为 Request，若不是，则不处理；</li><li>若类型不是 Discover、Request 之一，则不处理；</li><li>若接收主机为 <code>*</code>，但类型不是 Discover，或接收主机是本机，但类型是 Discover，则不处理。</li></ol><p>对于 Discover 报文，按照下述方法处理：</p><ol><li>检查是否有占用者为发送主机的 IP 地址：<ul><li>若有，则选取该 IP 地址；</li><li>若没有，则选取最小的状态为未分配的 IP 地址；</li><li>若没有，则选取最小的状态为过期的 IP 地址；</li><li>若没有，则不处理该报文，处理结束；</li></ul></li><li>将该 IP 地址状态设置为待分配，占用者设置为发送主机；</li><li>若报文中过期时刻为 0 ，则设置过期时刻为 t+Tdef；否则根据报文中的过期时刻和收到报文的时刻计算过期时间，判断是否超过上下限：若没有超过，则设置过期时刻为报文中的过期时刻；否则则根据超限情况设置为允许的最早或最晚的过期时刻；</li><li>向发送主机发送 Offer 报文，其中，IP 地址为选定的 IP 地址，过期时刻为所设定的过期时刻。</li></ol><p>对于 Request 报文，按照下述方法处理：</p><ol><li>检查接收主机是否为本机：<ul><li>若不是，则找到占用者为发送主机的所有 IP 地址，对于其中状态为待分配的，将其状态设置为未分配，并清空其占用者，清零其过期时刻，处理结束；</li></ul></li><li>检查报文中的 IP 地址是否在地址池内，且其占用者为发送主机，若不是，则向发送主机发送 Nak 报文，处理结束；</li><li>无论该 IP 地址的状态为何，将该 IP 地址的状态设置为占用；</li><li>与 Discover 报文相同的方法，设置 IP 地址的过期时刻；</li><li>向发送主机发送 Ack 报文。</li></ol><p>上述处理过程中，地址池中地址的状态的变化可以概括为如下图所示的状态转移图。为了简洁，该图中没有涵盖需要回复 Nak 报文的情况。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111281721522.jfif" alt=""></p><h3 id="输入格式-3"><a href="#输入格式-3" class="headerlink" title="输入格式"></a>输入格式</h3><p>输入的第一行包含用空格分隔的四个正整数和一个字符串，分别是：N、Tdef、Tmax、Tmin 和 H，保证 Tmin≤Tdef≤Tmax。</p><p>输入的第二行是一个正整数 n，表示收到了 n 个报文。</p><p>输入接下来有 n 行，第 (i+2) 行有空格分隔的正整数 ti 和约定格式的报文 Pi。表示收到的第 i 个报文是在 ti 时刻收到的，报文内容是 Pi。保证 ti&lt;ti+1。</p><h3 id="输出格式-3"><a href="#输出格式-3" class="headerlink" title="输出格式"></a>输出格式</h3><p>输出有若干行，每行是一个约定格式的报文。依次输出 DHCP 服务器发送的报文。</p><h3 id="样例输入-4"><a href="#样例输入-4" class="headerlink" title="样例输入"></a>样例输入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs data">4 5 10 5 dhcp<br>16<br>1 a * DIS 0 0<br>2 a dhcp REQ 1 0<br>3 b a DIS 0 0<br>4 b * DIS 3 0<br>5 b * REQ 2 12<br>6 b dhcp REQ 2 12<br>7 c * DIS 0 11<br>8 c dhcp REQ 3 11<br>9 d * DIS 0 0<br>10 d dhcp REQ 4 20<br>11 a dhcp REQ 1 20<br>12 c dhcp REQ 3 20<br>13 e * DIS 0 0<br>14 e dhcp REQ 2 0<br>15 b dhcp REQ 2 25<br>16 b * DIS 0 0<br></code></pre></td></tr></table></figure><h3 id="样例输出-4"><a href="#样例输出-4" class="headerlink" title="样例输出"></a>样例输出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs data">dhcp a OFR 1 6<br>dhcp a ACK 1 7<br>dhcp b OFR 2 9<br>dhcp b ACK 2 12<br>dhcp c OFR 3 12<br>dhcp c ACK 3 13<br>dhcp d OFR 4 14<br>dhcp d ACK 4 20<br>dhcp a ACK 1 20<br>dhcp c ACK 3 20<br>dhcp e OFR 2 18<br>dhcp e ACK 2 19<br>dhcp b NAK 2 0<br></code></pre></td></tr></table></figure><h3 id="样例说明"><a href="#样例说明" class="headerlink" title="样例说明"></a>样例说明</h3><p>输入第一行，分别设置了 DHCP 的相关参数，并收到了 16 个报文。</p><p>第 1 个报文和第 2 个报文是客户端 <code>a</code> 正常请求地址，服务器为其分配了地址 1，相应地设置了过期时刻是 7（即当前时刻 2 加上默认过期时间 5）。</p><p>第 3 个报文不符合 Discover 报文的要求，不做任何处理。</p><p>第 4 个报文 <code>b</code> 发送的 Discover 报文虽然有 IP 地址 3，但是按照处理规则，这个字段被忽略，因此服务器返回 Offer 报文，过期时刻是 9。</p><p>第 5 个报文中，Request 报文不符合接收主机是 DHCP 服务器本机的要求，因此不做任何处理。</p><p>第 6 个报文是 <code>b</code> 发送的 Request 报文，其中设置了过期时刻是 12，没有超过最长过期时间，因此返回的 Ack 报文中过期时刻也是 12。</p><p>第 7 个报文中，过期时刻 11 小于最短过期时间，因此返回的过期时刻是 12。虽然此时为 <code>a</code> 分配的地址 1 过期，但是由于还有状态为未分配的地址 3，因此为 <code>c</code> 分配地址 3。第 8 个报文同理，为 <code>c</code> 分配的地址过期时刻是 13。</p><p>第 9、10 两个报文中，为 <code>d</code> 分配了地址 4，过期时刻是 20。</p><p>第 11 个报文中，<code>a</code> 请求重新获取此前为其分配的地址 1，虽然为其分配的地址过期，但是由于尚未分配给其它客户端，因此 DHCP 服务器可以直接为其重新分配该地址，并重新设置过期时刻为 20。</p><p>第 12 个报文中，<code>c</code> 请求延长其地址的过期时刻为 20。DHCP 正常向其回复 Ack 报文。</p><p>第 13、14 个报文中，<code>e</code> 试图请求地址。此时地址池中已经没有处于“未分配”状态的地址了，但是有此前分配给 <code>b</code> 的地址 2 的状态是“过期”，因此把该地址重新分配给 <code>e</code>。</p><p>第 15 个报文中，<code>b</code> 试图重新获取此前为其分配的地址 2，但是此时该地址已经被分配给 <code>e</code>，因此返回 Nak 报文。</p><p>第 16 个报文中，<code>b</code> 试图重新请求分配一个 IP 地址，但是此时地址池中已经没有可用的地址了，因此忽略该请求。</p><h3 id="样例输入-5"><a href="#样例输入-5" class="headerlink" title="样例输入"></a>样例输入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs data">4 70 100 50 dhcp<br>6<br>5 a * OFR 2 100<br>10 b * DIS 0 70<br>15 b dhcp2 REQ 4 60<br>20 c * DIS 0 70<br>70 d * DIS 0 120<br>75 d dhcp REQ 1 125<br></code></pre></td></tr></table></figure><h3 id="样例输出-5"><a href="#样例输出-5" class="headerlink" title="样例输出"></a>样例输出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs data">dhcp b OFR 1 70<br>dhcp c OFR 1 70<br>dhcp d OFR 1 120<br>dhcp d ACK 1 125<br></code></pre></td></tr></table></figure><h3 id="样例说明-1"><a href="#样例说明-1" class="headerlink" title="样例说明"></a>样例说明</h3><p>在本样例中，DHCP 服务器一共收到了 6 个报文，处理情况如下：</p><p>第 1 个报文不是 DHCP 服务器需要处理的报文，因此不回复任何报文。</p><p>第 2 个报文中，<code>b</code> 请求分配 IP 地址，因此 DHCP 服务器将地址 1 分配给 <code>b</code>，此时，地址 1 进入待分配状态，DHCP 服务器向 <code>b</code> 发送 Offer 报文。</p><p>第 3 个报文中，<code>b</code> 发送的 REQ 报文是发给非本服务器的，因此需要将地址池中所有拥有者是 <code>b</code> 的待分配状态的地址修改为未分配。</p><p>第 4 个报文中，<code>c</code> 请求分配 IP 地址。由于地址 1 此时是未分配状态，因此将该地址分配给它，向它发送 Offer 报文，地址 1 进入待分配状态。</p><p>第 5、6 个报文中，<code>d</code> 请求分配 IP 地址。注意到在收到第 5 个报文时，已经是时刻 70，地址 1 的过期时刻已到，它的状态已经被修改为了未分配，因此 DHCP 服务器仍然将地址 1 分配给 <code>d</code>。</p><h3 id="评测用例规模与约定-2"><a href="#评测用例规模与约定-2" class="headerlink" title="评测用例规模与约定"></a>评测用例规模与约定</h3><p>对于 20% 的数据，有 N≤200，且 n≤N，且输入仅含 Discover 报文，且 t&lt;Tmin；</p><p>对于 50% 的数据，有 N≤200，且 n≤N，且 t&lt;Tmin，且报文的接收主机或为本机，或为 <code>*</code>；</p><p>对于 70% 的数据，有 N≤1000，且 n≤N，且报文的接收主机或为本机，或为 <code>*</code>；</p><p>对于 100% 的数据，有 N≤10000，且 n≤10000，主机名的长度不超过 20，且 t,Tmin,Tdefault,Tmax≤109，输入的报文格式符合题目要求，且数字不超过 109。</p><h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><p>模拟就是用计算机来模拟题目中要求的操作。</p><p>大模拟，也就是复杂模拟题，是CSP中T3的的固定题型。</p><p>代码对应的要求已经注释在了旁边，故这里略。</p><h3 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">10000</span> + <span class="hljs-number">5</span>;<br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ipAddress</span> &#123;</span><br>    <span class="hljs-keyword">int</span> time;<br>    <span class="hljs-keyword">int</span> state;  <span class="hljs-comment">// 1:未分配, 2:待分配, 3:占用, 4:过期</span><br>    string name;<br>&#125;;<br>ipAddress ipPool[N];<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> n, tdef, tmax, tmin;<br>    string host;<br>    cin &gt;&gt; n &gt;&gt; tdef &gt;&gt; tmax &gt;&gt; tmin &gt;&gt; host;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>        ipPool[i].state = <span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">int</span> n2;<br>    cin &gt;&gt; n2;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">1</span>; k &lt;= n2; k++) &#123;<br>        string lhost, rhost, type;<br>        <span class="hljs-keyword">int</span> seq, ip, time;<br>        cin &gt;&gt; seq &gt;&gt; lhost &gt;&gt; rhost &gt;&gt; type &gt;&gt; ip &gt;&gt; time;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++) &#123;<br>            <span class="hljs-comment">// 在到达该过期时刻时</span><br>            <span class="hljs-keyword">if</span> (ipPool[i].time &lt;= seq) &#123;<br>                <span class="hljs-comment">// 若该地址的状态是待分配，则该地址的状态会自动变为未分配，且占用者清空，过期时刻清零；</span><br>                <span class="hljs-keyword">if</span> (ipPool[i].state == <span class="hljs-number">2</span>) &#123;<br>                    ipPool[i].state = <span class="hljs-number">1</span>;<br>                    ipPool[i].name = <span class="hljs-string">&quot;&quot;</span>;<br>                    ipPool[i].time = <span class="hljs-number">0</span>;<br>                &#125;<br>                <span class="hljs-comment">// 否则该地址的状态会由占用自动变为过期，且过期时刻清零。</span><br>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ipPool[i].state == <span class="hljs-number">3</span>) &#123;<br>                    ipPool[i].state = <span class="hljs-number">4</span>;<br>                    ipPool[i].time = <span class="hljs-number">0</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// 对于收到的报文</span><br>        <span class="hljs-comment">// 判断接收主机是否为本机，或者为 *，若不是，则判断类型是否为 Request，若不是，则不处理；</span><br>        <span class="hljs-comment">// 这里判断类型是否为 Request是在或条件后面，本身就是前两个都为假才判断的，可以写在一行</span><br>        <span class="hljs-keyword">if</span> ((rhost == host || rhost == <span class="hljs-string">&quot;*&quot;</span>) || type == <span class="hljs-string">&quot;REQ&quot;</span>) &#123;<br>            <span class="hljs-comment">// 若类型不是 Discover、Request 之一，则不处理；</span><br>            <span class="hljs-keyword">if</span> (type != <span class="hljs-string">&quot;DIS&quot;</span> &amp;&amp; type != <span class="hljs-string">&quot;REQ&quot;</span>)<br>                <span class="hljs-keyword">continue</span>;<br>            <span class="hljs-comment">// 若接收主机为 *，但类型不是 Discover，或接收主机是本机，但类型是 Discover，则不处理。</span><br>            <span class="hljs-keyword">if</span> ((rhost == <span class="hljs-string">&quot;*&quot;</span> &amp;&amp; type != <span class="hljs-string">&quot;DIS&quot;</span>) || (rhost == host &amp;&amp; type == <span class="hljs-string">&quot;DIS&quot;</span>))<br>                <span class="hljs-keyword">continue</span>;<br>            <span class="hljs-comment">// 对于 Discover 报文</span><br>            <span class="hljs-keyword">if</span> (type == <span class="hljs-string">&quot;DIS&quot;</span>) &#123;<br>                <span class="hljs-keyword">int</span> select = <span class="hljs-number">-1</span>;<br>                <span class="hljs-comment">// 检查是否有占用者为发送主机的 IP 地址</span><br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>                    <span class="hljs-comment">// 若有，则选取该 IP 地址；</span><br>                    <span class="hljs-comment">// 加一条，IP地址应为未分配的</span><br>                    <span class="hljs-keyword">if</span> (ipPool[i].name == lhost &amp;&amp; ipPool[i].state != <span class="hljs-number">1</span>) &#123;<br>                        select = i;<br>                        <span class="hljs-keyword">break</span>;<br>                    &#125;<br>                <span class="hljs-comment">// 若没有，则选取最小的状态为未分配的 IP 地址；</span><br>                <span class="hljs-keyword">if</span> (select == <span class="hljs-number">-1</span>) &#123;<br>                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>                        <span class="hljs-keyword">if</span> (ipPool[i].state == <span class="hljs-number">1</span>) &#123;<br>                            select = i;<br>                            <span class="hljs-keyword">break</span>;<br>                        &#125;<br>                &#125;<br>                <span class="hljs-comment">// 若没有，则选取最小的状态为过期的 IP 地址；</span><br>                <span class="hljs-keyword">if</span> (select == <span class="hljs-number">-1</span>) &#123;<br>                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>                        <span class="hljs-keyword">if</span> (ipPool[i].state == <span class="hljs-number">4</span>) &#123;<br>                            select = i;<br>                            <span class="hljs-keyword">break</span>;<br>                        &#125;<br>                &#125;<br>                <span class="hljs-keyword">if</span> (select != <span class="hljs-number">-1</span>) &#123;<br>                    <span class="hljs-comment">// 将该 IP 地址状态设置为待分配，占用者设置为发送主机；</span><br>                    ipPool[select].state = <span class="hljs-number">2</span>;<br>                    ipPool[select].name = lhost;<br>                    <span class="hljs-comment">// 若报文中过期时刻为 0 ，则设置过期时刻为t+T_def；</span><br>                    <span class="hljs-keyword">if</span> (time == <span class="hljs-number">0</span>)<br>                        ipPool[select].time = seq + tdef;<br>                    <span class="hljs-comment">// 否则根据报文中的过期时刻和收到报文的时刻计算过期时间，判断是否超过上下限：</span><br>                    <span class="hljs-comment">// 计算方法：过期时刻-收到时刻=过期时间</span><br>                    <span class="hljs-comment">// 若没有超过，则设置过期时刻为报文中的过期时刻；</span><br>                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tmin &lt;= time - seq &amp;&amp; time - seq &lt;= tmax)<br>                        ipPool[select].time = time;<br>                    <span class="hljs-comment">// 若没有超过，则设置过期时刻为报文中的过期时刻；</span><br>                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (time - seq &lt; tmin)<br>                        ipPool[select].time = seq + tmin;<br>                    <span class="hljs-comment">// 否则则根据超限情况设置为允许的最早或最晚的过期时刻；</span><br>                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (time - seq &gt; tmax)<br>                        ipPool[select].time = seq + tmax;<br>                    <span class="hljs-comment">// 向发送主机发送 Offer 报文，其中，IP 地址为选定的 IP 地址，过期时刻为所设定的过期时刻。</span><br>                    cout &lt;&lt; host &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; lhost &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; <span class="hljs-string">&quot;OFR&quot;</span> &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; select &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; ipPool[select].time &lt;&lt; endl;<br>                &#125;<br>            &#125;<br>            <span class="hljs-comment">// 对于 Request 报文</span><br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (type == <span class="hljs-string">&quot;REQ&quot;</span>) &#123;<br>                <span class="hljs-comment">// 检查接收主机是否为本机：</span><br>                <span class="hljs-keyword">if</span> (rhost != host) &#123;<br>                    <span class="hljs-comment">// 若不是，则找到占用者为发送主机的所有 IP 地址，对于其中状态为待分配的，将其状态设置为未分配，并清空其占用者，清零其过期时刻，处理结束；</span><br>                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>                        <span class="hljs-keyword">if</span> (ipPool[i].name == lhost &amp;&amp; ipPool[i].state == <span class="hljs-number">2</span>) &#123;<br>                            ipPool[i].state = <span class="hljs-number">1</span>;<br>                            ipPool[i].name = <span class="hljs-string">&quot;&quot;</span>;<br>                            ipPool[i].time = <span class="hljs-number">0</span>;<br>                        &#125;<br>                &#125;<br>                <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-comment">// 检查报文中的 IP 地址是否在地址池内，且其占用者为发送主机</span><br>                    <span class="hljs-keyword">if</span> (<span class="hljs-number">1</span> &lt;= ip &amp;&amp; ip &lt;= n &amp;&amp; ipPool[ip].name == lhost) &#123;<br>                        <span class="hljs-comment">// 无论该 IP 地址的状态为何，将该 IP 地址的状态设置为占用；</span><br>                        ipPool[ip].state = <span class="hljs-number">3</span>;<br>                        <span class="hljs-comment">// 与 Discover 报文相同的方法，设置 IP 地址的过期时刻；</span><br>                        <span class="hljs-keyword">if</span> (time == <span class="hljs-number">0</span>)<br>                            ipPool[ip].time = seq + tdef;<br>                        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (tmin &lt;= time - seq &amp;&amp; time - seq &lt;= tmax)<br>                            ipPool[ip].time = time;<br>                        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (time - seq &lt; tmin)<br>                            ipPool[ip].time = seq + tmin;<br>                        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (time - seq &gt; tmax)<br>                            ipPool[ip].time = seq + tmax;<br>                        <span class="hljs-comment">// 向发送主机发送 Ack 报文。</span><br>                        cout &lt;&lt; host &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; lhost &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; <span class="hljs-string">&quot;ACK&quot;</span> &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; ip &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; ipPool[ip].time &lt;&lt; endl;<br>                    &#125;<br>                    <span class="hljs-comment">//若不是，则向发送主机发送 Nak 报文，处理结束；</span><br>                    <span class="hljs-keyword">else</span><br>                        cout &lt;&lt; host &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; lhost &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; <span class="hljs-string">&quot;NAK&quot;</span> &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; ip &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; <span class="hljs-string">&quot;0&quot;</span> &lt;&lt; endl;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="第4题"><a href="#第4题" class="headerlink" title="第4题"></a>第4题</h2><h3 id="题目链接-4"><a href="#题目链接-4" class="headerlink" title="题目链接"></a>题目链接</h3><p><a href="http://118.190.20.162/view.page?gpid=T125">202104-4 校门外的树</a></p><h3 id="问题描述-3"><a href="#问题描述-3" class="headerlink" title="问题描述"></a>问题描述</h3><p>X 校最近打算美化一下校园环境。前段时间因为修地铁，X 校大门外种的行道树全部都被移走了。现在 X 校打算重新再种一些树，为校园增添一抹绿意。</p><p>X 校大门外的道路是东西走向的，我们可以将其看成一条数轴。在这条数轴上有 n 个障碍物，例如电线杆之类的。虽然障碍物会影响树的生长，但是障碍物不一定能被随便移走，所以 X 校规定在障碍物的位置上<strong>不能</strong>种树。n 个障碍物的坐标都是整数；如果规定向东为正方向，则 n 个障碍物的坐标按照从西到东的顺序分别为 a1,a2,⋯,an。X 校打算在 [a1,an] 之间种一些树，使得这些树看起来比较美观。</p><p>X 校希望，在一定范围内，树应该是等间隔的。更具体地说，如果把 [a1,an) 划分成一些区间 [ap1,ap2),⋯,[apm−1,apm)（1=p1&lt;p2&lt;⋯&lt;pm=n），那么每个区间 [api,api+1) 内需要至少种一棵树，且该区间内种的树的坐标连同区间端点 api,api+1 应该构成一个等差数列。不同区间的公差，也就是树的间隔可以不相同。</p><p>例如，如果障碍物位于 0,2,6 这三处，那么我们可以选择在 [0,2) 和 [2,6) 分别种树，也可以选择在 [0,6) 等间隔种树。如果是分别在 [0,2) 和 [2,6) 种树，由于每个区间内至少要种一棵树，坐标 1 上必须种树；而 [2,6) 上的树可以按照 1 的间隔种下，也可以按照 2 的间隔种下。下图表示了这两种美观的种树方案，其中橙色的圆表示障碍物，绿色的圆表示需要在这个位置种树，箭头上的数字表示种下这棵树时对应的间隔为多少。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111280209683.png" alt=""></p><p>对区间 [0,2) 和 [2,6) 分别以 1 和 2 的间隔种树是美观的</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111280048528.png" alt=""></p><p>对区间 [0,2) 和 [2,6) 分别以 1 的间隔种树也是美观的</p><p>而如果选择在 [0,6) 区间等间隔种树，我们只能以 3 的间隔种树，因为无论是选择间隔 1 或者间隔 2，都需要在坐标 2 上种树，而这个位置已经有障碍物了。下图分别表示了间隔为 3,2,1 时的种树情况，红色箭头表示不能在这里种树。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111281919845.png" alt=""></p><p>对区间 [0,6) 以 3 的间隔种树是美观的</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111280049170.png" alt=""></p><p>对区间 [0,6) 以 2 的间隔种树是不美观的</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202111281921265.png" alt=""></p><p>对区间 [0,6) 以 1 的间隔种树也是不美观的</p><p>一般地，给定一个区间 $[al,ar)$，对于树的坐标的集合 $T⊂(al,ar)(T⊂Z)$，归纳定义 $T$ 在 $[al,ar)$ 上是<strong>美观的</strong>：</p><ol><li>如果 $T≠∅$，$T∩{al,al+1,⋯,ar}=∅$，并且存在一个公差 $d≥1$，使得 $T∪{al,ar}$ 中的元素按照从小到大的顺序排序后，可以构成一个公差为 $d$ 的等差数列（显然，这个等差数列的首项为 $al$，末项为 $ar$），则 $T$ 在 $[al,ar)$ 上是美观的；</li><li>如果 $T∩{al,al+1,⋯,ar}=∅$，并且存在一个下标 $m（l&lt;m&lt;r）$，使得 $T∩(al,am)$ 在 $[al,am)$ 上是美观的，且 $T∩(am,ar)$ 在 $[am,ar)$ 上是美观的，则 $T$ 在 $[al,ar)$ 上是美观的。</li></ol><p>根据这一定义，空集在任意区间上都不是美观的；另外，如果存在下标 $i$ 使得 $ai∈T$，那么 $T$ 一定不是美观的。</p><p>我们称两种种树的方案是<strong>本质不同的</strong>，当且仅当两种方案中，种树的坐标集合不同。请帮助 X 校对 $[a1,an)$ 求出所有本质不同的美观的种树方案。当然，由于方案可能很多，你只需要输出总方案数对 $10^9+7$ 取模的结果。</p><h3 id="输入格式-4"><a href="#输入格式-4" class="headerlink" title="输入格式"></a>输入格式</h3><p>输入的第一行包含一个正整数 $n$，表示障碍物的数量。</p><p>输入的第二行包括 $n$ 个非负整数 $a1,⋯,an$，表示每个障碍物的坐标。</p><p>保证对 $i=1,2,⋯,n−1$，$ai&lt;ai+1$。</p><h3 id="输出格式-4"><a href="#输出格式-4" class="headerlink" title="输出格式"></a>输出格式</h3><p>输出一个非负整数，表示本质不同的美观的种树方案的数量对 $10^9+7$ 取模的结果。</p><h3 id="样例输入-6"><a href="#样例输入-6" class="headerlink" title="样例输入"></a>样例输入</h3><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-number">3</span><br><span class="hljs-symbol">0 </span><span class="hljs-number">2</span> <span class="hljs-number">6</span><br></code></pre></td></tr></table></figure><h3 id="样例输出-6"><a href="#样例输出-6" class="headerlink" title="样例输出"></a>样例输出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs data">3<br></code></pre></td></tr></table></figure><h3 id="样例说明-2"><a href="#样例说明-2" class="headerlink" title="样例说明"></a>样例说明</h3><p>这组样例即为题面描述中提到的那组。</p><h3 id="样例输入-7"><a href="#样例输入-7" class="headerlink" title="样例输入"></a>样例输入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs data">11<br>0 10 20 30 40 50 60 70 80 90 100<br></code></pre></td></tr></table></figure><h3 id="样例输出-7"><a href="#样例输出-7" class="headerlink" title="样例输出"></a>样例输出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs data">256507<br></code></pre></td></tr></table></figure><h3 id="样例输入-8"><a href="#样例输入-8" class="headerlink" title="样例输入"></a>样例输入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs data">333<br>33 44 67 210 528 762 873 984 1234 1466 1739 2859 3421 4061 4598 5172 5201 5220 5261 5322 5389 5559 6670 7070 7898 8079 8129 8192 8616 8641 8806 9559 9585 9750 10263 10627 10674 10692 10903 11649 11885 12179 12307 12743 13173 13352 13389 13496 13611 15292 15321 16018 16327 16415 16959 16972 17499 17617 17786 18476 18966 19239 19498 19875 20312 20392 21603 21620 21730 21967 21972 21999 22015 22590 22775 23709 23839 24165 24408 24595 25160 25479 25812 26482 27328 28101 28297 28305 28342 28557 28986 29110 29401 29765 30292 30493 30739 31027 31201 31218 31414 32089 32759 32770 32777 32815 32877 32890 33297 33457 33603 33757 33866 34498 34525 34659 34679 34861 34870 34997 35311 35846 36411 36457 36738 36902 37940 38228 40156 40320 40705 40737 40803 41066 41443 41460 41954 41968 42040 42062 42099 43281 43320 43527 43537 43587 43729 44750 44822 45655 45769 46109 46525 47060 47128 47999 48635 48887 48981 49366 49424 49524 50546 50580 50689 51332 51861 51943 52097 52702 53009 53067 53397 53526 53901 54280 54399 54801 55535 55592 55740 55843 56110 56428 56552 56682 56848 57179 57688 57797 57847 57959 58330 58831 59553 59699 59884 59939 61233 61636 61732 61908 62145 62549 62649 62740 62912 62971 63053 64312 64322 64412 64816 64845 64873 64923 64976 65023 65166 65496 66065 66491 66803 66941 67081 68331 68336 68360 68476 69179 69719 69758 69948 70072 70544 70598 70990 71014 71454 71687 71743 71958 72282 72384 72456 72985 73327 74325 75046 75097 76647 77062 77088 77431 77553 77673 77753 78217 78518 78564 79565 79588 79686 80275 80939 81052 81348 81386 81440 81589 81610 81793 82408 82801 82836 83239 83466 83610 83867 83943 84441 84467 85248 85305 85554 85565 85758 86251 86603 86743 87323 87565 87824 87833 88265 88309 89178 89509 89618 89699 89708 90331 90359 90878 90902 91449 92284 92374 92549 92609 93609 94345 94934 95140 95475 95733 95985 95995 96270 96641 96807 97003 97632 98160 98677 98853 98943 99037 99055 99075 99185 99395 99592<br></code></pre></td></tr></table></figure><h3 id="样例输出-8"><a href="#样例输出-8" class="headerlink" title="样例输出"></a>样例输出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs data">7094396<br></code></pre></td></tr></table></figure><h3 id="评测用例规模与约定-3"><a href="#评测用例规模与约定-3" class="headerlink" title="评测用例规模与约定"></a>评测用例规模与约定</h3><p>对于 10% 的数据，保证 n=2；</p><p>对于 30% 的数据，保证 n≤10；</p><p>对于 60% 的数据，保证 n≤100,ai≤1000；</p><p>对于 100% 的数据，保证 2≤n≤1000,0≤ai≤100,000，且至少存在一种美观的种树方案。</p><h3 id="问题分析-1"><a href="#问题分析-1" class="headerlink" title="问题分析"></a>问题分析</h3><p>动态规划+打表</p><p>设$dp[i]$为到第i个障碍物之间的方案总数，那么有状态转移方程</p><script type="math/tex; mode=display">dp[i]=\sum\limits_{j=1}^{i-1}dp[j]\times{calc(j,i)}</script><p>其中$calc(j,i)$为第$j$个障碍物到第$i$个障碍物的方案总数。</p><p>为了得出优化的calc函数进行如下分析：</p><ol><li><p>第j个障碍物到第i个障碍物的间隔必须为obstacles[i]-obstacles[j]的因子，否则树不是等间隔的，挑选撞不上障碍物的因子作为种树方案。</p></li><li><p>若从j从i-1开始倒着枚举，开始时i-1和i之间没有障碍物，即obstacles[i]-obstacles[i-1]的所有因子都是种树方案，将这些因子设为不可再用(false)，当j=i-2时，对因子进行筛选时不可使用false的因子，因为按这些间隔排序一定会撞到原先作为左端点的障碍物。</p><p>所以我们可以从i-1到1遍历j，如果obstacles[i]-obstacles[j]的因子可使用就数量+1并标记为false，否则啥也不干。</p><p>注意当i增长时要重置因子可用集合flag为true。</p></li><li><p>因为我们需要频繁地获取某区间长度的因子，所以可以用筛选法进行预处理，即将因子打个表</p><p>这个表可以从1打到最大长度AMAX，也可以进行时间复杂度的优化，因为</p><ol><li>种树间隔不会超过最大障碍物距离的一半</li><li>种树的区间不会超过最大障碍物距离</li></ol><p>注：最大障碍物距离只是我形象的说法，其实比真实的最大障碍物距离大，因为坐标0不一定有障碍物。</p></li></ol><h3 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><br><span class="hljs-comment">// #define DEBUG  // 定义空的宏，只可判断其是否被定义</span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> MOD = <span class="hljs-number">1e9</span> + <span class="hljs-number">7</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N = <span class="hljs-number">1000</span> + <span class="hljs-number">5</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> AMAX = <span class="hljs-number">100000</span> + <span class="hljs-number">5</span>;<br><br><span class="hljs-keyword">int</span> n, obstacles[N];<br><span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> dp[N];<br><span class="hljs-keyword">bool</span> flag[AMAX];<br>vector&lt;<span class="hljs-keyword">int</span>&gt; v[AMAX];  <span class="hljs-comment">// 以向量为元素的数组</span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">calc</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> len = obstacles[y] - obstacles[x];<br>    <span class="hljs-keyword">int</span> cnt = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> d: v[len])<br>        <span class="hljs-keyword">if</span> (flag[d]) &#123;<br>            cnt++;<br>            flag[d] = <span class="hljs-literal">false</span>;<br>        &#125;<br>    flag[len] = <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> cnt;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;obstacles[i]);<br><br>    <span class="hljs-comment">// 确定以i(种树间隔)为因数的j</span><br>    <span class="hljs-comment">// 经优化的打表，右界可以直接为AMAX</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= obstacles[n] / <span class="hljs-number">2</span>; i++)  <span class="hljs-comment">// 间隔不超过最大障碍物距离的一半</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">2</span> * i; j &lt;= obstacles[n]; j += i)  <span class="hljs-comment">// 两障碍物间至少有一颗树，即间隔i不能为j自己（j=ki&lt;=最大障碍物距离,k=2,3,...）</span><br>            v[j].<span class="hljs-built_in">push_back</span>(i);<br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> DEBUG</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">20</span>; i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Case #%2d: &quot;</span>, i);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; (<span class="hljs-keyword">int</span>) v[i].<span class="hljs-built_in">size</span>(); j++)<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, v[i][j]);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    &#125;<br><span class="hljs-comment">// #else</span><br><span class="hljs-comment">//     printf(&quot;Not debugging\n&quot;);</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br>    dp[<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">2</span>; i &lt;= n; i++) &#123;<br>        <span class="hljs-built_in">memset</span>(flag, <span class="hljs-literal">true</span>, <span class="hljs-keyword">sizeof</span> flag);  <span class="hljs-comment">// 刻板印象：sizeof其实是个关键字！后面括号是提优先级用的！</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = i - <span class="hljs-number">1</span>; j &gt;= <span class="hljs-number">1</span>; j--)<br>            dp[i] = (dp[i] + dp[j] * <span class="hljs-built_in">calc</span>(j, i)) % MOD;<br>    &#125;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%lld\n&quot;</span>, dp[n]);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="知识"><a href="#知识" class="headerlink" title="知识"></a>知识</h3><ol><li><p>宏定义可以定义一个空的宏，如<code>#define DEBUG</code>，这种宏只能被用来判断是否被定义，常用于DEBUG时运行一些不想在RELEASE运行的语句</p><p>使用方法</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> DEBUG</span><br>    定义了DEBUG时要做的<br>[<br><span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span><br>没定义DEBUG时要做的<br>]<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br></code></pre></td></tr></table></figure></li><li><p><code>sizeof</code>其实是个关键字，一直认为它是函数的原因在于它经常加括号使用以区分操作对象</p><p>举个例子</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">int</span>* p=<span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">2</span>]&#123;<span class="hljs-number">0</span>,<span class="hljs-number">0</span>&#125;;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%zd\n&quot;</span>,<span class="hljs-keyword">sizeof</span> p);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%zd\n&quot;</span>,<span class="hljs-keyword">sizeof</span> p+<span class="hljs-number">1</span>);<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%zd\n&quot;</span>,<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span> (p+<span class="hljs-number">1</span>));<br></code></pre></td></tr></table></figure><p>输出</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs">8<br>9<br>8<br></code></pre></td></tr></table></figure><p>注：%zd是sizeof的返回类型unsigned int的输出控制符</p></li></ol><h1 id="202012"><a href="#202012" class="headerlink" title="202012"></a>202012</h1><h2 id="期末预测之安全指数"><a href="#期末预测之安全指数" class="headerlink" title="期末预测之安全指数"></a>期末预测之安全指数</h2><h3 id="题目链接-5"><a href="#题目链接-5" class="headerlink" title="题目链接"></a>题目链接</h3><p><a href="http://118.190.20.162/view.page?gpid=T123">202012-1 期末预测之安全指数</a></p><h3 id="题目背景"><a href="#题目背景" class="headerlink" title="题目背景"></a>题目背景</h3><p>考虑到安全指数是一个较大范围内的整数、小菜很可能搞不清楚自己是否真的安全，顿顿决定设置一个阈值 $θ$，以便将安全指数 $y$ 转化为一个具体的预测结果——“会挂科”或“不会挂科”。</p><p>因为安全指数越高表明小菜同学挂科的可能性越低，所以当 $y≥θ$ 时，顿顿会预测小菜这学期很安全、不会挂科；反之若 $y&lt;θ$，顿顿就会劝诫小菜：“你期末要挂科了，勿谓言之不预也。”</p><p>那么这个阈值该如何设定呢？顿顿准备从过往中寻找答案。</p><h3 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h3><p>具体来说，顿顿评估了 $m$ 位同学上学期的安全指数，其中第 $i$（$1≤i≤m$）位同学的安全指数为 $y_i$，是一个 $[0,108]$ 范围内的整数；同时，该同学上学期的挂科情况记作 $resulti∈0,1$，其中 $0$ 表示挂科、$1$ 表示未挂科。</p><p>相应地，顿顿用 <script type="math/tex">predict_{\theta} ( y )</script> 表示根据阈值 $θ$ 将安全指数 $y$ 转化为的具体预测结果。<br>如果 <script type="math/tex">predict_{\theta} ( y_j )</script> 与 $result_j$ 相同，则说明阈值为 $θ$ 时顿顿对第 $j$ 位同学是否挂科预测正确；不同则说明预测错误。</p><script type="math/tex; mode=display">\mathrm{predict}_{\theta} ( y ) = \left\{\begin{array}{cc}0& {(y < \theta)}\\1& {(y \ge \theta)}\end{array}\right.</script><p>最后，顿顿设计了如下公式来计算最佳阈值 $\theta^*$：</p><script type="math/tex; mode=display">\theta^* = \max { \mathop{\mathrm{argmax} }\limits_{\theta \in { y_i } } \sum\limits_{j=1}^{m} ( \mathrm{predict}_{\theta} ( y_j ) == result_j ) }</script><p>该公式亦可等价地表述为如下规则：</p><ol><li>最佳阈值仅在 ${ y_i }$ 中选取，即与某位同学的安全指数相同；</li><li>按照该阈值对这 $m$ 位同学上学期的挂科情况进行预测，预测正确的次数最多（即准确率最高）；</li><li>多个阈值均可以达到最高准确率时，选取其中最大的。</li></ol><h3 id="输入格式-5"><a href="#输入格式-5" class="headerlink" title="输入格式"></a>输入格式</h3><p>从标准输入读入数据。</p><p>输入的第一行包含一个正整数 $m$。</p><p>接下来输入 $m$ 行，其中第 $i$（$1≤i≤m$）行包括用空格分隔的两个整数 $y_i$ 和 $result_i$，含义如上文所述。</p><h3 id="输出格式-5"><a href="#输出格式-5" class="headerlink" title="输出格式"></a>输出格式</h3><p>输出到标准输出。</p><p>输出一个整数，表示最佳阈值 $\theta^∗$。</p><h3 id="样例1输入-1"><a href="#样例1输入-1" class="headerlink" title="样例1输入"></a>样例1输入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs data">6<br>0 0<br>1 0<br>1 1<br>3 1<br>5 1<br>7 1<br></code></pre></td></tr></table></figure><h3 id="样例1输出-1"><a href="#样例1输出-1" class="headerlink" title="样例1输出"></a>样例1输出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs data">3<br></code></pre></td></tr></table></figure><h3 id="样例1解释-1"><a href="#样例1解释-1" class="headerlink" title="样例1解释"></a>样例1解释</h3><p>按照规则一，最佳阈值的选取范围为 $0,1,3,5,7$。</p><p>$θ=0$ 时，预测正确次数为 $4$；</p><p>$θ=1$ 时，预测正确次数为 $5$；</p><p>$θ=3$ 时，预测正确次数为 $5$；</p><p>$θ=5$ 时，预测正确次数为 $4$；</p><p>$θ=7$ 时，预测正确次数为 $3$。</p><p>阈值选取为 $1$ 或 $3$ 时，预测准确率最高；<br>所以按照规则二，最佳阈值的选取范围缩小为 $1$,$3$。</p><p>依规则三，$\theta^* = \max { 1, 3 } = 3$。</p><h3 id="样例2输入-1"><a href="#样例2输入-1" class="headerlink" title="样例2输入"></a>样例2输入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs data">8<br>5 1<br>5 0<br>5 0<br>2 1<br>3 0<br>4 0<br>100000000 1<br>1 0<br></code></pre></td></tr></table></figure><h3 id="样例2输出-1"><a href="#样例2输出-1" class="headerlink" title="样例2输出"></a>样例2输出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs data">100000000<br></code></pre></td></tr></table></figure><h3 id="子任务-1"><a href="#子任务-1" class="headerlink" title="子任务"></a>子任务</h3><p>$70\%$ 的测试数据保证 $m≤200$；</p><p>全部的测试数据保证 $2≤m≤105$。</p><h3 id="问题分析-2"><a href="#问题分析-2" class="headerlink" title="问题分析"></a>问题分析</h3><p>模拟一个加权公式</p><h3 id="代码-5"><a href="#代码-5" class="headerlink" title="代码"></a>代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">n=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br><span class="hljs-built_in">sum</span>=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    w,score=<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">input</span>().split())<br>    <span class="hljs-built_in">sum</span>+=w*score<br>y=<span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">sum</span>)<br><span class="hljs-built_in">print</span>(y)<br></code></pre></td></tr></table></figure><h2 id="期末预测之最佳阈值"><a href="#期末预测之最佳阈值" class="headerlink" title="期末预测之最佳阈值"></a>期末预测之最佳阈值</h2><h3 id="题目链接-6"><a href="#题目链接-6" class="headerlink" title="题目链接"></a>题目链接</h3><p><a href="http://118.190.20.162/view.page?gpid=T122"> 202012-2 期末预测之最佳阈值</a></p><h3 id="问题分析-3"><a href="#问题分析-3" class="headerlink" title="问题分析"></a>问题分析</h3><p>前缀和、后缀和</p><p>根据题意和用例规模可以知道很容易写出70分的$O(n^2)$解，其主要优化点在于：</p><ol><li>怎样跳过的相同安全指数$y_i$</li><li>怎样在遍历时确定选定阈值对应的预测正确次数</li></ol><p>不难发现，第一份代码中对于优化点1将<script type="math/tex">y_i</script>和<script type="math/tex">y_{i-1}</script>对比，如果相同则跳过<script type="math/tex">y_i</script>，对于优化点2没做处理，暴力地使用了遍历，在$O(n)$的时间内获取到了预测正确次数，很容易知道在阈值变为下一个的时候，前后两段的预测正确者重合度很高，对于这种情况一般可以使用前/后缀和+容斥原理（本题是一维列表，未用到容斥原理）进行优化。</p><p>第二份代码对于优化点1建立了一个“相等值的下标列表”，对于相等的几个安全指数采用第一个安全指数的下标，对于优化点2，使用前缀和及后缀和在$O(1)$的时间内获取到了预测正确次数。</p><h3 id="代码-6"><a href="#代码-6" class="headerlink" title="代码"></a>代码</h3><p>$O(n^2)$的70分解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python">m=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br>y=[<span class="hljs-built_in">float</span>(<span class="hljs-string">&#x27;-inf&#x27;</span>)]<br>result=[<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    y_i,result_i=<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">input</span>().split())<br>    y.append(y_i)<br>    result.append(result_i)<br>best_theta=<span class="hljs-number">0</span><br>best_num=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i,y_i <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(y[<span class="hljs-number">1</span>:],<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">if</span> y_i==y[i-<span class="hljs-number">1</span>]:<br>        <span class="hljs-keyword">continue</span><br>    num=<span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,m+<span class="hljs-number">1</span>):<br>        <span class="hljs-keyword">if</span> y[j]&lt;y_i <span class="hljs-keyword">and</span> result[j]==<span class="hljs-number">0</span>:<br>            num+=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> y[j]&gt;=y_i <span class="hljs-keyword">and</span> result[j]==<span class="hljs-number">1</span>:<br>            num+=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> num&gt;best_num:<br>        best_theta=y_i<br>        best_num=num<br>    <span class="hljs-keyword">elif</span> num==best_num:<br>        best_theta=<span class="hljs-built_in">max</span>(best_theta,y_i)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">pass</span><br><span class="hljs-built_in">print</span>(best_theta)<br></code></pre></td></tr></table></figure><p>$O(n)$的100分解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python">m=<span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br>a=[]<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    a.append([<span class="hljs-built_in">int</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">input</span>().split()])<br>a.sort(key=<span class="hljs-keyword">lambda</span> x:x[<span class="hljs-number">0</span>])<br>a=[[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]]+a<br>prefix=[<span class="hljs-number">0</span>]*(m+<span class="hljs-number">1</span>)<br>suffix=[<span class="hljs-number">0</span>]*(m+<span class="hljs-number">2</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,m+<span class="hljs-number">1</span>):<br>    prefix[i]=prefix[i-<span class="hljs-number">1</span>]+(<span class="hljs-number">1</span> <span class="hljs-keyword">if</span> a[i][<span class="hljs-number">1</span>]==<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m,<span class="hljs-number">1</span>-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    suffix[i]=suffix[i+<span class="hljs-number">1</span>]+(<span class="hljs-number">1</span> <span class="hljs-keyword">if</span> a[i][<span class="hljs-number">1</span>]==<span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>)<br><br>pos=<span class="hljs-number">1</span><br>equal_position=[<span class="hljs-number">0</span>]*(m+<span class="hljs-number">1</span>)  <span class="hljs-comment"># 相等值的下标列表</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,m+<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">if</span>(a[i][<span class="hljs-number">0</span>]==a[i-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]):<br>        equal_position[i]=pos<br>    <span class="hljs-keyword">else</span>:<br>        pos=i<br>        equal_position[i]=pos<br><br>best_theta=<span class="hljs-number">0</span><br>best_num=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,m+<span class="hljs-number">1</span>):<br>    current_num=prefix[equal_position[i]-<span class="hljs-number">1</span>]+suffix[i]<br>    <span class="hljs-keyword">if</span> current_num&gt;=best_num:<br>        best_num=current_num<br>        best_theta=a[i][<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(best_theta)<br></code></pre></td></tr></table></figure><h1 id="202006"><a href="#202006" class="headerlink" title="202006"></a>202006</h1><h2 id="线性分类器"><a href="#线性分类器" class="headerlink" title="线性分类器"></a>线性分类器</h2><h3 id="题目链接-7"><a href="#题目链接-7" class="headerlink" title="题目链接"></a>题目链接</h3><p><a href="http://118.190.20.162/view.page?gpid=T105">202006-1 线性分类器</a></p><h3 id="分析-3"><a href="#分析-3" class="headerlink" title="分析"></a>分析</h3><p>简单模拟</p><p>按类别将输入分好类</p><p>然后使用judgeX函数分别判断A类B类点代入后是否都具有相同的符号。</p><p>这里用到了一点高中数学的知识，在同一侧的点代入函数后都应该有相同的符号，至于在某一侧是否有固定的符号我记不清了，所以我先获取了第一个点代入后的符号，然后看后面的点是否都跟这个符号相等，其实这两个符号应该是正负相反的，但是数据集好像没有考这里，有点混乱，做出来就行。</p><h3 id="代码-7"><a href="#代码-7" class="headerlink" title="代码"></a>代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs python">n,m=<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">input</span>().split())<br>pointsA=[]<br>pointsB=[]<br>lines=[]<br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">judgeX</span>(<span class="hljs-params">X</span>):</span><br>    pointsX=pointsA <span class="hljs-keyword">if</span> X==<span class="hljs-string">&#x27;A&#x27;</span> <span class="hljs-keyword">else</span> pointsB<br>    point=pointsX[<span class="hljs-number">0</span>]<br>    part1=<span class="hljs-number">1</span> <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>]+line[<span class="hljs-number">1</span>]*point[<span class="hljs-number">0</span>]+line[<span class="hljs-number">2</span>]*point[<span class="hljs-number">1</span>]&gt;<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> -<span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> point <span class="hljs-keyword">in</span> pointsX[<span class="hljs-number">1</span>:]:<br>        part2=<span class="hljs-number">1</span> <span class="hljs-keyword">if</span> line[<span class="hljs-number">0</span>]+line[<span class="hljs-number">1</span>]*point[<span class="hljs-number">0</span>]+line[<span class="hljs-number">2</span>]*point[<span class="hljs-number">1</span>]&gt;<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> -<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> part2!=part1:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    expoint=<span class="hljs-built_in">input</span>().split()<br>    point=[<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> expoint[:<span class="hljs-number">2</span>]]<br>    <span class="hljs-keyword">if</span> expoint[<span class="hljs-number">2</span>]==<span class="hljs-string">&#x27;A&#x27;</span>:<br>        pointsA.append(point)<br>    <span class="hljs-keyword">else</span>:<br>        pointsB.append(point)<br><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    line=[<span class="hljs-built_in">int</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">input</span>().split()]<br>    lines.append(line)<br><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:<br>    <span class="hljs-keyword">if</span> judgeX(<span class="hljs-string">&#x27;A&#x27;</span>) <span class="hljs-keyword">and</span> judgeX(<span class="hljs-string">&#x27;B&#x27;</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Yes&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="稀疏向量"><a href="#稀疏向量" class="headerlink" title="稀疏向量"></a>稀疏向量</h2><h3 id="题目链接-8"><a href="#题目链接-8" class="headerlink" title="题目链接"></a>题目链接</h3><p><a href="http://118.190.20.162/view.page?gpid=T104">202006-2 稀疏向量</a></p><h3 id="分析-4"><a href="#分析-4" class="headerlink" title="分析"></a>分析</h3><p>基本思路是用映射把稀疏向量保存起来，只有两个向量的键上都有值时才求他们值的乘积，其余情况的乘积都是0，那么可以使用集合求键的交集来实现找相同元素，解法一基于此思路，但这样要考虑到求交集所需的时间，据<a href="https://wiki.python.org/moin/TimeComplexity">python wiki</a>，<code>Intersection s&amp;t</code>的平均时间复杂度为<code>O(min(len(s), len(t))</code>，而解法二的<code>k in d</code>的平均时间复杂度为<code>O(1)</code>，所以我们可以把“求交”替换为“属于”。</p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112041918065.png" alt=""></p><p><img src="https://cdn.jsdelivr.net/gh/WanpengXu/myPicGo/img/202112041918633.png" alt=""></p><h3 id="代码-8"><a href="#代码-8" class="headerlink" title="代码"></a>代码</h3><p>90分解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python">n,a,b=<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">input</span>().split())<br>vector1=&#123;&#125;<br>v1index=<span class="hljs-built_in">set</span>()<br>vector2=&#123;&#125;<br>v2index=<span class="hljs-built_in">set</span>()<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(a):<br>    indexi,valuei=<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">input</span>().split())<br>    vector1[indexi]=valuei<br>    v1index.add(indexi)<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(b):<br>    indexj,valuej=<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">input</span>().split())<br>    vector2[indexj]=valuej<br>    v2index.add(indexj)<br>sameindex=<span class="hljs-built_in">list</span>(v1index.intersection(v2index))  <span class="hljs-comment"># 求交集时间复杂度O(min(len(s), len(t))</span><br>mul=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> index <span class="hljs-keyword">in</span> sameindex:<br>    mul+=vector1[index]*vector2[index]<br><span class="hljs-built_in">print</span>(mul)<br></code></pre></td></tr></table></figure><p>100分解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">n,a,b=<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">input</span>().split())<br>vector1=&#123;&#125;<br>mul=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(a):<br>    indexi,valuei=<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">input</span>().split())<br>    vector1[indexi]=valuei<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(b):<br>    indexj,valuej=<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">input</span>().split())<br>    <span class="hljs-keyword">if</span> indexj <span class="hljs-keyword">in</span> vector1.keys():<br>        mul+=vector1[indexj]*valuej<br><span class="hljs-built_in">print</span>(mul)<br></code></pre></td></tr></table></figure><h1 id="201709"><a href="#201709" class="headerlink" title="201709"></a>201709</h1><h2 id="通信网络"><a href="#通信网络" class="headerlink" title="通信网络"></a>通信网络</h2><h3 id="题目链接-9"><a href="#题目链接-9" class="headerlink" title="题目链接"></a>题目链接</h3><p><a href="http://118.190.20.162/view.page?gpid=T60">201709-4 通信网络</a></p><h3 id="分析-5"><a href="#分析-5" class="headerlink" title="分析"></a>分析</h3><p>DFS</p><p>一道比较简单的DFS，用C++11风格写的</p><p>首先要有</p><ol><li>一个二维long long向量，用来表示图</li><li>一个二维bool向量，用来表示i知道j</li><li>一个一维bool向量，用来表示“访问过”，这里本应是二维，为了降低空间复杂度把它设计成了一维，每次将它重新初始化为“未访问过”(false)</li></ol><p>接着设计一个DFS函数</p><ol><li>对于进入到函数中的点对，标记为“访问过”（true）</li><li>对于进入到函数中的点对，将他们标记为互相知道</li><li>对于点对中第一个点的每个出度点，若没被访问过，将他们扔入dfs函数</li></ol><p>最后在主函数中</p><ol><li>将输入构造为邻接表（由稀疏向量有感：邻接表其实就是稀疏的邻接矩阵）</li><li>将每一个点和它自己扔入dfs函数（每个点肯定知道自己）</li><li>最后按行遍历“二维知道向量”，如果某行知道所有点（true的数量等于点的数量），把结果自增1</li></ol><p>至于为什么这道题不取消visit标记，我不知道。</p><h3 id="代码-9"><a href="#代码-9" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> ll=<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span>;<br><span class="hljs-keyword">const</span> ll MAX=<span class="hljs-number">1000</span>+<span class="hljs-number">5</span>;<br>ll ni,mi;<br>vector&lt;vector&lt;ll&gt;&gt; <span class="hljs-built_in">graph</span>(MAX);<br>vector&lt;vector&lt;<span class="hljs-keyword">bool</span>&gt;&gt; <span class="hljs-built_in">know</span>(MAX,vector&lt;<span class="hljs-keyword">bool</span>&gt;(MAX));<br><span class="hljs-function">vector&lt;<span class="hljs-keyword">bool</span>&gt; <span class="hljs-title">visit</span><span class="hljs-params">(MAX)</span></span>;  <span class="hljs-comment">// 邻接表的每行都复用它</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(ll v,ll s)</span></span>&#123;<br>    visit[v]=<span class="hljs-literal">true</span>;<br>    know[s][v]=know[v][s]=<span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">for</span>(ll i:graph[v])&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">not</span> visit[i])<br>            <span class="hljs-built_in">dfs</span>(i,s);<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    ios::<span class="hljs-built_in">sync_with_stdio</span>(<span class="hljs-literal">false</span>);<br>    cin.<span class="hljs-built_in">tie</span>(<span class="hljs-number">0</span>);<br>    cin&gt;&gt;ni&gt;&gt;mi;<br>    <span class="hljs-keyword">while</span>(mi--)&#123;<br>        ll ai,bi;<br>        cin&gt;&gt;ai&gt;&gt;bi;<br>        graph[ai].<span class="hljs-built_in">push_back</span>(bi);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=ni;i++)&#123;<br>        <span class="hljs-built_in">fill</span>(visit.<span class="hljs-built_in">begin</span>()+<span class="hljs-number">1</span>,visit.<span class="hljs-built_in">begin</span>()+ni+<span class="hljs-number">1</span>,<span class="hljs-literal">false</span>);<br>        <span class="hljs-built_in">dfs</span>(i,i);<br>    &#125;<br>    ll ans=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(ll i=<span class="hljs-number">1</span>;i&lt;=ni;i++)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">count</span>(know[i].<span class="hljs-built_in">begin</span>()+<span class="hljs-number">1</span>,know[i].<span class="hljs-built_in">begin</span>()+ni+<span class="hljs-number">1</span>,<span class="hljs-literal">true</span>)==ni)<br>            ans++;<br>    &#125;<br>    cout&lt;&lt;ans;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="JSON查询"><a href="#JSON查询" class="headerlink" title="JSON查询"></a>JSON查询</h2><h3 id="题目链接-10"><a href="#题目链接-10" class="headerlink" title="题目链接"></a>题目链接</h3><p><a href="http://118.190.20.162/view.page?gpid=T61">201709-3 JSON查询</a></p><h3 id="分析-6"><a href="#分析-6" class="headerlink" title="分析"></a>分析</h3><p>震惊我一整年的题，python花活太多了</p><p>一个是这个输入正好符合python中dict的样式，可以直接用exec将字符串作为语句执行</p><p>第二是可以直接导入json库，用本身的loads函数创建半结构数据</p><h3 id="代码-10"><a href="#代码-10" class="headerlink" title="代码"></a>代码</h3><p>100分法一</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python">n,m=<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>,<span class="hljs-built_in">input</span>().split())<br>op=<span class="hljs-string">&#x27;dic=&#x27;</span><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    op+=<span class="hljs-built_in">input</span>()<br><span class="hljs-built_in">exec</span>(op)  <span class="hljs-comment"># 这个执行会自动转义&quot;却不会转义\，奇怪</span><br><span class="hljs-comment"># print(dic)</span><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    query=<span class="hljs-built_in">input</span>().replace(<span class="hljs-string">&quot;\\&quot;</span>,<span class="hljs-string">&quot;\\&quot;</span>)  <span class="hljs-comment"># 这第二个字符串参数竟然不支持转义</span><br>    op=<span class="hljs-string">&#x27;res=dic&#x27;</span><br>    obj=query.split(<span class="hljs-string">&#x27;.&#x27;</span>)<br>    <span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> obj:<br>        op+=<span class="hljs-string">f&#x27;[<span class="hljs-subst">&#123;<span class="hljs-built_in">repr</span>(o)&#125;</span>]&#x27;</span><br>    <span class="hljs-comment"># print(op)</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">exec</span>(op)<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;NOTEXIST&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(res,<span class="hljs-built_in">str</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;STRING&#x27;</span>,res)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;OBJECT&#x27;</span>)<br></code></pre></td></tr></table></figure><p>100分法二</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br>n, m = <span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, <span class="hljs-built_in">input</span>().split())<br><br>json_str = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    json_str += <span class="hljs-built_in">input</span>()<br><br>data = json.loads(json_str)  <span class="hljs-comment"># 我勒个大草tmd竟然能直接载入</span><br><br><span class="hljs-comment"># type(data) # dict</span><br><span class="hljs-comment"># print(data)  # &#123;&#x27;firstName&#x27;: &#x27;John&#x27;, &#x27;lastName&#x27;: &#x27;Smith&#x27;, &#x27;address&#x27;: &#123;&#x27;streetAddress&#x27;: &#x27;2ndStreet&#x27;, &#x27;city&#x27;: &#x27;NewYork&#x27;, &#x27;state&#x27;: &#x27;NY&#x27;&#125;, &#x27;esc\\aped&#x27;: &#x27;&quot;hello&quot;&#x27;&#125;</span><br><br><span class="hljs-comment"># print(type(data[&#x27;firstName&#x27;]))  # &lt;class &#x27;str&#x27;&gt;</span><br><span class="hljs-comment"># print(type(data[&#x27;address&#x27;]))  # &lt;class &#x27;dict&#x27;&gt;</span><br><span class="hljs-comment"># print(type(data[&#x27;address&#x27;][&#x27;city&#x27;]))  # &lt;class &#x27;str&#x27;&gt;</span><br><br>querys = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m):<br>    querys.append(<span class="hljs-built_in">input</span>().split(<span class="hljs-string">&quot;.&quot;</span>))<br><br><span class="hljs-comment"># json_type=&#123;</span><br><span class="hljs-comment">#     str:&quot;STRING&quot;,</span><br><span class="hljs-comment">#     dict:&quot;OBJECT&quot;</span><br><span class="hljs-comment">#     &#125;</span><br><br><span class="hljs-keyword">for</span> q <span class="hljs-keyword">in</span> querys:<br>    search = <span class="hljs-string">&quot;data&quot;</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> q:<br>            search += <span class="hljs-string">f&quot;[<span class="hljs-subst">&#123;<span class="hljs-built_in">repr</span>(x)&#125;</span>]&quot;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(<span class="hljs-built_in">eval</span>(search)) == <span class="hljs-built_in">str</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;STRING&quot;</span>, <span class="hljs-built_in">eval</span>(search))<br>        <span class="hljs-keyword">elif</span> <span class="hljs-built_in">type</span>(<span class="hljs-built_in">eval</span>(search)) == <span class="hljs-built_in">dict</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;OBJECT&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception:  <span class="hljs-comment"># 这里单用KeyError只能得90，还有我没考虑到的异常，为了保险所有异常都从这走</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;NOTEXIST&#x27;</span>)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>算法竞赛</category>
      
      <category>CSP</category>
      
    </categories>
    
    
    <tags>
      
      <tag>算法</tag>
      
      <tag>CSP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2021/11/26/hello-world/"/>
    <url>/2021/11/26/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
